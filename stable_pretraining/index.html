
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>stable_pretraining package &#8212; stable-pretraining 0.1.dev1+g5059ec3d9 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=721ff2ef"></script>
    <script src="../_static/doctools.js?v=fd6eb6e6"></script>
    <script src="../_static/sphinx_highlight.js?v=6ffebe34"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'stable_pretraining';</script>
    <link rel="index" title="Index" href="../genindex/" />
    <link rel="search" title="Search" href="../search/" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search/"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../">
  
  
  
  
  
  
    <p class="title logo__title">stable-pretraining 0.1.dev1+g5059ec3d9 documentation</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../">stable-pretraining</a></li>
<li class="toctree-l1"><a class="reference internal" href="../releases/">Releases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing/">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bibliography/">Bibliography</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">API</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../api/backbone/">stable_pretraining.backbone</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/gen_modules/stable_pretraining.backbone.MLP/">MLP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/gen_modules/stable_pretraining.backbone.Resnet9/">Resnet9</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/gen_modules/stable_pretraining.backbone.ConvMixer/">ConvMixer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/gen_modules/stable_pretraining.backbone.from_timm/">from_timm</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/gen_modules/stable_pretraining.backbone.from_torchvision/">from_torchvision</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/gen_modules/stable_pretraining.backbone.set_embedding_dim/">set_embedding_dim</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/gen_modules/stable_pretraining.backbone.TeacherStudentWrapper/">TeacherStudentWrapper</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/gen_modules/stable_pretraining.backbone.EvalOnly/">EvalOnly</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/gen_modules/stable_pretraining.backbone.mae/">mae</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api/data/">stable_pretraining.data</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/gen_modules/stable_pretraining.data.DataModule/">DataModule</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/gen_modules/stable_pretraining.data.Collator/">Collator</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/gen_modules/stable_pretraining.data.Dataset/">Dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/gen_modules/stable_pretraining.data.FromTorchDataset/">FromTorchDataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/gen_modules/stable_pretraining.data.HFDataset/">HFDataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/gen_modules/stable_pretraining.data.Subset/">Subset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/gen_modules/stable_pretraining.data.GMM/">GMM</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/gen_modules/stable_pretraining.data.MinariStepsDataset/">MinariStepsDataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/gen_modules/stable_pretraining.data.MinariEpisodeDataset/">MinariEpisodeDataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/gen_modules/stable_pretraining.data.swiss_roll/">swiss_roll</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/gen_modules/stable_pretraining.data.generate_perlin_noise_2d/">generate_perlin_noise_2d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/gen_modules/stable_pretraining.data.perlin_noise_3d/">perlin_noise_3d</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/gen_modules/stable_pretraining.data.Categorical/">Categorical</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/gen_modules/stable_pretraining.data.ExponentialMixtureNoiseModel/">ExponentialMixtureNoiseModel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/gen_modules/stable_pretraining.data.ExponentialNormalNoiseModel/">ExponentialNormalNoiseModel</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/gen_modules/stable_pretraining.data.RepeatedRandomSampler/">RepeatedRandomSampler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/gen_modules/stable_pretraining.data.SupervisedBatchSampler/">SupervisedBatchSampler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/gen_modules/stable_pretraining.data.RandomBatchSampler/">RandomBatchSampler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/gen_modules/stable_pretraining.data.fold_views/">fold_views</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/gen_modules/stable_pretraining.data.random_split/">random_split</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/gen_modules/stable_pretraining.data.download/">download</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/gen_modules/stable_pretraining.data.bulk_download/">bulk_download</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/gen_modules/stable_pretraining.data.transforms/">stable_pretraining.data.transforms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/gen_modules/stable_pretraining.data.dataset_stats/">stable_pretraining.data.dataset_stats</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/gen_modules/stable_pretraining.data.synthetic_data/">stable_pretraining.data.synthetic_data</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../api/forward/">stable_pretraining.forward</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api/losses/">stable_pretraining.losses</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/gen_modules/stable_pretraining.losses.NTXEntLoss/">NTXEntLoss</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/gen_modules/stable_pretraining.losses.NegativeCosineSimilarity/">NegativeCosineSimilarity</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/gen_modules/stable_pretraining.losses.VICRegLoss/">VICRegLoss</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/gen_modules/stable_pretraining.losses.BarlowTwinsLoss/">BarlowTwinsLoss</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api/manager/">stable_pretraining.manager</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/gen_modules/stable_pretraining.manager.Manager/">Manager</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api/module/">stable_pretraining.module</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/gen_modules/stable_pretraining.module.Module/">Module</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api/monitors/">stable_pretraining.callbacks</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/gen_modules/stable_pretraining.callbacks.OnlineProbe/">OnlineProbe</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/gen_modules/stable_pretraining.callbacks.OnlineKNN/">OnlineKNN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/gen_modules/stable_pretraining.callbacks.OnlineWriter/">OnlineWriter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/gen_modules/stable_pretraining.callbacks.RankMe/">RankMe</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/gen_modules/stable_pretraining.callbacks.LiDAR/">LiDAR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/gen_modules/stable_pretraining.callbacks.EarlyStopping/">EarlyStopping</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/gen_modules/stable_pretraining.callbacks.TrainerInfo/">TrainerInfo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/gen_modules/stable_pretraining.callbacks.LoggingCallback/">LoggingCallback</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/gen_modules/stable_pretraining.callbacks.ModuleSummary/">ModuleSummary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/gen_modules/stable_pretraining.callbacks.SklearnCheckpoint/">SklearnCheckpoint</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/gen_modules/stable_pretraining.callbacks.ImageRetrieval/">ImageRetrieval</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api/optim/">stable_pretraining.optim</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/gen_modules/stable_pretraining.optim.LARS/">LARS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/gen_modules/stable_pretraining.optim.CosineDecayer/">CosineDecayer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/gen_modules/stable_pretraining.optim.LinearWarmup/">LinearWarmup</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/gen_modules/stable_pretraining.optim.LinearWarmupCosineAnnealing/">LinearWarmupCosineAnnealing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/gen_modules/stable_pretraining.optim.LinearWarmupCyclicAnnealing/">LinearWarmupCyclicAnnealing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/gen_modules/stable_pretraining.optim.LinearWarmupThreeStepsAnnealing/">LinearWarmupThreeStepsAnnealing</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/stable_pretraining.rst" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.rst</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>stable_pretraining package</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#subpackages">Subpackages</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#submodules">Submodules</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-stable_pretraining.cli">stable_pretraining.cli module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.cli.dump_csv_logs"><code class="docutils literal notranslate"><span class="pre">dump_csv_logs()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.cli.run"><code class="docutils literal notranslate"><span class="pre">run()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-stable_pretraining.config">stable_pretraining.config module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.config.collapse_nested_dict"><code class="docutils literal notranslate"><span class="pre">collapse_nested_dict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.config.instantiate_from_config"><code class="docutils literal notranslate"><span class="pre">instantiate_from_config()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.config.recursive_instantiate"><code class="docutils literal notranslate"><span class="pre">recursive_instantiate()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-stable_pretraining.forward">stable_pretraining.forward module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.forward.barlow_twins_forward"><code class="docutils literal notranslate"><span class="pre">barlow_twins_forward()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.forward.byol_forward"><code class="docutils literal notranslate"><span class="pre">byol_forward()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.forward.dino_forward"><code class="docutils literal notranslate"><span class="pre">dino_forward()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.forward.dinov2_forward"><code class="docutils literal notranslate"><span class="pre">dinov2_forward()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.forward.nnclr_forward"><code class="docutils literal notranslate"><span class="pre">nnclr_forward()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.forward.simclr_forward"><code class="docutils literal notranslate"><span class="pre">simclr_forward()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.forward.supervised_forward"><code class="docutils literal notranslate"><span class="pre">supervised_forward()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.forward.swav_forward"><code class="docutils literal notranslate"><span class="pre">swav_forward()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.forward.vicreg_forward"><code class="docutils literal notranslate"><span class="pre">vicreg_forward()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-stable_pretraining.manager">stable_pretraining.manager module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.manager.Manager"><code class="docutils literal notranslate"><span class="pre">Manager</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.manager.Manager.init_and_sync_wandb"><code class="docutils literal notranslate"><span class="pre">Manager.init_and_sync_wandb()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.manager.Manager.instantiated_data"><code class="docutils literal notranslate"><span class="pre">Manager.instantiated_data</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.manager.Manager.instantiated_module"><code class="docutils literal notranslate"><span class="pre">Manager.instantiated_module</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.manager.Manager.predict"><code class="docutils literal notranslate"><span class="pre">Manager.predict()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.manager.Manager.save_checkpoint"><code class="docutils literal notranslate"><span class="pre">Manager.save_checkpoint()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.manager.Manager.test"><code class="docutils literal notranslate"><span class="pre">Manager.test()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.manager.Manager.validate"><code class="docutils literal notranslate"><span class="pre">Manager.validate()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.manager.print_logger_info"><code class="docutils literal notranslate"><span class="pre">print_logger_info()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.manager.print_signal_info"><code class="docutils literal notranslate"><span class="pre">print_signal_info()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-stable_pretraining.module">stable_pretraining.module module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.module.Module"><code class="docutils literal notranslate"><span class="pre">Module</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.module.Module.after_manual_backward"><code class="docutils literal notranslate"><span class="pre">Module.after_manual_backward()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.module.Module.configure_optimizers"><code class="docutils literal notranslate"><span class="pre">Module.configure_optimizers()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.module.Module.forward"><code class="docutils literal notranslate"><span class="pre">Module.forward()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.module.Module.named_parameters"><code class="docutils literal notranslate"><span class="pre">Module.named_parameters()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.module.Module.on_train_start"><code class="docutils literal notranslate"><span class="pre">Module.on_train_start()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.module.Module.parameters"><code class="docutils literal notranslate"><span class="pre">Module.parameters()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.module.Module.predict_step"><code class="docutils literal notranslate"><span class="pre">Module.predict_step()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.module.Module.rescale_loss_for_grad_acc"><code class="docutils literal notranslate"><span class="pre">Module.rescale_loss_for_grad_acc()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.module.Module.test_step"><code class="docutils literal notranslate"><span class="pre">Module.test_step()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.module.Module.training_step"><code class="docutils literal notranslate"><span class="pre">Module.training_step()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.module.Module.validation_step"><code class="docutils literal notranslate"><span class="pre">Module.validation_step()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-stable_pretraining.run">stable_pretraining.run module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.run.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.run.print_config"><code class="docutils literal notranslate"><span class="pre">print_config()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-stable_pretraining.static">stable_pretraining.static module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.static.HF_EMBEDDINGS"><code class="docutils literal notranslate"><span class="pre">HF_EMBEDDINGS</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.static.HF_EMBEDDINGS.data"><code class="docutils literal notranslate"><span class="pre">HF_EMBEDDINGS.data</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.static.HF_PARAMETERS"><code class="docutils literal notranslate"><span class="pre">HF_PARAMETERS</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.static.HF_PARAMETERS.data"><code class="docutils literal notranslate"><span class="pre">HF_PARAMETERS.data</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.static.MetaStatic"><code class="docutils literal notranslate"><span class="pre">MetaStatic</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.static.MetaStatic.clear"><code class="docutils literal notranslate"><span class="pre">MetaStatic.clear()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.static.MetaStatic.get"><code class="docutils literal notranslate"><span class="pre">MetaStatic.get()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.static.MetaStatic.items"><code class="docutils literal notranslate"><span class="pre">MetaStatic.items()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.static.MetaStatic.keys"><code class="docutils literal notranslate"><span class="pre">MetaStatic.keys()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.static.MetaStatic.update"><code class="docutils literal notranslate"><span class="pre">MetaStatic.update()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.static.MetaStatic.values"><code class="docutils literal notranslate"><span class="pre">MetaStatic.values()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.static.TIMM_EMBEDDINGS"><code class="docutils literal notranslate"><span class="pre">TIMM_EMBEDDINGS</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.static.TIMM_EMBEDDINGS.data"><code class="docutils literal notranslate"><span class="pre">TIMM_EMBEDDINGS.data</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.static.TIMM_PARAMETERS"><code class="docutils literal notranslate"><span class="pre">TIMM_PARAMETERS</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.static.TIMM_PARAMETERS.data"><code class="docutils literal notranslate"><span class="pre">TIMM_PARAMETERS.data</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.static.count_parameters"><code class="docutils literal notranslate"><span class="pre">count_parameters()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-stable_pretraining">Module contents</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.EarlyStopping"><code class="docutils literal notranslate"><span class="pre">EarlyStopping</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.EarlyStopping.should_stop"><code class="docutils literal notranslate"><span class="pre">EarlyStopping.should_stop()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.ImageRetrieval"><code class="docutils literal notranslate"><span class="pre">ImageRetrieval</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.ImageRetrieval.NAME"><code class="docutils literal notranslate"><span class="pre">ImageRetrieval.NAME</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.ImageRetrieval.on_validation_epoch_end"><code class="docutils literal notranslate"><span class="pre">ImageRetrieval.on_validation_epoch_end()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.ImageRetrieval.on_validation_epoch_start"><code class="docutils literal notranslate"><span class="pre">ImageRetrieval.on_validation_epoch_start()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.ImageRetrieval.state_key"><code class="docutils literal notranslate"><span class="pre">ImageRetrieval.state_key</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.LiDAR"><code class="docutils literal notranslate"><span class="pre">LiDAR</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.LiDAR.on_validation_batch_end"><code class="docutils literal notranslate"><span class="pre">LiDAR.on_validation_batch_end()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.LiDAR.setup"><code class="docutils literal notranslate"><span class="pre">LiDAR.setup()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.LiDAR.state_key"><code class="docutils literal notranslate"><span class="pre">LiDAR.state_key</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.LoggingCallback"><code class="docutils literal notranslate"><span class="pre">LoggingCallback</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.LoggingCallback.on_validation_end"><code class="docutils literal notranslate"><span class="pre">LoggingCallback.on_validation_end()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.Manager"><code class="docutils literal notranslate"><span class="pre">Manager</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.Manager.init_and_sync_wandb"><code class="docutils literal notranslate"><span class="pre">Manager.init_and_sync_wandb()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.Manager.instantiated_data"><code class="docutils literal notranslate"><span class="pre">Manager.instantiated_data</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.Manager.instantiated_module"><code class="docutils literal notranslate"><span class="pre">Manager.instantiated_module</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.Manager.predict"><code class="docutils literal notranslate"><span class="pre">Manager.predict()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.Manager.save_checkpoint"><code class="docutils literal notranslate"><span class="pre">Manager.save_checkpoint()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.Manager.test"><code class="docutils literal notranslate"><span class="pre">Manager.test()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.Manager.validate"><code class="docutils literal notranslate"><span class="pre">Manager.validate()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.Module"><code class="docutils literal notranslate"><span class="pre">Module</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.Module.after_manual_backward"><code class="docutils literal notranslate"><span class="pre">Module.after_manual_backward()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.Module.configure_optimizers"><code class="docutils literal notranslate"><span class="pre">Module.configure_optimizers()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.Module.forward"><code class="docutils literal notranslate"><span class="pre">Module.forward()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.Module.named_parameters"><code class="docutils literal notranslate"><span class="pre">Module.named_parameters()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.Module.on_train_start"><code class="docutils literal notranslate"><span class="pre">Module.on_train_start()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.Module.parameters"><code class="docutils literal notranslate"><span class="pre">Module.parameters()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.Module.predict_step"><code class="docutils literal notranslate"><span class="pre">Module.predict_step()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.Module.rescale_loss_for_grad_acc"><code class="docutils literal notranslate"><span class="pre">Module.rescale_loss_for_grad_acc()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.Module.test_step"><code class="docutils literal notranslate"><span class="pre">Module.test_step()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.Module.training_step"><code class="docutils literal notranslate"><span class="pre">Module.training_step()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.Module.validation_step"><code class="docutils literal notranslate"><span class="pre">Module.validation_step()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.ModuleSummary"><code class="docutils literal notranslate"><span class="pre">ModuleSummary</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.ModuleSummary.setup"><code class="docutils literal notranslate"><span class="pre">ModuleSummary.setup()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.OnlineKNN"><code class="docutils literal notranslate"><span class="pre">OnlineKNN</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.OnlineKNN.on_validation_batch_end"><code class="docutils literal notranslate"><span class="pre">OnlineKNN.on_validation_batch_end()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.OnlineKNN.setup"><code class="docutils literal notranslate"><span class="pre">OnlineKNN.setup()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.OnlineKNN.state_key"><code class="docutils literal notranslate"><span class="pre">OnlineKNN.state_key</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.OnlineProbe"><code class="docutils literal notranslate"><span class="pre">OnlineProbe</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.OnlineProbe.configure_model"><code class="docutils literal notranslate"><span class="pre">OnlineProbe.configure_model()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.OnlineProbe.wrap_forward"><code class="docutils literal notranslate"><span class="pre">OnlineProbe.wrap_forward()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.OnlineWriter"><code class="docutils literal notranslate"><span class="pre">OnlineWriter</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.OnlineWriter.dump"><code class="docutils literal notranslate"><span class="pre">OnlineWriter.dump()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.OnlineWriter.is_writing_epoch"><code class="docutils literal notranslate"><span class="pre">OnlineWriter.is_writing_epoch()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.OnlineWriter.on_predict_batch_end"><code class="docutils literal notranslate"><span class="pre">OnlineWriter.on_predict_batch_end()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.OnlineWriter.on_sanity_check_end"><code class="docutils literal notranslate"><span class="pre">OnlineWriter.on_sanity_check_end()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.OnlineWriter.on_sanity_check_start"><code class="docutils literal notranslate"><span class="pre">OnlineWriter.on_sanity_check_start()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.OnlineWriter.on_test_batch_end"><code class="docutils literal notranslate"><span class="pre">OnlineWriter.on_test_batch_end()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.OnlineWriter.on_train_batch_end"><code class="docutils literal notranslate"><span class="pre">OnlineWriter.on_train_batch_end()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.OnlineWriter.on_validation_batch_end"><code class="docutils literal notranslate"><span class="pre">OnlineWriter.on_validation_batch_end()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.OnlineWriter.write_at_phase"><code class="docutils literal notranslate"><span class="pre">OnlineWriter.write_at_phase()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.RankMe"><code class="docutils literal notranslate"><span class="pre">RankMe</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.RankMe.on_validation_batch_end"><code class="docutils literal notranslate"><span class="pre">RankMe.on_validation_batch_end()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.RankMe.setup"><code class="docutils literal notranslate"><span class="pre">RankMe.setup()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.RankMe.state_key"><code class="docutils literal notranslate"><span class="pre">RankMe.state_key</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.SklearnCheckpoint"><code class="docutils literal notranslate"><span class="pre">SklearnCheckpoint</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.SklearnCheckpoint.on_load_checkpoint"><code class="docutils literal notranslate"><span class="pre">SklearnCheckpoint.on_load_checkpoint()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.SklearnCheckpoint.on_save_checkpoint"><code class="docutils literal notranslate"><span class="pre">SklearnCheckpoint.on_save_checkpoint()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.SklearnCheckpoint.setup"><code class="docutils literal notranslate"><span class="pre">SklearnCheckpoint.setup()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.TeacherStudentCallback"><code class="docutils literal notranslate"><span class="pre">TeacherStudentCallback</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.TeacherStudentCallback.on_after_backward"><code class="docutils literal notranslate"><span class="pre">TeacherStudentCallback.on_after_backward()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.TeacherStudentCallback.on_fit_start"><code class="docutils literal notranslate"><span class="pre">TeacherStudentCallback.on_fit_start()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.TeacherStudentCallback.on_train_batch_end"><code class="docutils literal notranslate"><span class="pre">TeacherStudentCallback.on_train_batch_end()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.TeacherStudentWrapper"><code class="docutils literal notranslate"><span class="pre">TeacherStudentWrapper</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.TeacherStudentWrapper.forward"><code class="docutils literal notranslate"><span class="pre">TeacherStudentWrapper.forward()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.TeacherStudentWrapper.forward_student"><code class="docutils literal notranslate"><span class="pre">TeacherStudentWrapper.forward_student()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.TeacherStudentWrapper.forward_teacher"><code class="docutils literal notranslate"><span class="pre">TeacherStudentWrapper.forward_teacher()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.TeacherStudentWrapper.update_ema_coefficient"><code class="docutils literal notranslate"><span class="pre">TeacherStudentWrapper.update_ema_coefficient()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.TeacherStudentWrapper.update_teacher"><code class="docutils literal notranslate"><span class="pre">TeacherStudentWrapper.update_teacher()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.TrainerInfo"><code class="docutils literal notranslate"><span class="pre">TrainerInfo</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.TrainerInfo.setup"><code class="docutils literal notranslate"><span class="pre">TrainerInfo.setup()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.log"><code class="docutils literal notranslate"><span class="pre">log()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.log_dict"><code class="docutils literal notranslate"><span class="pre">log_dict()</span></code></a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="stable-pretraining-package">
<h1>stable_pretraining package<a class="headerlink" href="#stable-pretraining-package" title="Link to this heading">#</a></h1>
<section id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Link to this heading">#</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="../stable_pretraining.backbone/">stable_pretraining.backbone package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.backbone/#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.backbone/#module-stable_pretraining.backbone.aggregator">stable_pretraining.backbone.aggregator module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.aggregator.TensorAggregator"><code class="docutils literal notranslate"><span class="pre">TensorAggregator</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.aggregator.TensorAggregator.compute_output_dim"><code class="docutils literal notranslate"><span class="pre">TensorAggregator.compute_output_dim()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.aggregator.TensorAggregator.forward"><code class="docutils literal notranslate"><span class="pre">TensorAggregator.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.backbone/#module-stable_pretraining.backbone.convmixer">stable_pretraining.backbone.convmixer module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.convmixer.ConvMixer"><code class="docutils literal notranslate"><span class="pre">ConvMixer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.convmixer.ConvMixer.forward"><code class="docutils literal notranslate"><span class="pre">ConvMixer.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.backbone/#module-stable_pretraining.backbone.mae">stable_pretraining.backbone.mae module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.mae.MaskedAutoencoderViT"><code class="docutils literal notranslate"><span class="pre">MaskedAutoencoderViT</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.mae.MaskedAutoencoderViT.forward"><code class="docutils literal notranslate"><span class="pre">MaskedAutoencoderViT.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.mae.MaskedAutoencoderViT.forward_decoder"><code class="docutils literal notranslate"><span class="pre">MaskedAutoencoderViT.forward_decoder()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.mae.MaskedAutoencoderViT.forward_encoder"><code class="docutils literal notranslate"><span class="pre">MaskedAutoencoderViT.forward_encoder()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.mae.MaskedAutoencoderViT.initialize_weights"><code class="docutils literal notranslate"><span class="pre">MaskedAutoencoderViT.initialize_weights()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.mae.MaskedAutoencoderViT.patchify"><code class="docutils literal notranslate"><span class="pre">MaskedAutoencoderViT.patchify()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.mae.MaskedAutoencoderViT.random_masking"><code class="docutils literal notranslate"><span class="pre">MaskedAutoencoderViT.random_masking()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.mae.MaskedAutoencoderViT.unpatchify"><code class="docutils literal notranslate"><span class="pre">MaskedAutoencoderViT.unpatchify()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.mae.get_1d_sincos_pos_embed_from_grid"><code class="docutils literal notranslate"><span class="pre">get_1d_sincos_pos_embed_from_grid()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.mae.get_2d_sincos_pos_embed"><code class="docutils literal notranslate"><span class="pre">get_2d_sincos_pos_embed()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.mae.get_2d_sincos_pos_embed_from_grid"><code class="docutils literal notranslate"><span class="pre">get_2d_sincos_pos_embed_from_grid()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.mae.vit_base_patch16"><code class="docutils literal notranslate"><span class="pre">vit_base_patch16()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.mae.vit_base_patch16_dec512d8b"><code class="docutils literal notranslate"><span class="pre">vit_base_patch16_dec512d8b()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.mae.vit_huge_patch14"><code class="docutils literal notranslate"><span class="pre">vit_huge_patch14()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.mae.vit_huge_patch14_dec512d8b"><code class="docutils literal notranslate"><span class="pre">vit_huge_patch14_dec512d8b()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.mae.vit_large_patch16"><code class="docutils literal notranslate"><span class="pre">vit_large_patch16()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.mae.vit_large_patch16_dec512d8b"><code class="docutils literal notranslate"><span class="pre">vit_large_patch16_dec512d8b()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.backbone/#module-stable_pretraining.backbone.mlp">stable_pretraining.backbone.mlp module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.mlp.MLP"><code class="docutils literal notranslate"><span class="pre">MLP</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.backbone/#module-stable_pretraining.backbone.patch_masking">stable_pretraining.backbone.patch_masking module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.patch_masking.IJEPAMaskOutput"><code class="docutils literal notranslate"><span class="pre">IJEPAMaskOutput</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.patch_masking.IJEPAMaskOutput.context_idx"><code class="docutils literal notranslate"><span class="pre">IJEPAMaskOutput.context_idx</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.patch_masking.IJEPAMaskOutput.mask"><code class="docutils literal notranslate"><span class="pre">IJEPAMaskOutput.mask</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.patch_masking.IJEPAMaskOutput.target_block_masks"><code class="docutils literal notranslate"><span class="pre">IJEPAMaskOutput.target_block_masks</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.patch_masking.IJEPAMaskOutput.target_idx"><code class="docutils literal notranslate"><span class="pre">IJEPAMaskOutput.target_idx</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.patch_masking.IJEPAMasking"><code class="docutils literal notranslate"><span class="pre">IJEPAMasking</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.patch_masking.IJEPAMasking.extra_repr"><code class="docutils literal notranslate"><span class="pre">IJEPAMasking.extra_repr()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.patch_masking.IJEPAMasking.forward"><code class="docutils literal notranslate"><span class="pre">IJEPAMasking.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.patch_masking.MaskingOutput"><code class="docutils literal notranslate"><span class="pre">MaskingOutput</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.patch_masking.MaskingOutput.ids_keep"><code class="docutils literal notranslate"><span class="pre">MaskingOutput.ids_keep</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.patch_masking.MaskingOutput.ids_restore"><code class="docutils literal notranslate"><span class="pre">MaskingOutput.ids_restore</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.patch_masking.MaskingOutput.mask"><code class="docutils literal notranslate"><span class="pre">MaskingOutput.mask</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.patch_masking.MaskingOutput.visible"><code class="docutils literal notranslate"><span class="pre">MaskingOutput.visible</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.patch_masking.PatchMasking"><code class="docutils literal notranslate"><span class="pre">PatchMasking</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.patch_masking.PatchMasking.extra_repr"><code class="docutils literal notranslate"><span class="pre">PatchMasking.extra_repr()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.patch_masking.PatchMasking.forward"><code class="docutils literal notranslate"><span class="pre">PatchMasking.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.backbone/#module-stable_pretraining.backbone.pos_embed">stable_pretraining.backbone.pos_embed module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.pos_embed.get_1d_sincos_pos_embed"><code class="docutils literal notranslate"><span class="pre">get_1d_sincos_pos_embed()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.pos_embed.get_2d_sincos_pos_embed"><code class="docutils literal notranslate"><span class="pre">get_2d_sincos_pos_embed()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.pos_embed.get_sincos_pos_embed"><code class="docutils literal notranslate"><span class="pre">get_sincos_pos_embed()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.pos_embed.get_timestep_embed"><code class="docutils literal notranslate"><span class="pre">get_timestep_embed()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.pos_embed.interpolate_pos_embed"><code class="docutils literal notranslate"><span class="pre">interpolate_pos_embed()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.backbone/#module-stable_pretraining.backbone.probe">stable_pretraining.backbone.probe module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.probe.AutoLinearClassifier"><code class="docutils literal notranslate"><span class="pre">AutoLinearClassifier</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.probe.AutoLinearClassifier.norm"><code class="docutils literal notranslate"><span class="pre">AutoLinearClassifier.norm</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.probe.AutoLinearClassifier.fc"><code class="docutils literal notranslate"><span class="pre">AutoLinearClassifier.fc</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.probe.AutoLinearClassifier.forward"><code class="docutils literal notranslate"><span class="pre">AutoLinearClassifier.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.probe.AutoTuneMLP"><code class="docutils literal notranslate"><span class="pre">AutoTuneMLP</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.probe.AutoTuneMLP.forward"><code class="docutils literal notranslate"><span class="pre">AutoTuneMLP.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.probe.AutoTuneMLP.get_best_variant"><code class="docutils literal notranslate"><span class="pre">AutoTuneMLP.get_best_variant()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.probe.AutoTuneMLP.get_variant"><code class="docutils literal notranslate"><span class="pre">AutoTuneMLP.get_variant()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.probe.AutoTuneMLP.keys"><code class="docutils literal notranslate"><span class="pre">AutoTuneMLP.keys()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.probe.AutoTuneMLP.num_variants"><code class="docutils literal notranslate"><span class="pre">AutoTuneMLP.num_variants()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.probe.LinearProbe"><code class="docutils literal notranslate"><span class="pre">LinearProbe</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.probe.LinearProbe.norm"><code class="docutils literal notranslate"><span class="pre">LinearProbe.norm</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.probe.LinearProbe.fc"><code class="docutils literal notranslate"><span class="pre">LinearProbe.fc</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.probe.LinearProbe.forward"><code class="docutils literal notranslate"><span class="pre">LinearProbe.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.probe.MultiHeadAttentiveProbe"><code class="docutils literal notranslate"><span class="pre">MultiHeadAttentiveProbe</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.probe.MultiHeadAttentiveProbe.ln"><code class="docutils literal notranslate"><span class="pre">MultiHeadAttentiveProbe.ln</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.probe.MultiHeadAttentiveProbe.attn_vectors"><code class="docutils literal notranslate"><span class="pre">MultiHeadAttentiveProbe.attn_vectors</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.probe.MultiHeadAttentiveProbe.fc"><code class="docutils literal notranslate"><span class="pre">MultiHeadAttentiveProbe.fc</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.probe.MultiHeadAttentiveProbe.forward"><code class="docutils literal notranslate"><span class="pre">MultiHeadAttentiveProbe.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.backbone/#module-stable_pretraining.backbone.resnet9">stable_pretraining.backbone.resnet9 module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.resnet9.MLP"><code class="docutils literal notranslate"><span class="pre">MLP</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.resnet9.ResidualBlock"><code class="docutils literal notranslate"><span class="pre">ResidualBlock</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.resnet9.ResidualBlock.forward"><code class="docutils literal notranslate"><span class="pre">ResidualBlock.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.resnet9.Resnet9"><code class="docutils literal notranslate"><span class="pre">Resnet9</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.resnet9.Resnet9.forward"><code class="docutils literal notranslate"><span class="pre">Resnet9.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.backbone/#module-stable_pretraining.backbone.utils">stable_pretraining.backbone.utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.utils.EfficientMaskedTimmViT"><code class="docutils literal notranslate"><span class="pre">EfficientMaskedTimmViT</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.utils.EfficientMaskedTimmViT.clear_cache"><code class="docutils literal notranslate"><span class="pre">EfficientMaskedTimmViT.clear_cache()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.utils.EfficientMaskedTimmViT.forward"><code class="docutils literal notranslate"><span class="pre">EfficientMaskedTimmViT.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.utils.EmbeddingOutput"><code class="docutils literal notranslate"><span class="pre">EmbeddingOutput</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.utils.EmbeddingOutput.last_hidden_state"><code class="docutils literal notranslate"><span class="pre">EmbeddingOutput.last_hidden_state</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.utils.EmbeddingOutput.hidden_states"><code class="docutils literal notranslate"><span class="pre">EmbeddingOutput.hidden_states</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#id0"><code class="docutils literal notranslate"><span class="pre">EmbeddingOutput.hidden_states</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.utils.EmbeddingOutput.keys"><code class="docutils literal notranslate"><span class="pre">EmbeddingOutput.keys()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#id8"><code class="docutils literal notranslate"><span class="pre">EmbeddingOutput.last_hidden_state</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.utils.EvalOnly"><code class="docutils literal notranslate"><span class="pre">EvalOnly</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.utils.EvalOnly.forward"><code class="docutils literal notranslate"><span class="pre">EvalOnly.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.utils.EvalOnly.train"><code class="docutils literal notranslate"><span class="pre">EvalOnly.train()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.utils.FeaturesConcat"><code class="docutils literal notranslate"><span class="pre">FeaturesConcat</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.utils.FeaturesConcat.forward"><code class="docutils literal notranslate"><span class="pre">FeaturesConcat.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.utils.FeaturesConcat.get_output_shape"><code class="docutils literal notranslate"><span class="pre">FeaturesConcat.get_output_shape()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.utils.HiddenStateExtractor"><code class="docutils literal notranslate"><span class="pre">HiddenStateExtractor</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.utils.HiddenStateExtractor.forward"><code class="docutils literal notranslate"><span class="pre">HiddenStateExtractor.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.utils.HiddenStateExtractor.remove_hooks"><code class="docutils literal notranslate"><span class="pre">HiddenStateExtractor.remove_hooks()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.utils.TeacherStudentWrapper"><code class="docutils literal notranslate"><span class="pre">TeacherStudentWrapper</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.utils.TeacherStudentWrapper.forward"><code class="docutils literal notranslate"><span class="pre">TeacherStudentWrapper.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.utils.TeacherStudentWrapper.forward_student"><code class="docutils literal notranslate"><span class="pre">TeacherStudentWrapper.forward_student()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.utils.TeacherStudentWrapper.forward_teacher"><code class="docutils literal notranslate"><span class="pre">TeacherStudentWrapper.forward_teacher()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.utils.TeacherStudentWrapper.update_ema_coefficient"><code class="docutils literal notranslate"><span class="pre">TeacherStudentWrapper.update_ema_coefficient()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.utils.TeacherStudentWrapper.update_teacher"><code class="docutils literal notranslate"><span class="pre">TeacherStudentWrapper.update_teacher()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.utils.from_huggingface"><code class="docutils literal notranslate"><span class="pre">from_huggingface()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.utils.from_timm"><code class="docutils literal notranslate"><span class="pre">from_timm()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.utils.from_torchvision"><code class="docutils literal notranslate"><span class="pre">from_torchvision()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.utils.get_children_modules"><code class="docutils literal notranslate"><span class="pre">get_children_modules()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.utils.get_output_shape"><code class="docutils literal notranslate"><span class="pre">get_output_shape()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.utils.register_lr_scale_hook"><code class="docutils literal notranslate"><span class="pre">register_lr_scale_hook()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.utils.set_embedding_dim"><code class="docutils literal notranslate"><span class="pre">set_embedding_dim()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.utils.vit_hf"><code class="docutils literal notranslate"><span class="pre">vit_hf()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.backbone/#module-stable_pretraining.backbone.vit">stable_pretraining.backbone.vit module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.vit.Attention"><code class="docutils literal notranslate"><span class="pre">Attention</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.vit.Attention.forward"><code class="docutils literal notranslate"><span class="pre">Attention.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.vit.CrossAttention"><code class="docutils literal notranslate"><span class="pre">CrossAttention</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.vit.CrossAttention.forward"><code class="docutils literal notranslate"><span class="pre">CrossAttention.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.vit.FlexibleTransformer"><code class="docutils literal notranslate"><span class="pre">FlexibleTransformer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.vit.FlexibleTransformer.forward"><code class="docutils literal notranslate"><span class="pre">FlexibleTransformer.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.vit.MAEDecoder"><code class="docutils literal notranslate"><span class="pre">MAEDecoder</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.vit.MAEDecoder.forward"><code class="docutils literal notranslate"><span class="pre">MAEDecoder.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.vit.MaskedEncoder"><code class="docutils literal notranslate"><span class="pre">MaskedEncoder</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.vit.MaskedEncoder.extra_repr"><code class="docutils literal notranslate"><span class="pre">MaskedEncoder.extra_repr()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.vit.MaskedEncoder.forward"><code class="docutils literal notranslate"><span class="pre">MaskedEncoder.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.vit.MaskedEncoder.forward_features"><code class="docutils literal notranslate"><span class="pre">MaskedEncoder.forward_features()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.vit.MaskedEncoderOutput"><code class="docutils literal notranslate"><span class="pre">MaskedEncoderOutput</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.vit.MaskedEncoderOutput.encoded"><code class="docutils literal notranslate"><span class="pre">MaskedEncoderOutput.encoded</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.vit.MaskedEncoderOutput.grid_size"><code class="docutils literal notranslate"><span class="pre">MaskedEncoderOutput.grid_size</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.vit.MaskedEncoderOutput.ids_keep"><code class="docutils literal notranslate"><span class="pre">MaskedEncoderOutput.ids_keep</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.vit.MaskedEncoderOutput.mask"><code class="docutils literal notranslate"><span class="pre">MaskedEncoderOutput.mask</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.vit.PositionalEncoding2D"><code class="docutils literal notranslate"><span class="pre">PositionalEncoding2D</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.vit.PositionalEncoding2D.forward"><code class="docutils literal notranslate"><span class="pre">PositionalEncoding2D.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.vit.TransformerBlock"><code class="docutils literal notranslate"><span class="pre">TransformerBlock</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.vit.TransformerBlock.forward"><code class="docutils literal notranslate"><span class="pre">TransformerBlock.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.backbone/#stable_pretraining.backbone.vit.modulate"><code class="docutils literal notranslate"><span class="pre">modulate()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.backbone/#module-stable_pretraining.backbone">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../stable_pretraining.callbacks/">stable_pretraining.callbacks package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.callbacks/#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.callbacks/#module-stable_pretraining.callbacks.checkpoint_sklearn">stable_pretraining.callbacks.checkpoint_sklearn module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.checkpoint_sklearn.SklearnCheckpoint"><code class="docutils literal notranslate"><span class="pre">SklearnCheckpoint</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.checkpoint_sklearn.SklearnCheckpoint.on_load_checkpoint"><code class="docutils literal notranslate"><span class="pre">SklearnCheckpoint.on_load_checkpoint()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.checkpoint_sklearn.SklearnCheckpoint.on_save_checkpoint"><code class="docutils literal notranslate"><span class="pre">SklearnCheckpoint.on_save_checkpoint()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.checkpoint_sklearn.SklearnCheckpoint.setup"><code class="docutils literal notranslate"><span class="pre">SklearnCheckpoint.setup()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.checkpoint_sklearn.StrictCheckpointCallback"><code class="docutils literal notranslate"><span class="pre">StrictCheckpointCallback</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.checkpoint_sklearn.StrictCheckpointCallback.on_load_checkpoint"><code class="docutils literal notranslate"><span class="pre">StrictCheckpointCallback.on_load_checkpoint()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.checkpoint_sklearn.WandbCheckpoint"><code class="docutils literal notranslate"><span class="pre">WandbCheckpoint</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.checkpoint_sklearn.WandbCheckpoint.on_load_checkpoint"><code class="docutils literal notranslate"><span class="pre">WandbCheckpoint.on_load_checkpoint()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.checkpoint_sklearn.WandbCheckpoint.on_save_checkpoint"><code class="docutils literal notranslate"><span class="pre">WandbCheckpoint.on_save_checkpoint()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.checkpoint_sklearn.WandbCheckpoint.setup"><code class="docutils literal notranslate"><span class="pre">WandbCheckpoint.setup()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.callbacks/#module-stable_pretraining.callbacks.cleanup">stable_pretraining.callbacks.cleanup module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.cleanup.CleanUpCallback"><code class="docutils literal notranslate"><span class="pre">CleanUpCallback</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.cleanup.CleanUpCallback.on_exception"><code class="docutils literal notranslate"><span class="pre">CleanUpCallback.on_exception()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.cleanup.CleanUpCallback.on_fit_end"><code class="docutils literal notranslate"><span class="pre">CleanUpCallback.on_fit_end()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.cleanup.CleanUpCallback.on_train_epoch_end"><code class="docutils literal notranslate"><span class="pre">CleanUpCallback.on_train_epoch_end()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.cleanup.human_size"><code class="docutils literal notranslate"><span class="pre">human_size()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.callbacks/#module-stable_pretraining.callbacks.clip_zero_shot">stable_pretraining.callbacks.clip_zero_shot module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.clip_zero_shot.CLIPZeroShot"><code class="docutils literal notranslate"><span class="pre">CLIPZeroShot</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.clip_zero_shot.CLIPZeroShot.on_validation_batch_end"><code class="docutils literal notranslate"><span class="pre">CLIPZeroShot.on_validation_batch_end()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.clip_zero_shot.CLIPZeroShot.setup"><code class="docutils literal notranslate"><span class="pre">CLIPZeroShot.setup()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.callbacks/#module-stable_pretraining.callbacks.cpu_offload">stable_pretraining.callbacks.cpu_offload module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.cpu_offload.CPUOffloadCallback"><code class="docutils literal notranslate"><span class="pre">CPUOffloadCallback</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.cpu_offload.CPUOffloadCallback.load_state_dict"><code class="docutils literal notranslate"><span class="pre">CPUOffloadCallback.load_state_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.cpu_offload.CPUOffloadCallback.on_exception"><code class="docutils literal notranslate"><span class="pre">CPUOffloadCallback.on_exception()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.cpu_offload.CPUOffloadCallback.on_save_checkpoint"><code class="docutils literal notranslate"><span class="pre">CPUOffloadCallback.on_save_checkpoint()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.cpu_offload.CPUOffloadCallback.on_train_end"><code class="docutils literal notranslate"><span class="pre">CPUOffloadCallback.on_train_end()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.cpu_offload.CPUOffloadCallback.on_train_start"><code class="docutils literal notranslate"><span class="pre">CPUOffloadCallback.on_train_start()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.cpu_offload.CPUOffloadCallback.setup"><code class="docutils literal notranslate"><span class="pre">CPUOffloadCallback.setup()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.cpu_offload.CPUOffloadCallback.state_dict"><code class="docutils literal notranslate"><span class="pre">CPUOffloadCallback.state_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.cpu_offload.CPUOffloadCallback.teardown"><code class="docutils literal notranslate"><span class="pre">CPUOffloadCallback.teardown()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.callbacks/#module-stable_pretraining.callbacks.earlystop">stable_pretraining.callbacks.earlystop module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.earlystop.EpochMilestones"><code class="docutils literal notranslate"><span class="pre">EpochMilestones</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.earlystop.EpochMilestones.on_training_epoch_end"><code class="docutils literal notranslate"><span class="pre">EpochMilestones.on_training_epoch_end()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.earlystop.EpochMilestones.on_validation_epoch_end"><code class="docutils literal notranslate"><span class="pre">EpochMilestones.on_validation_epoch_end()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.earlystop.to_scalar"><code class="docutils literal notranslate"><span class="pre">to_scalar()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.callbacks/#module-stable_pretraining.callbacks.embedding_cache">stable_pretraining.callbacks.embedding_cache module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.embedding_cache.EmbeddingCache"><code class="docutils literal notranslate"><span class="pre">EmbeddingCache</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.embedding_cache.EmbeddingCache.forward_hook_fn"><code class="docutils literal notranslate"><span class="pre">EmbeddingCache.forward_hook_fn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.embedding_cache.EmbeddingCache.on_test_batch_start"><code class="docutils literal notranslate"><span class="pre">EmbeddingCache.on_test_batch_start()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.embedding_cache.EmbeddingCache.on_train_batch_start"><code class="docutils literal notranslate"><span class="pre">EmbeddingCache.on_train_batch_start()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.embedding_cache.EmbeddingCache.on_validation_batch_start"><code class="docutils literal notranslate"><span class="pre">EmbeddingCache.on_validation_batch_start()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.embedding_cache.EmbeddingCache.setup"><code class="docutils literal notranslate"><span class="pre">EmbeddingCache.setup()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.embedding_cache.EmbeddingCache.teardown"><code class="docutils literal notranslate"><span class="pre">EmbeddingCache.teardown()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.callbacks/#module-stable_pretraining.callbacks.env_info">stable_pretraining.callbacks.env_info module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.env_info.EnvironmentDumpCallback"><code class="docutils literal notranslate"><span class="pre">EnvironmentDumpCallback</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.env_info.EnvironmentDumpCallback.setup"><code class="docutils literal notranslate"><span class="pre">EnvironmentDumpCallback.setup()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.env_info.EnvironmentDumpCallback.teardown"><code class="docutils literal notranslate"><span class="pre">EnvironmentDumpCallback.teardown()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.callbacks/#module-stable_pretraining.callbacks.factories">stable_pretraining.callbacks.factories module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.factories.default"><code class="docutils literal notranslate"><span class="pre">default()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.callbacks/#module-stable_pretraining.callbacks.image_retrieval">stable_pretraining.callbacks.image_retrieval module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.image_retrieval.ImageRetrieval"><code class="docutils literal notranslate"><span class="pre">ImageRetrieval</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.image_retrieval.ImageRetrieval.NAME"><code class="docutils literal notranslate"><span class="pre">ImageRetrieval.NAME</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.image_retrieval.ImageRetrieval.on_validation_epoch_end"><code class="docutils literal notranslate"><span class="pre">ImageRetrieval.on_validation_epoch_end()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.image_retrieval.ImageRetrieval.on_validation_epoch_start"><code class="docutils literal notranslate"><span class="pre">ImageRetrieval.on_validation_epoch_start()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.image_retrieval.ImageRetrieval.state_key"><code class="docutils literal notranslate"><span class="pre">ImageRetrieval.state_key</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.image_retrieval.wrap_validation_step"><code class="docutils literal notranslate"><span class="pre">wrap_validation_step()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.callbacks/#module-stable_pretraining.callbacks.knn">stable_pretraining.callbacks.knn module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.knn.OnlineKNN"><code class="docutils literal notranslate"><span class="pre">OnlineKNN</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.knn.OnlineKNN.on_validation_batch_end"><code class="docutils literal notranslate"><span class="pre">OnlineKNN.on_validation_batch_end()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.knn.OnlineKNN.setup"><code class="docutils literal notranslate"><span class="pre">OnlineKNN.setup()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.knn.OnlineKNN.state_key"><code class="docutils literal notranslate"><span class="pre">OnlineKNN.state_key</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.callbacks/#module-stable_pretraining.callbacks.latent_viz">stable_pretraining.callbacks.latent_viz module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.latent_viz.LatentViz"><code class="docutils literal notranslate"><span class="pre">LatentViz</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.latent_viz.LatentViz.on_train_batch_end"><code class="docutils literal notranslate"><span class="pre">LatentViz.on_train_batch_end()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.latent_viz.LatentViz.on_validation_epoch_end"><code class="docutils literal notranslate"><span class="pre">LatentViz.on_validation_epoch_end()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.latent_viz.LatentViz.projection_module"><code class="docutils literal notranslate"><span class="pre">LatentViz.projection_module</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.latent_viz.LatentViz.setup"><code class="docutils literal notranslate"><span class="pre">LatentViz.setup()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.latent_viz.LatentViz.setup_optimizer"><code class="docutils literal notranslate"><span class="pre">LatentViz.setup_optimizer()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.callbacks/#module-stable_pretraining.callbacks.lidar">stable_pretraining.callbacks.lidar module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.lidar.LiDAR"><code class="docutils literal notranslate"><span class="pre">LiDAR</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.lidar.LiDAR.on_validation_batch_end"><code class="docutils literal notranslate"><span class="pre">LiDAR.on_validation_batch_end()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.lidar.LiDAR.setup"><code class="docutils literal notranslate"><span class="pre">LiDAR.setup()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.lidar.LiDAR.state_key"><code class="docutils literal notranslate"><span class="pre">LiDAR.state_key</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.callbacks/#module-stable_pretraining.callbacks.probe">stable_pretraining.callbacks.probe module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.probe.OnlineProbe"><code class="docutils literal notranslate"><span class="pre">OnlineProbe</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.probe.OnlineProbe.configure_model"><code class="docutils literal notranslate"><span class="pre">OnlineProbe.configure_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.probe.OnlineProbe.wrap_forward"><code class="docutils literal notranslate"><span class="pre">OnlineProbe.wrap_forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.callbacks/#module-stable_pretraining.callbacks.queue">stable_pretraining.callbacks.queue module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.queue.OnlineQueue"><code class="docutils literal notranslate"><span class="pre">OnlineQueue</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.queue.OnlineQueue.data"><code class="docutils literal notranslate"><span class="pre">OnlineQueue.data</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.queue.OnlineQueue.actual_queue_length"><code class="docutils literal notranslate"><span class="pre">OnlineQueue.actual_queue_length</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#id0"><code class="docutils literal notranslate"><span class="pre">OnlineQueue.actual_queue_length</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#id21"><code class="docutils literal notranslate"><span class="pre">OnlineQueue.data</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.queue.OnlineQueue.on_train_batch_end"><code class="docutils literal notranslate"><span class="pre">OnlineQueue.on_train_batch_end()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.queue.OnlineQueue.on_validation_epoch_end"><code class="docutils literal notranslate"><span class="pre">OnlineQueue.on_validation_epoch_end()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.queue.OnlineQueue.on_validation_epoch_start"><code class="docutils literal notranslate"><span class="pre">OnlineQueue.on_validation_epoch_start()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.queue.OnlineQueue.setup"><code class="docutils literal notranslate"><span class="pre">OnlineQueue.setup()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.queue.find_or_create_queue_callback"><code class="docutils literal notranslate"><span class="pre">find_or_create_queue_callback()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.callbacks/#module-stable_pretraining.callbacks.rankme">stable_pretraining.callbacks.rankme module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.rankme.RankMe"><code class="docutils literal notranslate"><span class="pre">RankMe</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.rankme.RankMe.on_validation_batch_end"><code class="docutils literal notranslate"><span class="pre">RankMe.on_validation_batch_end()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.rankme.RankMe.setup"><code class="docutils literal notranslate"><span class="pre">RankMe.setup()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.rankme.RankMe.state_key"><code class="docutils literal notranslate"><span class="pre">RankMe.state_key</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.callbacks/#module-stable_pretraining.callbacks.registry">stable_pretraining.callbacks.registry module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.registry.ModuleRegistryCallback"><code class="docutils literal notranslate"><span class="pre">ModuleRegistryCallback</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.registry.ModuleRegistryCallback.setup"><code class="docutils literal notranslate"><span class="pre">ModuleRegistryCallback.setup()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.registry.ModuleRegistryCallback.teardown"><code class="docutils literal notranslate"><span class="pre">ModuleRegistryCallback.teardown()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.registry.get_module"><code class="docutils literal notranslate"><span class="pre">get_module()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.registry.log"><code class="docutils literal notranslate"><span class="pre">log()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.registry.log_dict"><code class="docutils literal notranslate"><span class="pre">log_dict()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.callbacks/#module-stable_pretraining.callbacks.teacher_student">stable_pretraining.callbacks.teacher_student module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.teacher_student.TeacherStudentCallback"><code class="docutils literal notranslate"><span class="pre">TeacherStudentCallback</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.teacher_student.TeacherStudentCallback.on_after_backward"><code class="docutils literal notranslate"><span class="pre">TeacherStudentCallback.on_after_backward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.teacher_student.TeacherStudentCallback.on_fit_start"><code class="docutils literal notranslate"><span class="pre">TeacherStudentCallback.on_fit_start()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.teacher_student.TeacherStudentCallback.on_train_batch_end"><code class="docutils literal notranslate"><span class="pre">TeacherStudentCallback.on_train_batch_end()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.callbacks/#module-stable_pretraining.callbacks.trainer_info">stable_pretraining.callbacks.trainer_info module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.trainer_info.LoggingCallback"><code class="docutils literal notranslate"><span class="pre">LoggingCallback</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.trainer_info.LoggingCallback.on_validation_end"><code class="docutils literal notranslate"><span class="pre">LoggingCallback.on_validation_end()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.trainer_info.ModuleSummary"><code class="docutils literal notranslate"><span class="pre">ModuleSummary</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.trainer_info.ModuleSummary.setup"><code class="docutils literal notranslate"><span class="pre">ModuleSummary.setup()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.trainer_info.SLURMInfo"><code class="docutils literal notranslate"><span class="pre">SLURMInfo</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.trainer_info.SLURMInfo.setup"><code class="docutils literal notranslate"><span class="pre">SLURMInfo.setup()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.trainer_info.TrainerInfo"><code class="docutils literal notranslate"><span class="pre">TrainerInfo</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.trainer_info.TrainerInfo.setup"><code class="docutils literal notranslate"><span class="pre">TrainerInfo.setup()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.callbacks/#module-stable_pretraining.callbacks.unused_parameters">stable_pretraining.callbacks.unused_parameters module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.unused_parameters.LogUnusedParametersOnce"><code class="docutils literal notranslate"><span class="pre">LogUnusedParametersOnce</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.unused_parameters.LogUnusedParametersOnce.on_after_backward"><code class="docutils literal notranslate"><span class="pre">LogUnusedParametersOnce.on_after_backward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.unused_parameters.LogUnusedParametersOnce.on_train_batch_end"><code class="docutils literal notranslate"><span class="pre">LogUnusedParametersOnce.on_train_batch_end()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.unused_parameters.LogUnusedParametersOnce.on_train_batch_start"><code class="docutils literal notranslate"><span class="pre">LogUnusedParametersOnce.on_train_batch_start()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.callbacks/#module-stable_pretraining.callbacks.utils">stable_pretraining.callbacks.utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.utils.EarlyStopping"><code class="docutils literal notranslate"><span class="pre">EarlyStopping</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.utils.EarlyStopping.should_stop"><code class="docutils literal notranslate"><span class="pre">EarlyStopping.should_stop()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.utils.TrainableCallback"><code class="docutils literal notranslate"><span class="pre">TrainableCallback</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.utils.TrainableCallback.configure_model"><code class="docutils literal notranslate"><span class="pre">TrainableCallback.configure_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.utils.TrainableCallback.module"><code class="docutils literal notranslate"><span class="pre">TrainableCallback.module</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.utils.TrainableCallback.setup_optimizer"><code class="docutils literal notranslate"><span class="pre">TrainableCallback.setup_optimizer()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.utils.TrainableCallback.setup_scheduler"><code class="docutils literal notranslate"><span class="pre">TrainableCallback.setup_scheduler()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.utils.TrainableCallback.state_key"><code class="docutils literal notranslate"><span class="pre">TrainableCallback.state_key</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.utils.TrainableCallback.wrap_configure_model"><code class="docutils literal notranslate"><span class="pre">TrainableCallback.wrap_configure_model()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.utils.TrainableCallback.wrap_configure_optimizers"><code class="docutils literal notranslate"><span class="pre">TrainableCallback.wrap_configure_optimizers()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.utils.format_metrics_as_dict"><code class="docutils literal notranslate"><span class="pre">format_metrics_as_dict()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.callbacks/#module-stable_pretraining.callbacks.wd_schedule">stable_pretraining.callbacks.wd_schedule module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.wd_schedule.WeightDecayUpdater"><code class="docutils literal notranslate"><span class="pre">WeightDecayUpdater</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.wd_schedule.WeightDecayUpdater.load_state_dict"><code class="docutils literal notranslate"><span class="pre">WeightDecayUpdater.load_state_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.wd_schedule.WeightDecayUpdater.on_before_optimizer_step"><code class="docutils literal notranslate"><span class="pre">WeightDecayUpdater.on_before_optimizer_step()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.wd_schedule.WeightDecayUpdater.on_fit_start"><code class="docutils literal notranslate"><span class="pre">WeightDecayUpdater.on_fit_start()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.wd_schedule.WeightDecayUpdater.state_dict"><code class="docutils literal notranslate"><span class="pre">WeightDecayUpdater.state_dict()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.callbacks/#module-stable_pretraining.callbacks.writer">stable_pretraining.callbacks.writer module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.writer.OnlineWriter"><code class="docutils literal notranslate"><span class="pre">OnlineWriter</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.writer.OnlineWriter.dump"><code class="docutils literal notranslate"><span class="pre">OnlineWriter.dump()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.writer.OnlineWriter.is_writing_epoch"><code class="docutils literal notranslate"><span class="pre">OnlineWriter.is_writing_epoch()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.writer.OnlineWriter.on_predict_batch_end"><code class="docutils literal notranslate"><span class="pre">OnlineWriter.on_predict_batch_end()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.writer.OnlineWriter.on_sanity_check_end"><code class="docutils literal notranslate"><span class="pre">OnlineWriter.on_sanity_check_end()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.writer.OnlineWriter.on_sanity_check_start"><code class="docutils literal notranslate"><span class="pre">OnlineWriter.on_sanity_check_start()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.writer.OnlineWriter.on_test_batch_end"><code class="docutils literal notranslate"><span class="pre">OnlineWriter.on_test_batch_end()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.writer.OnlineWriter.on_train_batch_end"><code class="docutils literal notranslate"><span class="pre">OnlineWriter.on_train_batch_end()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.writer.OnlineWriter.on_validation_batch_end"><code class="docutils literal notranslate"><span class="pre">OnlineWriter.on_validation_batch_end()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.writer.OnlineWriter.write_at_phase"><code class="docutils literal notranslate"><span class="pre">OnlineWriter.write_at_phase()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.callbacks/#module-stable_pretraining.callbacks">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../stable_pretraining.data/">stable_pretraining.data package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.data/#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.data/#module-stable_pretraining.data.collate">stable_pretraining.data.collate module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.collate.Collator"><code class="docutils literal notranslate"><span class="pre">Collator</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.data/#module-stable_pretraining.data.dataset_stats">stable_pretraining.data.dataset_stats module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.data/#module-stable_pretraining.data.datasets">stable_pretraining.data.datasets module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.datasets.Dataset"><code class="docutils literal notranslate"><span class="pre">Dataset</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.datasets.Dataset.process_sample"><code class="docutils literal notranslate"><span class="pre">Dataset.process_sample()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.datasets.Dataset.set_pl_trainer"><code class="docutils literal notranslate"><span class="pre">Dataset.set_pl_trainer()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.datasets.FromTorchDataset"><code class="docutils literal notranslate"><span class="pre">FromTorchDataset</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.datasets.FromTorchDataset.column_names"><code class="docutils literal notranslate"><span class="pre">FromTorchDataset.column_names</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.datasets.HFDataset"><code class="docutils literal notranslate"><span class="pre">HFDataset</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.datasets.HFDataset.column_names"><code class="docutils literal notranslate"><span class="pre">HFDataset.column_names</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.datasets.HFDataset.is_saved_with_save_to_disk"><code class="docutils literal notranslate"><span class="pre">HFDataset.is_saved_with_save_to_disk()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.datasets.Subset"><code class="docutils literal notranslate"><span class="pre">Subset</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.datasets.Subset.column_names"><code class="docutils literal notranslate"><span class="pre">Subset.column_names</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.datasets.Subset.dataset"><code class="docutils literal notranslate"><span class="pre">Subset.dataset</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.datasets.Subset.indices"><code class="docutils literal notranslate"><span class="pre">Subset.indices</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.data/#module-stable_pretraining.data.download">stable_pretraining.data.download module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.download.bulk_download"><code class="docutils literal notranslate"><span class="pre">bulk_download()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.download.download"><code class="docutils literal notranslate"><span class="pre">download()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.data/#module-stable_pretraining.data.masking">stable_pretraining.data.masking module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.masking.multi_block_mask"><code class="docutils literal notranslate"><span class="pre">multi_block_mask()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.data/#module-stable_pretraining.data.module">stable_pretraining.data.module module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.module.DataModule"><code class="docutils literal notranslate"><span class="pre">DataModule</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.module.DataModule.load_state_dict"><code class="docutils literal notranslate"><span class="pre">DataModule.load_state_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.module.DataModule.predict_dataloader"><code class="docutils literal notranslate"><span class="pre">DataModule.predict_dataloader()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.module.DataModule.set_pl_trainer"><code class="docutils literal notranslate"><span class="pre">DataModule.set_pl_trainer()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.module.DataModule.setup"><code class="docutils literal notranslate"><span class="pre">DataModule.setup()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.module.DataModule.state_dict"><code class="docutils literal notranslate"><span class="pre">DataModule.state_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.module.DataModule.teardown"><code class="docutils literal notranslate"><span class="pre">DataModule.teardown()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.module.DataModule.test_dataloader"><code class="docutils literal notranslate"><span class="pre">DataModule.test_dataloader()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.module.DataModule.train_dataloader"><code class="docutils literal notranslate"><span class="pre">DataModule.train_dataloader()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.module.DataModule.val_dataloader"><code class="docutils literal notranslate"><span class="pre">DataModule.val_dataloader()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.module.DictFormat"><code class="docutils literal notranslate"><span class="pre">DictFormat</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.data/#module-stable_pretraining.data.sampler">stable_pretraining.data.sampler module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.sampler.RandomBatchSampler"><code class="docutils literal notranslate"><span class="pre">RandomBatchSampler</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.sampler.RepeatedRandomSampler"><code class="docutils literal notranslate"><span class="pre">RepeatedRandomSampler</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.sampler.SupervisedBatchSampler"><code class="docutils literal notranslate"><span class="pre">SupervisedBatchSampler</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.data/#module-stable_pretraining.data.synthetic_data">stable_pretraining.data.synthetic_data module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.synthetic_data.Categorical"><code class="docutils literal notranslate"><span class="pre">Categorical</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.synthetic_data.Categorical.sample"><code class="docutils literal notranslate"><span class="pre">Categorical.sample()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.synthetic_data.ExponentialMixtureNoiseModel"><code class="docutils literal notranslate"><span class="pre">ExponentialMixtureNoiseModel</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.synthetic_data.ExponentialMixtureNoiseModel.sample"><code class="docutils literal notranslate"><span class="pre">ExponentialMixtureNoiseModel.sample()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.synthetic_data.ExponentialNormalNoiseModel"><code class="docutils literal notranslate"><span class="pre">ExponentialNormalNoiseModel</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.synthetic_data.ExponentialNormalNoiseModel.sample"><code class="docutils literal notranslate"><span class="pre">ExponentialNormalNoiseModel.sample()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.synthetic_data.GMM"><code class="docutils literal notranslate"><span class="pre">GMM</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.synthetic_data.GMM.score"><code class="docutils literal notranslate"><span class="pre">GMM.score()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.synthetic_data.MinariEpisodeDataset"><code class="docutils literal notranslate"><span class="pre">MinariEpisodeDataset</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.synthetic_data.MinariEpisodeDataset.NAMES"><code class="docutils literal notranslate"><span class="pre">MinariEpisodeDataset.NAMES</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.synthetic_data.MinariEpisodeDataset.column_names"><code class="docutils literal notranslate"><span class="pre">MinariEpisodeDataset.column_names</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.synthetic_data.MinariEpisodeDataset.nested_step"><code class="docutils literal notranslate"><span class="pre">MinariEpisodeDataset.nested_step()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.synthetic_data.MinariEpisodeDataset.set_pl_trainer"><code class="docutils literal notranslate"><span class="pre">MinariEpisodeDataset.set_pl_trainer()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.synthetic_data.MinariStepsDataset"><code class="docutils literal notranslate"><span class="pre">MinariStepsDataset</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.synthetic_data.MinariStepsDataset.NAMES"><code class="docutils literal notranslate"><span class="pre">MinariStepsDataset.NAMES</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.synthetic_data.MinariStepsDataset.column_names"><code class="docutils literal notranslate"><span class="pre">MinariStepsDataset.column_names</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.synthetic_data.MinariStepsDataset.nested_step"><code class="docutils literal notranslate"><span class="pre">MinariStepsDataset.nested_step()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.synthetic_data.generate_perlin_noise_2d"><code class="docutils literal notranslate"><span class="pre">generate_perlin_noise_2d()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.synthetic_data.perlin_noise_3d"><code class="docutils literal notranslate"><span class="pre">perlin_noise_3d()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.synthetic_data.swiss_roll"><code class="docutils literal notranslate"><span class="pre">swiss_roll()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.data/#module-stable_pretraining.data.transforms">stable_pretraining.data.transforms module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.transforms.AdditiveGaussian"><code class="docutils literal notranslate"><span class="pre">AdditiveGaussian</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.transforms.AdditiveGaussian.BYPASS_VALUE"><code class="docutils literal notranslate"><span class="pre">AdditiveGaussian.BYPASS_VALUE</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.transforms.CenterCrop"><code class="docutils literal notranslate"><span class="pre">CenterCrop</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.transforms.ColorJitter"><code class="docutils literal notranslate"><span class="pre">ColorJitter</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.transforms.ColorJitter.get_params"><code class="docutils literal notranslate"><span class="pre">ColorJitter.get_params()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.transforms.Compose"><code class="docutils literal notranslate"><span class="pre">Compose</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.transforms.Conditional"><code class="docutils literal notranslate"><span class="pre">Conditional</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.transforms.ContextTargetsMultiBlockMask"><code class="docutils literal notranslate"><span class="pre">ContextTargetsMultiBlockMask</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.transforms.ControlledTransform"><code class="docutils literal notranslate"><span class="pre">ControlledTransform</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.transforms.GaussianBlur"><code class="docutils literal notranslate"><span class="pre">GaussianBlur</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.transforms.GaussianBlur.get_params"><code class="docutils literal notranslate"><span class="pre">GaussianBlur.get_params()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.transforms.Lambda"><code class="docutils literal notranslate"><span class="pre">Lambda</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.transforms.MultiViewTransform"><code class="docutils literal notranslate"><span class="pre">MultiViewTransform</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.transforms.PILGaussianBlur"><code class="docutils literal notranslate"><span class="pre">PILGaussianBlur</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.transforms.PatchMasking"><code class="docutils literal notranslate"><span class="pre">PatchMasking</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.transforms.RGB"><code class="docutils literal notranslate"><span class="pre">RGB</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.transforms.RandomChannelPermutation"><code class="docutils literal notranslate"><span class="pre">RandomChannelPermutation</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.transforms.RandomContiguousTemporalSampler"><code class="docutils literal notranslate"><span class="pre">RandomContiguousTemporalSampler</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.transforms.RandomCrop"><code class="docutils literal notranslate"><span class="pre">RandomCrop</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.transforms.RandomCrop.get_params"><code class="docutils literal notranslate"><span class="pre">RandomCrop.get_params()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.transforms.RandomGrayscale"><code class="docutils literal notranslate"><span class="pre">RandomGrayscale</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.transforms.RandomHorizontalFlip"><code class="docutils literal notranslate"><span class="pre">RandomHorizontalFlip</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.transforms.RandomMask"><code class="docutils literal notranslate"><span class="pre">RandomMask</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.transforms.RandomResizedCrop"><code class="docutils literal notranslate"><span class="pre">RandomResizedCrop</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.transforms.RandomResizedCrop.get_params"><code class="docutils literal notranslate"><span class="pre">RandomResizedCrop.get_params()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.transforms.RandomRotation"><code class="docutils literal notranslate"><span class="pre">RandomRotation</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.transforms.RandomRotation.get_params"><code class="docutils literal notranslate"><span class="pre">RandomRotation.get_params()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.transforms.RandomSolarize"><code class="docutils literal notranslate"><span class="pre">RandomSolarize</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.transforms.Resize"><code class="docutils literal notranslate"><span class="pre">Resize</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.transforms.RoundRobinMultiViewTransform"><code class="docutils literal notranslate"><span class="pre">RoundRobinMultiViewTransform</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.transforms.RoutingTransform"><code class="docutils literal notranslate"><span class="pre">RoutingTransform</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.transforms.ToImage"><code class="docutils literal notranslate"><span class="pre">ToImage</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.transforms.Transform"><code class="docutils literal notranslate"><span class="pre">Transform</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.transforms.Transform.get_name"><code class="docutils literal notranslate"><span class="pre">Transform.get_name()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.transforms.Transform.name"><code class="docutils literal notranslate"><span class="pre">Transform.name</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.transforms.Transform.nested_get"><code class="docutils literal notranslate"><span class="pre">Transform.nested_get()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.transforms.Transform.nested_set"><code class="docutils literal notranslate"><span class="pre">Transform.nested_set()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.transforms.Transform.single_nested_get"><code class="docutils literal notranslate"><span class="pre">Transform.single_nested_get()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.transforms.Transform.single_nested_set"><code class="docutils literal notranslate"><span class="pre">Transform.single_nested_set()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.transforms.UniformTemporalSubsample"><code class="docutils literal notranslate"><span class="pre">UniformTemporalSubsample</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.transforms.UniformTemporalSubsample.forward"><code class="docutils literal notranslate"><span class="pre">UniformTemporalSubsample.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.transforms.WrapTorchTransform"><code class="docutils literal notranslate"><span class="pre">WrapTorchTransform</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.transforms.random_seed"><code class="docutils literal notranslate"><span class="pre">random_seed()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.transforms.set_seed"><code class="docutils literal notranslate"><span class="pre">set_seed()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.transforms.to_image"><code class="docutils literal notranslate"><span class="pre">to_image()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.data/#module-stable_pretraining.data.utils">stable_pretraining.data.utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.utils.apply_masks"><code class="docutils literal notranslate"><span class="pre">apply_masks()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.utils.fold_views"><code class="docutils literal notranslate"><span class="pre">fold_views()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.utils.get_num_workers"><code class="docutils literal notranslate"><span class="pre">get_num_workers()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.utils.random_split"><code class="docutils literal notranslate"><span class="pre">random_split()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.data/#module-stable_pretraining.data">Module contents</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.Categorical"><code class="docutils literal notranslate"><span class="pre">Categorical</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.Categorical.sample"><code class="docutils literal notranslate"><span class="pre">Categorical.sample()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.Collator"><code class="docutils literal notranslate"><span class="pre">Collator</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.DataModule"><code class="docutils literal notranslate"><span class="pre">DataModule</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.DataModule.load_state_dict"><code class="docutils literal notranslate"><span class="pre">DataModule.load_state_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.DataModule.predict_dataloader"><code class="docutils literal notranslate"><span class="pre">DataModule.predict_dataloader()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.DataModule.set_pl_trainer"><code class="docutils literal notranslate"><span class="pre">DataModule.set_pl_trainer()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.DataModule.setup"><code class="docutils literal notranslate"><span class="pre">DataModule.setup()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.DataModule.state_dict"><code class="docutils literal notranslate"><span class="pre">DataModule.state_dict()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.DataModule.teardown"><code class="docutils literal notranslate"><span class="pre">DataModule.teardown()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.DataModule.test_dataloader"><code class="docutils literal notranslate"><span class="pre">DataModule.test_dataloader()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.DataModule.train_dataloader"><code class="docutils literal notranslate"><span class="pre">DataModule.train_dataloader()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.DataModule.val_dataloader"><code class="docutils literal notranslate"><span class="pre">DataModule.val_dataloader()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.Dataset"><code class="docutils literal notranslate"><span class="pre">Dataset</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.Dataset.process_sample"><code class="docutils literal notranslate"><span class="pre">Dataset.process_sample()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.Dataset.set_pl_trainer"><code class="docutils literal notranslate"><span class="pre">Dataset.set_pl_trainer()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.ExponentialMixtureNoiseModel"><code class="docutils literal notranslate"><span class="pre">ExponentialMixtureNoiseModel</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.ExponentialMixtureNoiseModel.sample"><code class="docutils literal notranslate"><span class="pre">ExponentialMixtureNoiseModel.sample()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.ExponentialNormalNoiseModel"><code class="docutils literal notranslate"><span class="pre">ExponentialNormalNoiseModel</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.ExponentialNormalNoiseModel.sample"><code class="docutils literal notranslate"><span class="pre">ExponentialNormalNoiseModel.sample()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.FromTorchDataset"><code class="docutils literal notranslate"><span class="pre">FromTorchDataset</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.FromTorchDataset.column_names"><code class="docutils literal notranslate"><span class="pre">FromTorchDataset.column_names</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.GMM"><code class="docutils literal notranslate"><span class="pre">GMM</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.GMM.score"><code class="docutils literal notranslate"><span class="pre">GMM.score()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.HFDataset"><code class="docutils literal notranslate"><span class="pre">HFDataset</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.HFDataset.column_names"><code class="docutils literal notranslate"><span class="pre">HFDataset.column_names</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.HFDataset.is_saved_with_save_to_disk"><code class="docutils literal notranslate"><span class="pre">HFDataset.is_saved_with_save_to_disk()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.MinariEpisodeDataset"><code class="docutils literal notranslate"><span class="pre">MinariEpisodeDataset</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.MinariEpisodeDataset.NAMES"><code class="docutils literal notranslate"><span class="pre">MinariEpisodeDataset.NAMES</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.MinariEpisodeDataset.column_names"><code class="docutils literal notranslate"><span class="pre">MinariEpisodeDataset.column_names</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.MinariEpisodeDataset.nested_step"><code class="docutils literal notranslate"><span class="pre">MinariEpisodeDataset.nested_step()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.MinariEpisodeDataset.set_pl_trainer"><code class="docutils literal notranslate"><span class="pre">MinariEpisodeDataset.set_pl_trainer()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.MinariStepsDataset"><code class="docutils literal notranslate"><span class="pre">MinariStepsDataset</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.MinariStepsDataset.NAMES"><code class="docutils literal notranslate"><span class="pre">MinariStepsDataset.NAMES</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.MinariStepsDataset.column_names"><code class="docutils literal notranslate"><span class="pre">MinariStepsDataset.column_names</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.MinariStepsDataset.nested_step"><code class="docutils literal notranslate"><span class="pre">MinariStepsDataset.nested_step()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.RandomBatchSampler"><code class="docutils literal notranslate"><span class="pre">RandomBatchSampler</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.RepeatedRandomSampler"><code class="docutils literal notranslate"><span class="pre">RepeatedRandomSampler</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.Subset"><code class="docutils literal notranslate"><span class="pre">Subset</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.Subset.column_names"><code class="docutils literal notranslate"><span class="pre">Subset.column_names</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.Subset.dataset"><code class="docutils literal notranslate"><span class="pre">Subset.dataset</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.Subset.indices"><code class="docutils literal notranslate"><span class="pre">Subset.indices</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.SupervisedBatchSampler"><code class="docutils literal notranslate"><span class="pre">SupervisedBatchSampler</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.bulk_download"><code class="docutils literal notranslate"><span class="pre">bulk_download()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.download"><code class="docutils literal notranslate"><span class="pre">download()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.fold_views"><code class="docutils literal notranslate"><span class="pre">fold_views()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.generate_perlin_noise_2d"><code class="docutils literal notranslate"><span class="pre">generate_perlin_noise_2d()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.perlin_noise_3d"><code class="docutils literal notranslate"><span class="pre">perlin_noise_3d()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.random_split"><code class="docutils literal notranslate"><span class="pre">random_split()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.data/#stable_pretraining.data.swiss_roll"><code class="docutils literal notranslate"><span class="pre">swiss_roll()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../stable_pretraining.losses/">stable_pretraining.losses package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.losses/#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.losses/#module-stable_pretraining.losses.dino">stable_pretraining.losses.dino module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.losses/#stable_pretraining.losses.dino.DINOv1Loss"><code class="docutils literal notranslate"><span class="pre">DINOv1Loss</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.losses/#stable_pretraining.losses.dino.DINOv1Loss.apply_center_update"><code class="docutils literal notranslate"><span class="pre">DINOv1Loss.apply_center_update()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.losses/#stable_pretraining.losses.dino.DINOv1Loss.forward"><code class="docutils literal notranslate"><span class="pre">DINOv1Loss.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.losses/#stable_pretraining.losses.dino.DINOv1Loss.sinkhorn_knopp_teacher"><code class="docutils literal notranslate"><span class="pre">DINOv1Loss.sinkhorn_knopp_teacher()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.losses/#stable_pretraining.losses.dino.DINOv1Loss.softmax_center_teacher"><code class="docutils literal notranslate"><span class="pre">DINOv1Loss.softmax_center_teacher()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.losses/#stable_pretraining.losses.dino.DINOv1Loss.update_center"><code class="docutils literal notranslate"><span class="pre">DINOv1Loss.update_center()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.losses/#stable_pretraining.losses.dino.DINOv2Loss"><code class="docutils literal notranslate"><span class="pre">DINOv2Loss</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.losses/#stable_pretraining.losses.dino.DINOv2Loss.forward"><code class="docutils literal notranslate"><span class="pre">DINOv2Loss.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.losses/#stable_pretraining.losses.dino.cross_entropy_loss"><code class="docutils literal notranslate"><span class="pre">cross_entropy_loss()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.losses/#stable_pretraining.losses.dino.iBOTPatchLoss"><code class="docutils literal notranslate"><span class="pre">iBOTPatchLoss</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.losses/#stable_pretraining.losses.dino.iBOTPatchLoss.forward"><code class="docutils literal notranslate"><span class="pre">iBOTPatchLoss.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.losses/#stable_pretraining.losses.dino.iBOTPatchLoss.sinkhorn_knopp_teacher"><code class="docutils literal notranslate"><span class="pre">iBOTPatchLoss.sinkhorn_knopp_teacher()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.losses/#module-stable_pretraining.losses.joint_embedding">stable_pretraining.losses.joint_embedding module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.losses/#stable_pretraining.losses.joint_embedding.BYOLLoss"><code class="docutils literal notranslate"><span class="pre">BYOLLoss</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.losses/#stable_pretraining.losses.joint_embedding.BYOLLoss.forward"><code class="docutils literal notranslate"><span class="pre">BYOLLoss.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.losses/#stable_pretraining.losses.joint_embedding.BarlowTwinsLoss"><code class="docutils literal notranslate"><span class="pre">BarlowTwinsLoss</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.losses/#stable_pretraining.losses.joint_embedding.BarlowTwinsLoss.forward"><code class="docutils literal notranslate"><span class="pre">BarlowTwinsLoss.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.losses/#stable_pretraining.losses.joint_embedding.InfoNCELoss"><code class="docutils literal notranslate"><span class="pre">InfoNCELoss</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.losses/#stable_pretraining.losses.joint_embedding.InfoNCELoss.forward"><code class="docutils literal notranslate"><span class="pre">InfoNCELoss.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.losses/#stable_pretraining.losses.joint_embedding.NTXEntLoss"><code class="docutils literal notranslate"><span class="pre">NTXEntLoss</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.losses/#stable_pretraining.losses.joint_embedding.NTXEntLoss.forward"><code class="docutils literal notranslate"><span class="pre">NTXEntLoss.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.losses/#stable_pretraining.losses.joint_embedding.SwAVLoss"><code class="docutils literal notranslate"><span class="pre">SwAVLoss</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.losses/#stable_pretraining.losses.joint_embedding.SwAVLoss.forward"><code class="docutils literal notranslate"><span class="pre">SwAVLoss.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.losses/#stable_pretraining.losses.joint_embedding.SwAVLoss.sinkhorn"><code class="docutils literal notranslate"><span class="pre">SwAVLoss.sinkhorn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.losses/#stable_pretraining.losses.joint_embedding.SwAVLoss.swapped_prediction"><code class="docutils literal notranslate"><span class="pre">SwAVLoss.swapped_prediction()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.losses/#stable_pretraining.losses.joint_embedding.VICRegLoss"><code class="docutils literal notranslate"><span class="pre">VICRegLoss</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.losses/#stable_pretraining.losses.joint_embedding.VICRegLoss.forward"><code class="docutils literal notranslate"><span class="pre">VICRegLoss.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.losses/#module-stable_pretraining.losses.multimodal">stable_pretraining.losses.multimodal module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.losses/#stable_pretraining.losses.multimodal.CLIPLoss"><code class="docutils literal notranslate"><span class="pre">CLIPLoss</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.losses/#stable_pretraining.losses.multimodal.CLIPLoss.forward"><code class="docutils literal notranslate"><span class="pre">CLIPLoss.forward()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.losses/#module-stable_pretraining.losses.reconstruction">stable_pretraining.losses.reconstruction module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.losses/#stable_pretraining.losses.reconstruction.mae"><code class="docutils literal notranslate"><span class="pre">mae()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.losses/#module-stable_pretraining.losses.utils">stable_pretraining.losses.utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.losses/#stable_pretraining.losses.utils.NegativeCosineSimilarity"><code class="docutils literal notranslate"><span class="pre">NegativeCosineSimilarity</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.losses/#stable_pretraining.losses.utils.NegativeCosineSimilarity.forward"><code class="docutils literal notranslate"><span class="pre">NegativeCosineSimilarity.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.losses/#stable_pretraining.losses.utils.off_diagonal"><code class="docutils literal notranslate"><span class="pre">off_diagonal()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.losses/#stable_pretraining.losses.utils.sinkhorn_knopp"><code class="docutils literal notranslate"><span class="pre">sinkhorn_knopp()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.losses/#module-stable_pretraining.losses">Module contents</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.losses/#stable_pretraining.losses.BYOLLoss"><code class="docutils literal notranslate"><span class="pre">BYOLLoss</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.losses/#stable_pretraining.losses.BYOLLoss.forward"><code class="docutils literal notranslate"><span class="pre">BYOLLoss.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.losses/#stable_pretraining.losses.BarlowTwinsLoss"><code class="docutils literal notranslate"><span class="pre">BarlowTwinsLoss</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.losses/#stable_pretraining.losses.BarlowTwinsLoss.forward"><code class="docutils literal notranslate"><span class="pre">BarlowTwinsLoss.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.losses/#stable_pretraining.losses.CLIPLoss"><code class="docutils literal notranslate"><span class="pre">CLIPLoss</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.losses/#stable_pretraining.losses.CLIPLoss.forward"><code class="docutils literal notranslate"><span class="pre">CLIPLoss.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.losses/#stable_pretraining.losses.DINOv1Loss"><code class="docutils literal notranslate"><span class="pre">DINOv1Loss</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.losses/#stable_pretraining.losses.DINOv1Loss.apply_center_update"><code class="docutils literal notranslate"><span class="pre">DINOv1Loss.apply_center_update()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.losses/#stable_pretraining.losses.DINOv1Loss.forward"><code class="docutils literal notranslate"><span class="pre">DINOv1Loss.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.losses/#stable_pretraining.losses.DINOv1Loss.sinkhorn_knopp_teacher"><code class="docutils literal notranslate"><span class="pre">DINOv1Loss.sinkhorn_knopp_teacher()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.losses/#stable_pretraining.losses.DINOv1Loss.softmax_center_teacher"><code class="docutils literal notranslate"><span class="pre">DINOv1Loss.softmax_center_teacher()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.losses/#stable_pretraining.losses.DINOv1Loss.update_center"><code class="docutils literal notranslate"><span class="pre">DINOv1Loss.update_center()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.losses/#stable_pretraining.losses.DINOv2Loss"><code class="docutils literal notranslate"><span class="pre">DINOv2Loss</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.losses/#stable_pretraining.losses.DINOv2Loss.forward"><code class="docutils literal notranslate"><span class="pre">DINOv2Loss.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.losses/#stable_pretraining.losses.NTXEntLoss"><code class="docutils literal notranslate"><span class="pre">NTXEntLoss</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.losses/#stable_pretraining.losses.NTXEntLoss.forward"><code class="docutils literal notranslate"><span class="pre">NTXEntLoss.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.losses/#stable_pretraining.losses.NegativeCosineSimilarity"><code class="docutils literal notranslate"><span class="pre">NegativeCosineSimilarity</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.losses/#stable_pretraining.losses.NegativeCosineSimilarity.forward"><code class="docutils literal notranslate"><span class="pre">NegativeCosineSimilarity.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.losses/#stable_pretraining.losses.VICRegLoss"><code class="docutils literal notranslate"><span class="pre">VICRegLoss</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.losses/#stable_pretraining.losses.VICRegLoss.forward"><code class="docutils literal notranslate"><span class="pre">VICRegLoss.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.losses/#stable_pretraining.losses.iBOTPatchLoss"><code class="docutils literal notranslate"><span class="pre">iBOTPatchLoss</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.losses/#stable_pretraining.losses.iBOTPatchLoss.forward"><code class="docutils literal notranslate"><span class="pre">iBOTPatchLoss.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.losses/#stable_pretraining.losses.iBOTPatchLoss.sinkhorn_knopp_teacher"><code class="docutils literal notranslate"><span class="pre">iBOTPatchLoss.sinkhorn_knopp_teacher()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.losses/#stable_pretraining.losses.mae"><code class="docutils literal notranslate"><span class="pre">mae()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.losses/#stable_pretraining.losses.off_diagonal"><code class="docutils literal notranslate"><span class="pre">off_diagonal()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.losses/#stable_pretraining.losses.sinkhorn_knopp"><code class="docutils literal notranslate"><span class="pre">sinkhorn_knopp()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../stable_pretraining.optim/">stable_pretraining.optim package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.optim/#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.optim/#module-stable_pretraining.optim.lars">stable_pretraining.optim.lars module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.optim/#stable_pretraining.optim.lars.LARS"><code class="docutils literal notranslate"><span class="pre">LARS</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.optim/#stable_pretraining.optim.lars.LARS.step"><code class="docutils literal notranslate"><span class="pre">LARS.step()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.optim/#module-stable_pretraining.optim.lr_scheduler">stable_pretraining.optim.lr_scheduler module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.optim/#stable_pretraining.optim.lr_scheduler.CosineDecayer"><code class="docutils literal notranslate"><span class="pre">CosineDecayer</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.optim/#stable_pretraining.optim.lr_scheduler.LinearWarmup"><code class="docutils literal notranslate"><span class="pre">LinearWarmup()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.optim/#stable_pretraining.optim.lr_scheduler.LinearWarmupCosineAnnealing"><code class="docutils literal notranslate"><span class="pre">LinearWarmupCosineAnnealing()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.optim/#stable_pretraining.optim.lr_scheduler.LinearWarmupCosineAnnealingLR"><code class="docutils literal notranslate"><span class="pre">LinearWarmupCosineAnnealingLR</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.optim/#stable_pretraining.optim.lr_scheduler.LinearWarmupCosineAnnealingLR.get_lr"><code class="docutils literal notranslate"><span class="pre">LinearWarmupCosineAnnealingLR.get_lr()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.optim/#stable_pretraining.optim.lr_scheduler.LinearWarmupCyclicAnnealing"><code class="docutils literal notranslate"><span class="pre">LinearWarmupCyclicAnnealing()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.optim/#stable_pretraining.optim.lr_scheduler.LinearWarmupThreeStepsAnnealing"><code class="docutils literal notranslate"><span class="pre">LinearWarmupThreeStepsAnnealing()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.optim/#stable_pretraining.optim.lr_scheduler.create_scheduler"><code class="docutils literal notranslate"><span class="pre">create_scheduler()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.optim/#module-stable_pretraining.optim.utils">stable_pretraining.optim.utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.optim/#stable_pretraining.optim.utils.create_optimizer"><code class="docutils literal notranslate"><span class="pre">create_optimizer()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.optim/#stable_pretraining.optim.utils.is_bias_or_norm_param"><code class="docutils literal notranslate"><span class="pre">is_bias_or_norm_param()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.optim/#stable_pretraining.optim.utils.split_params_for_weight_decay"><code class="docutils literal notranslate"><span class="pre">split_params_for_weight_decay()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.optim/#module-stable_pretraining.optim">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../stable_pretraining.utils/">stable_pretraining.utils package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.utils/#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.utils/#module-stable_pretraining.utils.batch_utils">stable_pretraining.utils.batch_utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.batch_utils.detach_tensors"><code class="docutils literal notranslate"><span class="pre">detach_tensors()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.batch_utils.get_data_from_batch_or_outputs"><code class="docutils literal notranslate"><span class="pre">get_data_from_batch_or_outputs()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.utils/#module-stable_pretraining.utils.config">stable_pretraining.utils.config module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.config.adapt_resnet_for_lowres"><code class="docutils literal notranslate"><span class="pre">adapt_resnet_for_lowres()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.config.execute_from_config"><code class="docutils literal notranslate"><span class="pre">execute_from_config()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.config.find_module"><code class="docutils literal notranslate"><span class="pre">find_module()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.config.is_dist"><code class="docutils literal notranslate"><span class="pre">is_dist()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.config.load_hparams_from_ckpt"><code class="docutils literal notranslate"><span class="pre">load_hparams_from_ckpt()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.config.replace_module"><code class="docutils literal notranslate"><span class="pre">replace_module()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.config.rgetattr"><code class="docutils literal notranslate"><span class="pre">rgetattr()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.config.rsetattr"><code class="docutils literal notranslate"><span class="pre">rsetattr()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.utils/#module-stable_pretraining.utils.data_generation">stable_pretraining.utils.data_generation module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.data_generation.generate_dae_samples"><code class="docutils literal notranslate"><span class="pre">generate_dae_samples()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.data_generation.generate_dm_samples"><code class="docutils literal notranslate"><span class="pre">generate_dm_samples()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.data_generation.generate_ssl_samples"><code class="docutils literal notranslate"><span class="pre">generate_ssl_samples()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.data_generation.generate_sup_samples"><code class="docutils literal notranslate"><span class="pre">generate_sup_samples()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.utils/#module-stable_pretraining.utils.distance_metrics">stable_pretraining.utils.distance_metrics module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.distance_metrics.compute_pairwise_distances"><code class="docutils literal notranslate"><span class="pre">compute_pairwise_distances()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.distance_metrics.compute_pairwise_distances_chunked"><code class="docutils literal notranslate"><span class="pre">compute_pairwise_distances_chunked()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.utils/#module-stable_pretraining.utils.distributed">stable_pretraining.utils.distributed module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.distributed.FullGatherLayer"><code class="docutils literal notranslate"><span class="pre">FullGatherLayer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.distributed.FullGatherLayer.backward"><code class="docutils literal notranslate"><span class="pre">FullGatherLayer.backward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.distributed.FullGatherLayer.forward"><code class="docutils literal notranslate"><span class="pre">FullGatherLayer.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.distributed.all_gather"><code class="docutils literal notranslate"><span class="pre">all_gather()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.distributed.all_reduce"><code class="docutils literal notranslate"><span class="pre">all_reduce()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.distributed.is_dist_avail_and_initialized"><code class="docutils literal notranslate"><span class="pre">is_dist_avail_and_initialized()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.utils/#module-stable_pretraining.utils.error_handling">stable_pretraining.utils.error_handling module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.error_handling.catch_errors"><code class="docutils literal notranslate"><span class="pre">catch_errors()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.error_handling.catch_errors_class"><code class="docutils literal notranslate"><span class="pre">catch_errors_class()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.error_handling.catch_errors_decorator"><code class="docutils literal notranslate"><span class="pre">catch_errors_decorator()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.error_handling.get_rank"><code class="docutils literal notranslate"><span class="pre">get_rank()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.error_handling.is_main_process"><code class="docutils literal notranslate"><span class="pre">is_main_process()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.error_handling.with_hf_retry_ratelimit"><code class="docutils literal notranslate"><span class="pre">with_hf_retry_ratelimit()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.utils/#module-stable_pretraining.utils.flops">stable_pretraining.utils.flops module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.flops.BudgetedFlopCounterMode"><code class="docutils literal notranslate"><span class="pre">BudgetedFlopCounterMode</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.flops.BudgetedFlopCounterMode.total_flops"><code class="docutils literal notranslate"><span class="pre">BudgetedFlopCounterMode.total_flops</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.flops.FLOPBudgetExceeded"><code class="docutils literal notranslate"><span class="pre">FLOPBudgetExceeded</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.flops.flop_budget"><code class="docutils literal notranslate"><span class="pre">flop_budget()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.utils/#module-stable_pretraining.utils.gdrive_utils">stable_pretraining.utils.gdrive_utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.gdrive_utils.GDriveUploader"><code class="docutils literal notranslate"><span class="pre">GDriveUploader</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.gdrive_utils.GDriveUploader.get_folder_id"><code class="docutils literal notranslate"><span class="pre">GDriveUploader.get_folder_id()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.gdrive_utils.GDriveUploader.get_folder_url"><code class="docutils literal notranslate"><span class="pre">GDriveUploader.get_folder_url()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.gdrive_utils.GDriveUploader.get_queue_size"><code class="docutils literal notranslate"><span class="pre">GDriveUploader.get_queue_size()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.gdrive_utils.GDriveUploader.upload_file"><code class="docutils literal notranslate"><span class="pre">GDriveUploader.upload_file()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.gdrive_utils.GDriveUploader.wait_for_uploads"><code class="docutils literal notranslate"><span class="pre">GDriveUploader.wait_for_uploads()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.utils/#module-stable_pretraining.utils.inspection_utils">stable_pretraining.utils.inspection_utils module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.inspection_utils.broadcast_param_to_list"><code class="docutils literal notranslate"><span class="pre">broadcast_param_to_list()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.inspection_utils.dict_values"><code class="docutils literal notranslate"><span class="pre">dict_values()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.inspection_utils.get_required_fn_parameters"><code class="docutils literal notranslate"><span class="pre">get_required_fn_parameters()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.utils/#module-stable_pretraining.utils.lightning_patch">stable_pretraining.utils.lightning_patch module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.lightning_patch.apply_manual_optimization_patch"><code class="docutils literal notranslate"><span class="pre">apply_manual_optimization_patch()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.lightning_patch.restore_original_validation"><code class="docutils literal notranslate"><span class="pre">restore_original_validation()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.utils/#module-stable_pretraining.utils.log_reader">stable_pretraining.utils.log_reader module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.log_reader.LocalLogReader"><code class="docutils literal notranslate"><span class="pre">LocalLogReader</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.log_reader.LocalLogReader.read"><code class="docutils literal notranslate"><span class="pre">LocalLogReader.read()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.log_reader.LocalLogReader.read_config"><code class="docutils literal notranslate"><span class="pre">LocalLogReader.read_config()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.log_reader.LocalLogReader.read_project"><code class="docutils literal notranslate"><span class="pre">LocalLogReader.read_project()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.log_reader.LogReader"><code class="docutils literal notranslate"><span class="pre">LogReader</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.log_reader.LogReader.read"><code class="docutils literal notranslate"><span class="pre">LogReader.read()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.log_reader.TableFormatter"><code class="docutils literal notranslate"><span class="pre">TableFormatter</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.log_reader.TableFormatter.create_table"><code class="docutils literal notranslate"><span class="pre">TableFormatter.create_table()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.log_reader.TableFormatter.tabulate_runs"><code class="docutils literal notranslate"><span class="pre">TableFormatter.tabulate_runs()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.log_reader.WandbLogReader"><code class="docutils literal notranslate"><span class="pre">WandbLogReader</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.log_reader.WandbLogReader.read"><code class="docutils literal notranslate"><span class="pre">WandbLogReader.read()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.log_reader.WandbLogReader.read_project"><code class="docutils literal notranslate"><span class="pre">WandbLogReader.read_project()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.log_reader.alphanum_key"><code class="docutils literal notranslate"><span class="pre">alphanum_key()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.log_reader.create_results_table"><code class="docutils literal notranslate"><span class="pre">create_results_table()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.log_reader.flatten_config"><code class="docutils literal notranslate"><span class="pre">flatten_config()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.log_reader.natural_sort"><code class="docutils literal notranslate"><span class="pre">natural_sort()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.log_reader.read_local_logs"><code class="docutils literal notranslate"><span class="pre">read_local_logs()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.log_reader.read_local_project"><code class="docutils literal notranslate"><span class="pre">read_local_project()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.log_reader.read_wandb_project"><code class="docutils literal notranslate"><span class="pre">read_wandb_project()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.log_reader.read_wandb_run"><code class="docutils literal notranslate"><span class="pre">read_wandb_run()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.utils/#module-stable_pretraining.utils.mae_loss">stable_pretraining.utils.mae_loss module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.mae_loss.MAELoss"><code class="docutils literal notranslate"><span class="pre">MAELoss</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.mae_loss.MAELoss.LOSS_TYPES"><code class="docutils literal notranslate"><span class="pre">MAELoss.LOSS_TYPES</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.mae_loss.MAELoss.forward"><code class="docutils literal notranslate"><span class="pre">MAELoss.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.mae_loss.MAELoss.patchify"><code class="docutils literal notranslate"><span class="pre">MAELoss.patchify()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.mae_loss.MAELoss.register_custom_loss"><code class="docutils literal notranslate"><span class="pre">MAELoss.register_custom_loss()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.mae_loss.patchify"><code class="docutils literal notranslate"><span class="pre">patchify()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.mae_loss.unpatchify"><code class="docutils literal notranslate"><span class="pre">unpatchify()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.utils/#module-stable_pretraining.utils.nn_modules">stable_pretraining.utils.nn_modules module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.nn_modules.BatchNorm1dNoBias"><code class="docutils literal notranslate"><span class="pre">BatchNorm1dNoBias</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.nn_modules.EMA"><code class="docutils literal notranslate"><span class="pre">EMA</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.nn_modules.EMA.forward"><code class="docutils literal notranslate"><span class="pre">EMA.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.nn_modules.ImageToVideoEncoder"><code class="docutils literal notranslate"><span class="pre">ImageToVideoEncoder</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.nn_modules.ImageToVideoEncoder.forward"><code class="docutils literal notranslate"><span class="pre">ImageToVideoEncoder.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.nn_modules.L2Norm"><code class="docutils literal notranslate"><span class="pre">L2Norm</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.nn_modules.L2Norm.forward"><code class="docutils literal notranslate"><span class="pre">L2Norm.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.nn_modules.Normalize"><code class="docutils literal notranslate"><span class="pre">Normalize</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.nn_modules.Normalize.forward"><code class="docutils literal notranslate"><span class="pre">Normalize.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.nn_modules.OrderedQueue"><code class="docutils literal notranslate"><span class="pre">OrderedQueue</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.nn_modules.OrderedQueue.append"><code class="docutils literal notranslate"><span class="pre">OrderedQueue.append()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.nn_modules.OrderedQueue.get"><code class="docutils literal notranslate"><span class="pre">OrderedQueue.get()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.nn_modules.OrderedQueue.get_unsorted"><code class="docutils literal notranslate"><span class="pre">OrderedQueue.get_unsorted()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.nn_modules.OrderedQueue.load_state_dict"><code class="docutils literal notranslate"><span class="pre">OrderedQueue.load_state_dict()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.nn_modules.UnsortedQueue"><code class="docutils literal notranslate"><span class="pre">UnsortedQueue</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.nn_modules.UnsortedQueue.append"><code class="docutils literal notranslate"><span class="pre">UnsortedQueue.append()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.nn_modules.UnsortedQueue.get"><code class="docutils literal notranslate"><span class="pre">UnsortedQueue.get()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.utils/#module-stable_pretraining.utils.online_topk">stable_pretraining.utils.online_topk module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.online_topk.StreamingTopKEigen"><code class="docutils literal notranslate"><span class="pre">StreamingTopKEigen</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.online_topk.StreamingTopKEigen.cumulative_explained_variance_ratio"><code class="docutils literal notranslate"><span class="pre">StreamingTopKEigen.cumulative_explained_variance_ratio</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.online_topk.StreamingTopKEigen.explained_variance_ratio"><code class="docutils literal notranslate"><span class="pre">StreamingTopKEigen.explained_variance_ratio</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.online_topk.StreamingTopKEigen.forward"><code class="docutils literal notranslate"><span class="pre">StreamingTopKEigen.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.online_topk.StreamingTopKEigen.project"><code class="docutils literal notranslate"><span class="pre">StreamingTopKEigen.project()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.online_topk.StreamingTopKEigen.reconstruct"><code class="docutils literal notranslate"><span class="pre">StreamingTopKEigen.reconstruct()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.utils/#module-stable_pretraining.utils.read_csv_logger">stable_pretraining.utils.read_csv_logger module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.read_csv_logger.CSVLogAutoSummarizer"><code class="docutils literal notranslate"><span class="pre">CSVLogAutoSummarizer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.read_csv_logger.CSVLogAutoSummarizer.METRICS_PATTERNS"><code class="docutils literal notranslate"><span class="pre">CSVLogAutoSummarizer.METRICS_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.read_csv_logger.CSVLogAutoSummarizer.collect"><code class="docutils literal notranslate"><span class="pre">CSVLogAutoSummarizer.collect()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.read_csv_logger.load_best_compressed"><code class="docutils literal notranslate"><span class="pre">load_best_compressed()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.read_csv_logger.save_best_compressed"><code class="docutils literal notranslate"><span class="pre">save_best_compressed()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.utils/#module-stable_pretraining.utils.solver">stable_pretraining.utils.solver module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.solver.ODESolver"><code class="docutils literal notranslate"><span class="pre">ODESolver</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.solver.ODESolver.DPM_2"><code class="docutils literal notranslate"><span class="pre">ODESolver.DPM_2</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.solver.ODESolver.DPM_3"><code class="docutils literal notranslate"><span class="pre">ODESolver.DPM_3</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.solver.ODESolver.EULER"><code class="docutils literal notranslate"><span class="pre">ODESolver.EULER</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.solver.ODESolver.HEUN"><code class="docutils literal notranslate"><span class="pre">ODESolver.HEUN</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.solver.ODESolver.MIDPOINT"><code class="docutils literal notranslate"><span class="pre">ODESolver.MIDPOINT</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.solver.ODESolver.RK4"><code class="docutils literal notranslate"><span class="pre">ODESolver.RK4</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.solver.flow_matching_sample"><code class="docutils literal notranslate"><span class="pre">flow_matching_sample()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.utils/#module-stable_pretraining.utils.stats">stable_pretraining.utils.stats module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.stats.mean_std"><code class="docutils literal notranslate"><span class="pre">mean_std()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.stats.mean_var"><code class="docutils literal notranslate"><span class="pre">mean_var()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.utils/#stable-pretraining-utils-timm-to-hf-hub-module">stable_pretraining.utils.timm_to_hf_hub module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.utils/#module-stable_pretraining.utils.visualization">stable_pretraining.utils.visualization module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.visualization.escape_labels"><code class="docutils literal notranslate"><span class="pre">escape_labels()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.visualization.format_df_to_latex"><code class="docutils literal notranslate"><span class="pre">format_df_to_latex()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.visualization.imshow_with_grid"><code class="docutils literal notranslate"><span class="pre">imshow_with_grid()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.visualization.latex_escape"><code class="docutils literal notranslate"><span class="pre">latex_escape()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.visualization.visualize_images_graph"><code class="docutils literal notranslate"><span class="pre">visualize_images_graph()</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../stable_pretraining.utils/#module-stable_pretraining.utils">Module contents</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.BatchNorm1dNoBias"><code class="docutils literal notranslate"><span class="pre">BatchNorm1dNoBias</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.CSVLogAutoSummarizer"><code class="docutils literal notranslate"><span class="pre">CSVLogAutoSummarizer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.CSVLogAutoSummarizer.METRICS_PATTERNS"><code class="docutils literal notranslate"><span class="pre">CSVLogAutoSummarizer.METRICS_PATTERNS</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.CSVLogAutoSummarizer.collect"><code class="docutils literal notranslate"><span class="pre">CSVLogAutoSummarizer.collect()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.EMA"><code class="docutils literal notranslate"><span class="pre">EMA</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.EMA.forward"><code class="docutils literal notranslate"><span class="pre">EMA.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.FullGatherLayer"><code class="docutils literal notranslate"><span class="pre">FullGatherLayer</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.FullGatherLayer.backward"><code class="docutils literal notranslate"><span class="pre">FullGatherLayer.backward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.FullGatherLayer.forward"><code class="docutils literal notranslate"><span class="pre">FullGatherLayer.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.GDriveUploader"><code class="docutils literal notranslate"><span class="pre">GDriveUploader</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.GDriveUploader.get_folder_id"><code class="docutils literal notranslate"><span class="pre">GDriveUploader.get_folder_id()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.GDriveUploader.get_folder_url"><code class="docutils literal notranslate"><span class="pre">GDriveUploader.get_folder_url()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.GDriveUploader.get_queue_size"><code class="docutils literal notranslate"><span class="pre">GDriveUploader.get_queue_size()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.GDriveUploader.upload_file"><code class="docutils literal notranslate"><span class="pre">GDriveUploader.upload_file()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.GDriveUploader.wait_for_uploads"><code class="docutils literal notranslate"><span class="pre">GDriveUploader.wait_for_uploads()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.ImageToVideoEncoder"><code class="docutils literal notranslate"><span class="pre">ImageToVideoEncoder</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.ImageToVideoEncoder.forward"><code class="docutils literal notranslate"><span class="pre">ImageToVideoEncoder.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.L2Norm"><code class="docutils literal notranslate"><span class="pre">L2Norm</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.L2Norm.forward"><code class="docutils literal notranslate"><span class="pre">L2Norm.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.MAELoss"><code class="docutils literal notranslate"><span class="pre">MAELoss</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.MAELoss.LOSS_TYPES"><code class="docutils literal notranslate"><span class="pre">MAELoss.LOSS_TYPES</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.MAELoss.forward"><code class="docutils literal notranslate"><span class="pre">MAELoss.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.MAELoss.patchify"><code class="docutils literal notranslate"><span class="pre">MAELoss.patchify()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.MAELoss.register_custom_loss"><code class="docutils literal notranslate"><span class="pre">MAELoss.register_custom_loss()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.Normalize"><code class="docutils literal notranslate"><span class="pre">Normalize</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.Normalize.forward"><code class="docutils literal notranslate"><span class="pre">Normalize.forward()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.OrderedQueue"><code class="docutils literal notranslate"><span class="pre">OrderedQueue</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.OrderedQueue.append"><code class="docutils literal notranslate"><span class="pre">OrderedQueue.append()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.OrderedQueue.get"><code class="docutils literal notranslate"><span class="pre">OrderedQueue.get()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.OrderedQueue.get_unsorted"><code class="docutils literal notranslate"><span class="pre">OrderedQueue.get_unsorted()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.OrderedQueue.load_state_dict"><code class="docutils literal notranslate"><span class="pre">OrderedQueue.load_state_dict()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.StreamingTopKEigen"><code class="docutils literal notranslate"><span class="pre">StreamingTopKEigen</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.StreamingTopKEigen.cumulative_explained_variance_ratio"><code class="docutils literal notranslate"><span class="pre">StreamingTopKEigen.cumulative_explained_variance_ratio</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.StreamingTopKEigen.explained_variance_ratio"><code class="docutils literal notranslate"><span class="pre">StreamingTopKEigen.explained_variance_ratio</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.StreamingTopKEigen.forward"><code class="docutils literal notranslate"><span class="pre">StreamingTopKEigen.forward()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.StreamingTopKEigen.project"><code class="docutils literal notranslate"><span class="pre">StreamingTopKEigen.project()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.StreamingTopKEigen.reconstruct"><code class="docutils literal notranslate"><span class="pre">StreamingTopKEigen.reconstruct()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.UnsortedQueue"><code class="docutils literal notranslate"><span class="pre">UnsortedQueue</span></code></a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.UnsortedQueue.append"><code class="docutils literal notranslate"><span class="pre">UnsortedQueue.append()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.UnsortedQueue.get"><code class="docutils literal notranslate"><span class="pre">UnsortedQueue.get()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.adapt_resnet_for_lowres"><code class="docutils literal notranslate"><span class="pre">adapt_resnet_for_lowres()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.all_gather"><code class="docutils literal notranslate"><span class="pre">all_gather()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.all_reduce"><code class="docutils literal notranslate"><span class="pre">all_reduce()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.broadcast_param_to_list"><code class="docutils literal notranslate"><span class="pre">broadcast_param_to_list()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.compute_pairwise_distances"><code class="docutils literal notranslate"><span class="pre">compute_pairwise_distances()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.compute_pairwise_distances_chunked"><code class="docutils literal notranslate"><span class="pre">compute_pairwise_distances_chunked()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.detach_tensors"><code class="docutils literal notranslate"><span class="pre">detach_tensors()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.dict_values"><code class="docutils literal notranslate"><span class="pre">dict_values()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.execute_from_config"><code class="docutils literal notranslate"><span class="pre">execute_from_config()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.find_module"><code class="docutils literal notranslate"><span class="pre">find_module()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.format_df_to_latex"><code class="docutils literal notranslate"><span class="pre">format_df_to_latex()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.generate_dae_samples"><code class="docutils literal notranslate"><span class="pre">generate_dae_samples()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.generate_dm_samples"><code class="docutils literal notranslate"><span class="pre">generate_dm_samples()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.generate_ssl_samples"><code class="docutils literal notranslate"><span class="pre">generate_ssl_samples()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.generate_sup_samples"><code class="docutils literal notranslate"><span class="pre">generate_sup_samples()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.get_data_from_batch_or_outputs"><code class="docutils literal notranslate"><span class="pre">get_data_from_batch_or_outputs()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.get_required_fn_parameters"><code class="docutils literal notranslate"><span class="pre">get_required_fn_parameters()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.is_dist_avail_and_initialized"><code class="docutils literal notranslate"><span class="pre">is_dist_avail_and_initialized()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.load_hparams_from_ckpt"><code class="docutils literal notranslate"><span class="pre">load_hparams_from_ckpt()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.mean_std"><code class="docutils literal notranslate"><span class="pre">mean_std()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.mean_var"><code class="docutils literal notranslate"><span class="pre">mean_var()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.patchify"><code class="docutils literal notranslate"><span class="pre">patchify()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.replace_module"><code class="docutils literal notranslate"><span class="pre">replace_module()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.rgetattr"><code class="docutils literal notranslate"><span class="pre">rgetattr()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.rsetattr"><code class="docutils literal notranslate"><span class="pre">rsetattr()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.unpatchify"><code class="docutils literal notranslate"><span class="pre">unpatchify()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../stable_pretraining.utils/#stable_pretraining.utils.with_hf_retry_ratelimit"><code class="docutils literal notranslate"><span class="pre">with_hf_retry_ratelimit()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</section>
<section id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Link to this heading">#</a></h2>
</section>
<section id="module-stable_pretraining.cli">
<span id="stable-pretraining-cli-module"></span><h2>stable_pretraining.cli module<a class="headerlink" href="#module-stable_pretraining.cli" title="Link to this heading">#</a></h2>
<p>Command-line interface for Stable SSL training.</p>
<dl class="py function">
<dt class="sig sig-object py" id="stable_pretraining.cli.dump_csv_logs">
<span class="sig-prename descclassname"><span class="pre">stable_pretraining.cli.</span></span><span class="sig-name descname"><span class="pre">dump_csv_logs</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">&lt;typer.models.ArgumentInfo</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">&lt;typer.models.ArgumentInfo</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">agg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">&lt;typer.models.ArgumentInfo</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/cli/#dump_csv_logs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.cli.dump_csv_logs" title="Link to this definition">#</a></dt>
<dd><p>Compress CSV logs to the smallest possible format with aggregation.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stable_pretraining.cli.run">
<span class="sig-prename descclassname"><span class="pre">stable_pretraining.cli.</span></span><span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">&lt;typer.models.ArgumentInfo</span> <span class="pre">object&gt;</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overrides</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">&lt;typer.models.ArgumentInfo</span> <span class="pre">object&gt;</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/cli/#run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.cli.run" title="Link to this definition">#</a></dt>
<dd><p>Execute experiment with the specified config.</p>
<p class="rubric">Examples</p>
<p>spt run config.yaml</p>
<p>spt run config.yaml -m</p>
<p>spt run config.yaml trainer.max_epochs=100</p>
</dd></dl>

</section>
<section id="module-stable_pretraining.config">
<span id="stable-pretraining-config-module"></span><h2>stable_pretraining.config module<a class="headerlink" href="#module-stable_pretraining.config" title="Link to this heading">#</a></h2>
<p>Configuration classes specifying default parameters for stable-SSL.</p>
<dl class="py function">
<dt class="sig sig-object py" id="stable_pretraining.config.collapse_nested_dict">
<span class="sig-prename descclassname"><span class="pre">stable_pretraining.config.</span></span><span class="sig-name descname"><span class="pre">collapse_nested_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><span class="pre">object</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">level_separator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'.'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_base_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_flat_cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a></span></span><a class="reference internal" href="../_modules/stable_pretraining/config/#collapse_nested_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.config.collapse_nested_dict" title="Link to this definition">#</a></dt>
<dd><p>Parse a Hydra config and make it readable for wandb (flatten).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cfg</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>, </em><a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><em>object</em></a><em>]</em>)  The original (Hydra) nested dict.</p></li>
<li><p><strong>level_separator</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>)  The string to separate level names. Defaults to ..</p></li>
<li><p><strong>_base_name</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>)  The parent string, used for recursion only, users should ignore.
Defaults to None.</p></li>
<li><p><strong>_flat_cfg</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>, </em><em>optional</em>)  The flattened config, used for recursion only, users should ignore.
Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Flat config.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)">dict</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stable_pretraining.config.instantiate_from_config">
<span class="sig-prename descclassname"><span class="pre">stable_pretraining.config.</span></span><span class="sig-name descname"><span class="pre">instantiate_from_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">DictConfig</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><span class="pre">Any</span></a></span></span><a class="reference internal" href="../_modules/stable_pretraining/config/#instantiate_from_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.config.instantiate_from_config" title="Link to this definition">#</a></dt>
<dd><p>Main entry point for config-based training.</p>
<p>This function handles the complete instantiation of a training setup from config:
- Recursively instantiates all components
- Creates Manager if trainer/module/data are present
- Returns appropriate object based on config structure</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>cfg</strong>  Complete configuration dictionary or DictConfig</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Manager instance if config contains trainer/module/data,
otherwise returns instantiated config dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stable_pretraining.config.recursive_instantiate">
<span class="sig-prename descclassname"><span class="pre">stable_pretraining.config.</span></span><span class="sig-name descname"><span class="pre">recursive_instantiate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">DictConfig</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_objects</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a></span></span><a class="reference internal" href="../_modules/stable_pretraining/config/#recursive_instantiate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.config.recursive_instantiate" title="Link to this definition">#</a></dt>
<dd><p>Recursively instantiate all components in config with dependency resolution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cfg</strong>  Configuration dictionary or DictConfig with _target_ fields</p></li>
<li><p><strong>parent_objects</strong>  Optional dict of already instantiated objects for dependencies</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Dictionary of instantiated components</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-stable_pretraining.forward">
<span id="stable-pretraining-forward-module"></span><h2>stable_pretraining.forward module<a class="headerlink" href="#module-stable_pretraining.forward" title="Link to this heading">#</a></h2>
<p>Forward functions for self-supervised learning methods.</p>
<p>This module provides pre-defined forward functions for various SSL methods
that can be used with the Module class. These functions define the training
logic for each method and can be specified in YAML configs or Python code.</p>
<p class="rubric">Example</p>
<p>Using in a YAML config:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">module</span><span class="p">:</span>
  <span class="n">_target_</span><span class="p">:</span> <span class="n">stable_pretraining</span><span class="o">.</span><span class="n">Module</span>
  <span class="n">forward</span><span class="p">:</span> <span class="n">stable_pretraining</span><span class="o">.</span><span class="n">forward</span><span class="o">.</span><span class="n">simclr_forward</span>
  <span class="n">backbone</span><span class="p">:</span> <span class="o">...</span>
  <span class="n">projector</span><span class="p">:</span> <span class="o">...</span>
</pre></div>
</div>
<p>Using in Python code:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">stable_pretraining</span><span class="w"> </span><span class="kn">import</span> <span class="n">Module</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">stable_pretraining.forward</span><span class="w"> </span><span class="kn">import</span> <span class="n">simclr_forward</span>

<span class="n">module</span> <span class="o">=</span> <span class="n">Module</span><span class="p">(</span><span class="n">forward</span><span class="o">=</span><span class="n">simclr_forward</span><span class="p">,</span> <span class="n">backbone</span><span class="o">=</span><span class="n">backbone</span><span class="p">,</span> <span class="n">projector</span><span class="o">=</span><span class="n">projector</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py function">
<dt class="sig sig-object py" id="stable_pretraining.forward.barlow_twins_forward">
<span class="sig-prename descclassname"><span class="pre">stable_pretraining.forward.</span></span><span class="sig-name descname"><span class="pre">barlow_twins_forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stage</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/forward/#barlow_twins_forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.forward.barlow_twins_forward" title="Link to this definition">#</a></dt>
<dd><p>Forward function for Barlow Twins.</p>
<p>Barlow Twins learns representations by making the cross-correlation matrix
between embeddings of augmented views as close to the identity matrix as
possible, reducing redundancy while maintaining invariance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong>  Module instance (automatically bound) with required attributes:
- backbone: Feature extraction network
- projector: Projection head (typically with BN and high dimension)
- barlow_loss: Barlow Twins loss function</p></li>
<li><p><strong>batch</strong>  Either a list of view dicts (from MultiViewTransform) or
a single dict (for validation/single-view)</p></li>
<li><p><strong>stage</strong>  Training stage (train, val, or test)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>embedding: Feature representations from backbone</p></li>
<li><p>loss: Barlow Twins loss (during training only)</p></li>
<li><p>label: Labels if present (for probes/callbacks)</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary containing</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Introduced in the Barlow Twins paper <span id="id1">[<a class="reference internal" href="../bibliography/#id4" title="Jure Zbontar, Li Jing, Ishan Misra, Yann LeCun, and Stphane Deny. Barlow twins: self-supervised learning via redundancy reduction. In International conference on machine learning, 1231012320. PMLR, 2021.">Zbontar <em>et al.</em>, 2021</a>]</span>.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stable_pretraining.forward.byol_forward">
<span class="sig-prename descclassname"><span class="pre">stable_pretraining.forward.</span></span><span class="sig-name descname"><span class="pre">byol_forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stage</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/forward/#byol_forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.forward.byol_forward" title="Link to this definition">#</a></dt>
<dd><p>Forward function for BYOL (Bootstrap Your Own Latent).</p>
<p>BYOL learns representations without negative pairs by using a momentum-based
target network and predicting target projections from online projections.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong>  Module instance with required attributes:
- backbone: TeacherStudentWrapper for feature extraction
- projector: TeacherStudentWrapper for projection head
- predictor: Online network predictor
- byol_loss: BYOL loss function (optional, uses MSE if not provided)</p></li>
<li><p><strong>batch</strong>  Either a list of view dicts (from MultiViewTransform) or
a single dict (for validation/single-view)</p></li>
<li><p><strong>stage</strong>  Training stage (train, val, or test)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>embedding: Feature representations from teacher backbone (EMA target)</p></li>
<li><p>loss: BYOL loss between predictions and targets (during training)</p></li>
<li><p>label: Labels if present (for probes/callbacks)</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary containing</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Introduced in the BYOL paper <span id="id2">[<a class="reference internal" href="../bibliography/#id3" title="Jean-Bastien Grill, Florian Strub, Florent Altch, Corentin Tallec, Pierre Richemond, Elena Buchatskaya, Carl Doersch, Bernardo Avila Pires, Zhaohan Guo, Mohammad Gheshlaghi Azar, and others. Bootstrap your own latent-a new approach to self-supervised learning. Advances in neural information processing systems, 33:2127121284, 2020.">Grill <em>et al.</em>, 2020</a>]</span>.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stable_pretraining.forward.dino_forward">
<span class="sig-prename descclassname"><span class="pre">stable_pretraining.forward.</span></span><span class="sig-name descname"><span class="pre">dino_forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stage</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/forward/#dino_forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.forward.dino_forward" title="Link to this definition">#</a></dt>
<dd><p>Forward function for DINO (self-DIstillation with NO labels).</p>
<p>DINO learns representations through self-distillation where a student network
is trained to match the output of a teacher network (EMA of student) on
different augmented views. Global views are processed by both networks while
local views are only processed by the student.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong>  Module instance (automatically bound) with required attributes:
- backbone: TeacherStudentWrapper for feature extraction
- projector: TeacherStudentWrapper for projection head
- dino_loss: DINOv1Loss instance (required, pass spt.losses.DINOv1Loss())
- warmup_temperature_teacher (float): Starting teacher temperature
- temperature_teacher (float): Final teacher temperature
- warmup_epochs_temperature_teacher (int): Epochs to warm up temperature</p></li>
<li><p><strong>batch</strong>  Either a list of view dicts (from MultiViewTransform) or
a single dict (for validation/single-view).
For multi-crop: First 2 views should be global crops, rest are local crops</p></li>
<li><p><strong>stage</strong>  Training stage (train, val, or test)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>embedding: Feature representations from teacher backbone</p></li>
<li><p>loss: DINO distillation loss (during training only)</p></li>
<li><p>label: Labels if present (for probes/callbacks)</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary containing</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Introduced in the DINO paper <span id="id3">[<a class="reference internal" href="../bibliography/#id9" title="Mathilde Caron, Hugo Touvron, Ishan Misra, Herv Jgou, Julien Mairal, Piotr Bojanowski, and Armand Joulin. Emerging properties in self-supervised vision transformers. In Proceedings of the IEEE/CVF international conference on computer vision, 96509660. 2021.">Caron <em>et al.</em>, 2021</a>]</span>.
Requires TeacherStudentWrapper for both backbone and projector,
and assumes first 2 views in batch are global views.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stable_pretraining.forward.dinov2_forward">
<span class="sig-prename descclassname"><span class="pre">stable_pretraining.forward.</span></span><span class="sig-name descname"><span class="pre">dinov2_forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stage</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/forward/#dinov2_forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.forward.dinov2_forward" title="Link to this definition">#</a></dt>
<dd><p>Forward function for DINOv2 with iBOT.</p>
<p>DINOv2 combines two self-supervised losses:
- DINO: CLS token distillation between global views
- iBOT: Masked patch prediction</p>
<p>Both losses use Sinkhorn-Knopp normalization for optimal transport.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong>  Module instance (automatically bound) with required attributes:
- backbone: TeacherStudentWrapper for feature extraction (ViT)
- projector: TeacherStudentWrapper for CLS token projection head
- patch_projector: TeacherStudentWrapper for patch projection head
- dinov2_loss: DINOv2Loss instance combining DINO + iBOT
- warmup_temperature_teacher (float): Starting teacher temperature
- temperature_teacher (float): Final teacher temperature
- warmup_epochs_temperature_teacher (int): Epochs to warm up temperature
- mask_ratio (float): Ratio of patches to mask for iBOT (default: 0.3)</p></li>
<li><p><strong>batch</strong>  Either a list of view dicts (from MultiViewTransform) or
a single dict (for validation/single-view).
For multi-crop: First 2 views should be global crops, rest are local crops</p></li>
<li><p><strong>stage</strong>  Training stage (train, val, or test)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>embedding: Feature representations from teacher backbone</p></li>
<li><p>loss: Combined DINOv2 loss (DINO + iBOT)</p></li>
<li><p>label: Labels if present (for probes/callbacks)</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary containing</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Introduced in the DINOv2 paper.
Requires TeacherStudentWrapper for backbone, projector, and patch_projector.
Assumes first 2 views in batch are global views.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stable_pretraining.forward.nnclr_forward">
<span class="sig-prename descclassname"><span class="pre">stable_pretraining.forward.</span></span><span class="sig-name descname"><span class="pre">nnclr_forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stage</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/forward/#nnclr_forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.forward.nnclr_forward" title="Link to this definition">#</a></dt>
<dd><p>Forward function for NNCLR (Nearest-Neighbor Contrastive Learning).</p>
<p>NNCLR learns representations by using the nearest neighbor of an augmented
view from a support set of past embeddings as a positive pair. This encourages
the model to learn representations that are similar for semantically similar
instances, not just for different augmentations of the same instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong>  Module instance (automatically bound) with required attributes:
- backbone: Feature extraction network
- projector: Projection head for embedding transformation
- predictor: Prediction head used for the online view
- nnclr_loss: NTXent contrastive loss function</p></li>
<li><p><strong>batch</strong>  Either a list of view dicts (from MultiViewTransform) or
a single dict (for validation/single-view)</p></li>
<li><p><strong>stage</strong>  Training stage (train, val, or test)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>embedding: Feature representations from backbone</p></li>
<li><p>loss: NTXent contrastive loss (during training only)</p></li>
<li><p>nnclr_support_set: Projections to be added to the support set queue</p></li>
<li><p>label: Labels if present (for probes/callbacks)</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary containing</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Introduced in the NNCLR paper <span id="id4">[<a class="reference internal" href="../bibliography/#id12" title="Debidatta Dwibedi, Yusuf Aytar, Jonathan Tompson, Pierre Sermanet, and Andrew Zisserman. With a little help from my friends: nearest-neighbor contrastive learning of visual representations. In Proceedings of the IEEE/CVF international conference on computer vision, 95889597. 2021.">Dwibedi <em>et al.</em>, 2021</a>]</span>.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stable_pretraining.forward.simclr_forward">
<span class="sig-prename descclassname"><span class="pre">stable_pretraining.forward.</span></span><span class="sig-name descname"><span class="pre">simclr_forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stage</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/forward/#simclr_forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.forward.simclr_forward" title="Link to this definition">#</a></dt>
<dd><p>Forward function for SimCLR (Simple Contrastive Learning of Representations).</p>
<p>SimCLR learns representations by maximizing agreement between differently
augmented views of the same image via a contrastive loss in the latent space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong>  Module instance (automatically bound) with required attributes:
- backbone: Feature extraction network
- projector: Projection head mapping features to latent space
- simclr_loss: NT-Xent contrastive loss function</p></li>
<li><p><strong>batch</strong>  Either a list of view dicts (from MultiViewTransform) or
a single dict (for validation/single-view)</p></li>
<li><p><strong>stage</strong>  Training stage (train, val, or test)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>embedding: Feature representations from backbone</p></li>
<li><p>loss: NT-Xent contrastive loss (during training only)</p></li>
<li><p>label: Labels if present (for probes/callbacks)</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary containing</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Introduced in the SimCLR paper <span id="id5">[<a class="reference internal" href="../bibliography/#id2" title="Ting Chen, Simon Kornblith, Mohammad Norouzi, and Geoffrey Hinton. A simple framework for contrastive learning of visual representations. In International conference on machine learning, 15971607. PMLR, 2020.">Chen <em>et al.</em>, 2020</a>]</span>.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stable_pretraining.forward.supervised_forward">
<span class="sig-prename descclassname"><span class="pre">stable_pretraining.forward.</span></span><span class="sig-name descname"><span class="pre">supervised_forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stage</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/forward/#supervised_forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.forward.supervised_forward" title="Link to this definition">#</a></dt>
<dd><p>Forward function for standard supervised training.</p>
<p>This function implements traditional supervised learning with labels,
useful for baseline comparisons and fine-tuning pre-trained models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong>  Module instance (automatically bound) with required attributes:
- backbone: Feature extraction network
- classifier: Classification head (e.g., Linear layer)
- supervised_loss: Loss function for supervised learning</p></li>
<li><p><strong>batch</strong>  Input batch dictionary containing:
- image: Tensor of images [N, C, H, W]
- label: Ground truth labels [N] (optional, for loss computation)</p></li>
<li><p><strong>stage</strong>  Training stage (train, val, or test)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>embedding: Feature representations from backbone</p></li>
<li><p>logits: Classification predictions</p></li>
<li><p>loss: Supervised loss (if labels provided)</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary containing</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Unlike SSL methods, this function uses actual labels for training
and is primarily used for evaluation or supervised baselines.</p>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stable_pretraining.forward.swav_forward">
<span class="sig-prename descclassname"><span class="pre">stable_pretraining.forward.</span></span><span class="sig-name descname"><span class="pre">swav_forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stage</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/forward/#swav_forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.forward.swav_forward" title="Link to this definition">#</a></dt>
<dd><p>Forward function for SwAV (Swapping Assignments between Views).</p>
<p>SwAV learns representations by predicting the cluster assignment (code) of one
view from the representation of another view. For small-batch training, this function
manages a feature queue to stabilize the training process.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stable_pretraining.forward.vicreg_forward">
<span class="sig-prename descclassname"><span class="pre">stable_pretraining.forward.</span></span><span class="sig-name descname"><span class="pre">vicreg_forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stage</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/forward/#vicreg_forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.forward.vicreg_forward" title="Link to this definition">#</a></dt>
<dd><p>Forward function for VICReg (Variance-Invariance-Covariance Regularization).</p>
<p>VICReg learns representations using three criteria: variance (maintaining
information), invariance (to augmentations), and covariance (decorrelating
features).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>self</strong>  Module instance (automatically bound) with required attributes:
- backbone: Feature extraction network
- projector: Projection head for embedding transformation
- vicreg_loss: VICReg loss with variance, invariance, covariance terms</p></li>
<li><p><strong>batch</strong>  Either a list of view dicts (from MultiViewTransform) or
a single dict (for validation/single-view)</p></li>
<li><p><strong>stage</strong>  Training stage (train, val, or test)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p>embedding: Feature representations from backbone</p></li>
<li><p>loss: Combined VICReg loss (during training only)</p></li>
<li><p>label: Labels if present (for probes/callbacks)</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Dictionary containing</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Introduced in the VICReg paper <span id="id6">[]</span>.</p>
</div>
</dd></dl>

</section>
<section id="module-stable_pretraining.manager">
<span id="stable-pretraining-manager-module"></span><h2>stable_pretraining.manager module<a class="headerlink" href="#module-stable_pretraining.manager" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="stable_pretraining.manager.Manager">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">stable_pretraining.manager.</span></span><span class="sig-name descname"><span class="pre">Manager</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/manager/#Manager"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.manager.Manager" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Checkpointable</span></code></p>
<p>Manages training with logging, scheduling, and checkpointing support.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trainer</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>, </em><em>DictConfig</em><em>, </em><em>pl.Trainer</em><em>]</em>)  PyTorch Lightning trainer configuration or instance.</p></li>
<li><p><strong>module</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>, </em><em>DictConfig</em><em>, </em><em>pl.LightningModule</em><em>]</em>)  Lightning module configuration or instance.</p></li>
<li><p><strong>data</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>, </em><em>DictConfig</em><em>, </em><em>pl.LightningDataModule</em><em>]</em>)  Data module configuration or instance.</p></li>
<li><p><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>, </em><em>optional</em>)  Random seed for reproducibility. Defaults to None.</p></li>
<li><p><strong>ckpt_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>)  Path to checkpoint for resuming training. Defaults to last.</p></li>
<li><p><strong>compile</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>)  Should we compile the given module. Defaults to False.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.manager.Manager.init_and_sync_wandb">
<span class="sig-name descname"><span class="pre">init_and_sync_wandb</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/manager/#Manager.init_and_sync_wandb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.manager.Manager.init_and_sync_wandb" title="Link to this definition">#</a></dt>
<dd><p>Handles some utilities for WandB.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stable_pretraining.manager.Manager.instantiated_data">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">instantiated_data</span></span><a class="headerlink" href="#stable_pretraining.manager.Manager.instantiated_data" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stable_pretraining.manager.Manager.instantiated_module">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">instantiated_module</span></span><a class="headerlink" href="#stable_pretraining.manager.Manager.instantiated_module" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.manager.Manager.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/manager/#Manager.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.manager.Manager.predict" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.manager.Manager.save_checkpoint">
<span class="sig-name descname"><span class="pre">save_checkpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upload_wandb</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/manager/#Manager.save_checkpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.manager.Manager.save_checkpoint" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.manager.Manager.test">
<span class="sig-name descname"><span class="pre">test</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/manager/#Manager.test"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.manager.Manager.test" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.manager.Manager.validate">
<span class="sig-name descname"><span class="pre">validate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/manager/#Manager.validate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.manager.Manager.validate" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stable_pretraining.manager.print_logger_info">
<span class="sig-prename descclassname"><span class="pre">stable_pretraining.manager.</span></span><span class="sig-name descname"><span class="pre">print_logger_info</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">logger</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/manager/#print_logger_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.manager.print_logger_info" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stable_pretraining.manager.print_signal_info">
<span class="sig-prename descclassname"><span class="pre">stable_pretraining.manager.</span></span><span class="sig-name descname"><span class="pre">print_signal_info</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/manager/#print_signal_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.manager.print_signal_info" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</section>
<section id="module-stable_pretraining.module">
<span id="stable-pretraining-module-module"></span><h2>stable_pretraining.module module<a class="headerlink" href="#module-stable_pretraining.module" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="stable_pretraining.module.Module">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">stable_pretraining.module.</span></span><span class="sig-name descname"><span class="pre">Module</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forward</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">callable</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hparams</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/module/#Module"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.module.Module" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">LightningModule</span></code></p>
<p>PyTorch Lightning module using manual optimization with multi-optimizer support.</p>
<p>Core usage
- Provide a custom <cite>forward(self, batch, stage)</cite> via the <cite>forward</cite> argument at init.
- During training, <cite>forward</cite> must return a dict with <cite>state[loss]</cite> (a single joint loss).</p>
<blockquote>
<div><p>When multiple optimizers are configured, this joint loss is used for all optimizers.</p>
</div></blockquote>
<p>Optimizer configuration (<cite>self.optim</cite>)
- Single optimizer:</p>
<blockquote>
<div><p>{optimizer: str|dict|partial|Class, scheduler: &lt;see below&gt;, interval: step|epoch, frequency: int}
- Optimizer accepted forms:</p>
<blockquote>
<div><ul class="simple">
<li><p>string name (e.g., AdamW, SGD) from torch.optim</p></li>
<li><p>dict: {type: AdamW, lr: 1e-3, }</p></li>
<li><p>functools.partial: partial(torch.optim.AdamW, lr=1e-3)</p></li>
<li><p>optimizer class: torch.optim.AdamW</p></li>
</ul>
</div></blockquote>
</div></blockquote>
<ul>
<li><p>Multiple optimizers:
{</p>
<blockquote>
<div><dl class="simple">
<dt>name: {</dt><dd><p>modules: regex,                # assign params by module-name pattern (children inherit)
optimizer: str|dict|partial|Class, # optimizer factory (same accepted forms as above)
scheduler: str|dict|partial|Class, # flexible scheduler config (see below)
interval: step|epoch,       # scheduler interval
frequency: int,                   # optimizer step frequency
monitor: str                      # (optional) for ReduceLROnPlateau; alternatively set inside scheduler dict</p>
</dd>
</dl>
<p>}, </p>
</div></blockquote>
<p>}</p>
</li>
</ul>
<p>Parameter assignment (multi-optimizer)
- Modules are matched by regex on their qualified name. Children inherit the parents assignment</p>
<blockquote>
<div><p>unless they match a more specific pattern. Only direct parameters of each module are collected
to avoid duplication.</p>
</div></blockquote>
<p>Schedulers (flexible)
- Accepted forms: string name (e.g., CosineAnnealingLR, StepLR), dict with {type: , },</p>
<blockquote>
<div><p>functools.partial, or a scheduler class. Smart defaults are applied when params are omitted for
common schedulers (CosineAnnealingLR, OneCycleLR, StepLR, ExponentialLR, ReduceLROnPlateau,
LinearLR, ConstantLR). For ReduceLROnPlateau, a <cite>monitor</cite> key is added (default: val_loss).
You may specify <cite>monitor</cite> either alongside the optimizer config (top level) or inside the
scheduler dict itself.</p>
</div></blockquote>
<ul class="simple">
<li><p>The resulting Lightning scheduler dict includes <cite>interval</cite> and <cite>frequency</cite> (or <cite>scheduler_frequency</cite>).</p></li>
</ul>
<p>Training loop behavior
- Manual optimization (<cite>automatic_optimization = False</cite>).
- Gradient accumulation: scales loss by 1/N where N = Trainer.accumulate_grad_batches and steps on the boundary.
- Per-optimizer step frequency: each optimizer steps only when its frequency boundary is met (in addition to accumulation boundary).
- Gradient clipping: uses Trainers <cite>gradient_clip_val</cite> and <cite>gradient_clip_algorithm</cite> before each step.
- Returns the <cite>state</cite> dict from <cite>forward</cite> unchanged for logging/inspection.</p>
<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.module.Module.after_manual_backward">
<span class="sig-name descname"><span class="pre">after_manual_backward</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/module/#Module.after_manual_backward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.module.Module.after_manual_backward" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.module.Module.configure_optimizers">
<span class="sig-name descname"><span class="pre">configure_optimizers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/module/#Module.configure_optimizers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.module.Module.configure_optimizers" title="Link to this definition">#</a></dt>
<dd><p>Configure optimizers and schedulers for manual optimization.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optimizer configuration with optional learning rate scheduler.
For single optimizer: Returns a dict with optimizer and lr_scheduler.
For multiple optimizers: Returns a tuple of (optimizers, schedulers).</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)">dict</a> or <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)">tuple</a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Multi-optimizer configuration with module pattern matching and schedulers:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Simple single optimizer with scheduler</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">optim</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="s2">&quot;optimizer&quot;</span><span class="p">:</span> <span class="n">partial</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">AdamW</span><span class="p">,</span> <span class="n">lr</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">),</span>
<span class="gp">... </span>    <span class="s2">&quot;scheduler&quot;</span><span class="p">:</span> <span class="s2">&quot;CosineAnnealingLR&quot;</span><span class="p">,</span>  <span class="c1"># Uses smart defaults</span>
<span class="gp">... </span>    <span class="s2">&quot;interval&quot;</span><span class="p">:</span> <span class="s2">&quot;step&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s2">&quot;frequency&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span><span class="p">}</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Multi-optimizer with custom scheduler configs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">optim</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="s2">&quot;encoder_opt&quot;</span><span class="p">:</span> <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;modules&quot;</span><span class="p">:</span> <span class="s2">&quot;encoder&quot;</span><span class="p">,</span>  <span class="c1"># Matches &#39;encoder&#39; and all children</span>
<span class="gp">... </span>        <span class="s2">&quot;optimizer&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;AdamW&quot;</span><span class="p">,</span> <span class="s2">&quot;lr&quot;</span><span class="p">:</span> <span class="mf">1e-3</span><span class="p">},</span>
<span class="gp">... </span>        <span class="s2">&quot;scheduler&quot;</span><span class="p">:</span> <span class="p">{</span>
<span class="gp">... </span>            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;OneCycleLR&quot;</span><span class="p">,</span>
<span class="gp">... </span>            <span class="s2">&quot;max_lr&quot;</span><span class="p">:</span> <span class="mf">1e-3</span><span class="p">,</span>
<span class="gp">... </span>            <span class="s2">&quot;total_steps&quot;</span><span class="p">:</span> <span class="mi">10000</span><span class="p">,</span>
<span class="gp">... </span>        <span class="p">},</span>
<span class="gp">... </span>        <span class="s2">&quot;interval&quot;</span><span class="p">:</span> <span class="s2">&quot;step&quot;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;frequency&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span>    <span class="p">},</span>
<span class="gp">... </span>    <span class="s2">&quot;head_opt&quot;</span><span class="p">:</span> <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;modules&quot;</span><span class="p">:</span> <span class="s2">&quot;.*head$&quot;</span><span class="p">,</span>  <span class="c1"># Matches modules ending with &#39;head&#39;</span>
<span class="gp">... </span>        <span class="s2">&quot;optimizer&quot;</span><span class="p">:</span> <span class="s2">&quot;SGD&quot;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;scheduler&quot;</span><span class="p">:</span> <span class="p">{</span>
<span class="gp">... </span>            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;ReduceLROnPlateau&quot;</span><span class="p">,</span>
<span class="gp">... </span>            <span class="s2">&quot;mode&quot;</span><span class="p">:</span> <span class="s2">&quot;max&quot;</span><span class="p">,</span>
<span class="gp">... </span>            <span class="s2">&quot;patience&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
<span class="gp">... </span>            <span class="s2">&quot;factor&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
<span class="gp">... </span>        <span class="p">},</span>
<span class="gp">... </span>        <span class="s2">&quot;monitor&quot;</span><span class="p">:</span> <span class="s2">&quot;val_accuracy&quot;</span><span class="p">,</span>  <span class="c1"># Required for ReduceLROnPlateau</span>
<span class="gp">... </span>        <span class="s2">&quot;interval&quot;</span><span class="p">:</span> <span class="s2">&quot;epoch&quot;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;frequency&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>    <span class="p">},</span>
<span class="gp">... </span><span class="p">}</span>
</pre></div>
</div>
<p>With model structure:
- encoder                 -&gt; encoder_opt (matches encoder)
- encoder.layer1          -&gt; encoder_opt (inherits from parent)
- encoder.layer1.conv     -&gt; encoder_opt (inherits from encoder.layer1)
- classifier_head         -&gt; head_opt (matches .*head$)
- classifier_head.linear  -&gt; head_opt (inherits from parent)
- decoder                 -&gt; None (no match, no parameters collected)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.module.Module.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/module/#Module.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.module.Module.forward" title="Link to this definition">#</a></dt>
<dd><p>Same as <a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module.forward" title="(in PyTorch v2.10)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">torch.nn.Module.forward()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong>  Whatever you decide to pass into the forward method.</p></li>
<li><p><strong>**kwargs</strong>  Keyword arguments are also possible.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Your models output</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.module.Module.named_parameters">
<span class="sig-name descname"><span class="pre">named_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">with_callbacks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recurse</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/module/#Module.named_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.module.Module.named_parameters" title="Link to this definition">#</a></dt>
<dd><p>Override to globally exclude callback-related parameters.</p>
<p>Excludes parameters that belong to <code class="docutils literal notranslate"><span class="pre">self.callbacks_modules</span></code> or <code class="docutils literal notranslate"><span class="pre">self.callbacks_metrics</span></code>.
This prevents accidental optimization of callback/metric internals, even if external code
calls <code class="docutils literal notranslate"><span class="pre">self.parameters()</span></code> or <code class="docutils literal notranslate"><span class="pre">self.named_parameters()</span></code> directly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>with_callbacks</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>)  If False, excludes callback parameters. Defaults to True.</p></li>
<li><p><strong>prefix</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>)  Prefix to prepend to parameter names. Defaults to .</p></li>
<li><p><strong>recurse</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>)  If True, yields parameters of this module and all submodules.
If False, yields only direct parameters. Defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Yields<span class="colon">:</span></dt>
<dd class="field-even"><p><em>tuple[str, torch.nn.Parameter]</em>  Name and parameter pairs.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.module.Module.on_train_start">
<span class="sig-name descname"><span class="pre">on_train_start</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/module/#Module.on_train_start"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.module.Module.on_train_start" title="Link to this definition">#</a></dt>
<dd><p>Called at the beginning of training after sanity check.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.module.Module.parameters">
<span class="sig-name descname"><span class="pre">parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">with_callbacks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recurse</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/module/#Module.parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.module.Module.parameters" title="Link to this definition">#</a></dt>
<dd><p>Override to route through the filtered <code class="docutils literal notranslate"><span class="pre">named_parameters</span></code> implementation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>with_callbacks</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>)  If False, excludes callback parameters. Defaults to True.</p></li>
<li><p><strong>recurse</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>)  If True, yields parameters of this module and all submodules.
If False, yields only direct parameters. Defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Yields<span class="colon">:</span></dt>
<dd class="field-even"><p><em>torch.nn.Parameter</em>  Module parameters.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.module.Module.predict_step">
<span class="sig-name descname"><span class="pre">predict_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/module/#Module.predict_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.module.Module.predict_step" title="Link to this definition">#</a></dt>
<dd><p>Step function called during <code class="xref py py-meth docutils literal notranslate"><span class="pre">predict()</span></code>. By default, it calls
<code class="xref py py-meth docutils literal notranslate"><span class="pre">forward()</span></code>. Override to add any processing logic.</p>
<p>The <code class="xref py py-meth docutils literal notranslate"><span class="pre">predict_step()</span></code> is used
to scale inference on multi-devices.</p>
<p>To prevent an OOM error, it is possible to use <code class="xref py py-class docutils literal notranslate"><span class="pre">BasePredictionWriter</span></code>
callback to write the predictions to disk or database after each batch or on epoch end.</p>
<p>The <code class="xref py py-class docutils literal notranslate"><span class="pre">BasePredictionWriter</span></code> should be used while using a spawn
based accelerator. This happens for <code class="docutils literal notranslate"><span class="pre">Trainer(strategy=&quot;ddp_spawn&quot;)</span></code>
or training on 8 TPU cores with <code class="docutils literal notranslate"><span class="pre">Trainer(accelerator=&quot;tpu&quot;,</span> <span class="pre">devices=8)</span></code> as predictions wont be returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch</strong>  The output of your data iterable, normally a <a class="reference external" href="https://docs.pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataLoader</span></code></a>.</p></li>
<li><p><strong>batch_idx</strong>  The index of this batch.</p></li>
<li><p><strong>dataloader_idx</strong>  The index of the dataloader that produced this batch.
(only if multiple dataloaders used)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Predicted output (optional).</p>
</dd>
</dl>
<p>Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">MyModel</span><span class="p">(</span><span class="n">LightningModule</span><span class="p">):</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">predict_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">,</span> <span class="n">batch_idx</span><span class="p">,</span> <span class="n">dataloader_idx</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>

<span class="n">dm</span> <span class="o">=</span> <span class="o">...</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">MyModel</span><span class="p">()</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">accelerator</span><span class="o">=</span><span class="s2">&quot;gpu&quot;</span><span class="p">,</span> <span class="n">devices</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">dm</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.module.Module.rescale_loss_for_grad_acc">
<span class="sig-name descname"><span class="pre">rescale_loss_for_grad_acc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loss</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/module/#Module.rescale_loss_for_grad_acc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.module.Module.rescale_loss_for_grad_acc" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.module.Module.test_step">
<span class="sig-name descname"><span class="pre">test_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/module/#Module.test_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.module.Module.test_step" title="Link to this definition">#</a></dt>
<dd><p>Operates on a single batch of data from the test set. In this step youd normally generate examples or
calculate anything of interest such as accuracy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch</strong>  The output of your data iterable, normally a <a class="reference external" href="https://docs.pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataLoader</span></code></a>.</p></li>
<li><p><strong>batch_idx</strong>  The index of this batch.</p></li>
<li><p><strong>dataloader_idx</strong>  The index of the dataloader that produced this batch.
(only if multiple dataloaders used)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a> - The loss tensor</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dict</span></code> - A dictionary. Can include any keys, but must include the key <code class="docutils literal notranslate"><span class="pre">'loss'</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code> - Skip to the next batch.</p></li>
</ul>
</p>
</dd>
</dl>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># if you have one test dataloader:</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">,</span> <span class="n">batch_idx</span><span class="p">):</span> <span class="o">...</span>


<span class="c1"># if you have multiple test dataloaders:</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">,</span> <span class="n">batch_idx</span><span class="p">,</span> <span class="n">dataloader_idx</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span> <span class="o">...</span>
</pre></div>
</div>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># CASE 1: A single test dataset</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">,</span> <span class="n">batch_idx</span><span class="p">):</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">batch</span>

    <span class="c1"># implement your own</span>
    <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loss</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

    <span class="c1"># log 6 example images</span>
    <span class="c1"># or generated text... or whatever</span>
    <span class="n">sample_imgs</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:</span><span class="mi">6</span><span class="p">]</span>
    <span class="n">grid</span> <span class="o">=</span> <span class="n">torchvision</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">make_grid</span><span class="p">(</span><span class="n">sample_imgs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">add_image</span><span class="p">(</span><span class="s1">&#39;example_images&#39;</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="c1"># calculate acc</span>
    <span class="n">labels_hat</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">test_acc</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">y</span> <span class="o">==</span> <span class="n">labels_hat</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="o">/</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.0</span><span class="p">)</span>

    <span class="c1"># log the outputs!</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log_dict</span><span class="p">({</span><span class="s1">&#39;test_loss&#39;</span><span class="p">:</span> <span class="n">loss</span><span class="p">,</span> <span class="s1">&#39;test_acc&#39;</span><span class="p">:</span> <span class="n">test_acc</span><span class="p">})</span>
</pre></div>
</div>
<p>If you pass in multiple test dataloaders, <a class="reference internal" href="#stable_pretraining.module.Module.test_step" title="stable_pretraining.module.Module.test_step"><code class="xref py py-meth docutils literal notranslate"><span class="pre">test_step()</span></code></a> will have an additional argument. We recommend
setting the default value of 0 so that you can quickly switch between single and multiple dataloaders.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># CASE 2: multiple test dataloaders</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">,</span> <span class="n">batch_idx</span><span class="p">,</span> <span class="n">dataloader_idx</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="c1"># dataloader_idx tells you which dataset this is.</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">batch</span>

    <span class="c1"># implement your own</span>
    <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">dataloader_idx</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loss0</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loss1</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

    <span class="c1"># calculate acc</span>
    <span class="n">labels_hat</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">acc</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">y</span> <span class="o">==</span> <span class="n">labels_hat</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="o">/</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.0</span><span class="p">)</span>

    <span class="c1"># log the outputs separately for each dataloader</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log_dict</span><span class="p">({</span><span class="sa">f</span><span class="s2">&quot;test_loss_</span><span class="si">{</span><span class="n">dataloader_idx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="n">loss</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;test_acc_</span><span class="si">{</span><span class="n">dataloader_idx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="n">acc</span><span class="p">})</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you dont need to test you dont need to implement this method.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When the <a class="reference internal" href="#stable_pretraining.module.Module.test_step" title="stable_pretraining.module.Module.test_step"><code class="xref py py-meth docutils literal notranslate"><span class="pre">test_step()</span></code></a> is called, the model has been put in eval mode and
PyTorch gradients have been disabled. At the end of the test epoch, the model goes back
to training mode and gradients are enabled.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.module.Module.training_step">
<span class="sig-name descname"><span class="pre">training_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/module/#Module.training_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.module.Module.training_step" title="Link to this definition">#</a></dt>
<dd><p>Manual optimization training step with support for multiple optimizers.</p>
<p>Expected output from forward during training (stage=fit):
- state[loss]: torch.Tensor - Single joint loss for all optimizers</p>
<p>When multiple optimizers are configured, the same loss is used for all of them.
Each optimizer updates its assigned parameters based on gradients from this joint loss.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.module.Module.validation_step">
<span class="sig-name descname"><span class="pre">validation_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/module/#Module.validation_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.module.Module.validation_step" title="Link to this definition">#</a></dt>
<dd><p>Operates on a single batch of data from the validation set. In this step youd might generate examples or
calculate anything of interest like accuracy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch</strong>  The output of your data iterable, normally a <a class="reference external" href="https://docs.pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataLoader</span></code></a>.</p></li>
<li><p><strong>batch_idx</strong>  The index of this batch.</p></li>
<li><p><strong>dataloader_idx</strong>  The index of the dataloader that produced this batch.
(only if multiple dataloaders used)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a> - The loss tensor</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dict</span></code> - A dictionary. Can include any keys, but must include the key <code class="docutils literal notranslate"><span class="pre">'loss'</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code> - Skip to the next batch.</p></li>
</ul>
</p>
</dd>
</dl>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># if you have one val dataloader:</span>
<span class="k">def</span><span class="w"> </span><span class="nf">validation_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">,</span> <span class="n">batch_idx</span><span class="p">):</span> <span class="o">...</span>


<span class="c1"># if you have multiple val dataloaders:</span>
<span class="k">def</span><span class="w"> </span><span class="nf">validation_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">,</span> <span class="n">batch_idx</span><span class="p">,</span> <span class="n">dataloader_idx</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span> <span class="o">...</span>
</pre></div>
</div>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># CASE 1: A single validation dataset</span>
<span class="k">def</span><span class="w"> </span><span class="nf">validation_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">,</span> <span class="n">batch_idx</span><span class="p">):</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">batch</span>

    <span class="c1"># implement your own</span>
    <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loss</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

    <span class="c1"># log 6 example images</span>
    <span class="c1"># or generated text... or whatever</span>
    <span class="n">sample_imgs</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:</span><span class="mi">6</span><span class="p">]</span>
    <span class="n">grid</span> <span class="o">=</span> <span class="n">torchvision</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">make_grid</span><span class="p">(</span><span class="n">sample_imgs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">add_image</span><span class="p">(</span><span class="s1">&#39;example_images&#39;</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="c1"># calculate acc</span>
    <span class="n">labels_hat</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">val_acc</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">y</span> <span class="o">==</span> <span class="n">labels_hat</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="o">/</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.0</span><span class="p">)</span>

    <span class="c1"># log the outputs!</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log_dict</span><span class="p">({</span><span class="s1">&#39;val_loss&#39;</span><span class="p">:</span> <span class="n">loss</span><span class="p">,</span> <span class="s1">&#39;val_acc&#39;</span><span class="p">:</span> <span class="n">val_acc</span><span class="p">})</span>
</pre></div>
</div>
<p>If you pass in multiple val dataloaders, <a class="reference internal" href="#stable_pretraining.module.Module.validation_step" title="stable_pretraining.module.Module.validation_step"><code class="xref py py-meth docutils literal notranslate"><span class="pre">validation_step()</span></code></a> will have an additional argument. We recommend
setting the default value of 0 so that you can quickly switch between single and multiple dataloaders.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># CASE 2: multiple validation dataloaders</span>
<span class="k">def</span><span class="w"> </span><span class="nf">validation_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">,</span> <span class="n">batch_idx</span><span class="p">,</span> <span class="n">dataloader_idx</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="c1"># dataloader_idx tells you which dataset this is.</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">batch</span>

    <span class="c1"># implement your own</span>
    <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">dataloader_idx</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loss0</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loss1</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

    <span class="c1"># calculate acc</span>
    <span class="n">labels_hat</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">acc</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">y</span> <span class="o">==</span> <span class="n">labels_hat</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="o">/</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.0</span><span class="p">)</span>

    <span class="c1"># log the outputs separately for each dataloader</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log_dict</span><span class="p">({</span><span class="sa">f</span><span class="s2">&quot;val_loss_</span><span class="si">{</span><span class="n">dataloader_idx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="n">loss</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;val_acc_</span><span class="si">{</span><span class="n">dataloader_idx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="n">acc</span><span class="p">})</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you dont need to validate you dont need to implement this method.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When the <a class="reference internal" href="#stable_pretraining.module.Module.validation_step" title="stable_pretraining.module.Module.validation_step"><code class="xref py py-meth docutils literal notranslate"><span class="pre">validation_step()</span></code></a> is called, the model has been put in eval mode
and PyTorch gradients have been disabled. At the end of validation,
the model goes back to training mode and gradients are enabled.</p>
</div>
</dd></dl>

</dd></dl>

</section>
<section id="module-stable_pretraining.run">
<span id="stable-pretraining-run-module"></span><h2>stable_pretraining.run module<a class="headerlink" href="#module-stable_pretraining.run" title="Link to this heading">#</a></h2>
<p>Universal experiment runner for stable-pretraining using Hydra configs.</p>
<p>This script provides a unified entry point for all experiments (training, evaluation, etc.)
via configuration files. It supports both single-file configs and modular Hydra composition.</p>
<dl>
<dt>Usage:</dt><dd><p># Run with a config file
python -m stable_pretraining.run config-path ../examples config-name simclr_cifar10</p>
<p># Run with config and override parameters
python -m stable_pretraining.run config-path ../examples config-name simclr_cifar10         module.optimizer.lr=0.01         trainer.max_epochs=200</p>
<p># Run hyperparameter sweep
python -m stable_pretraining.run multirun         config-path ../examples config-name simclr_cifar10         module.optimizer.lr=0.001,0.01,0.1</p>
</dd>
</dl>
<dl class="py function">
<dt class="sig sig-object py" id="stable_pretraining.run.main">
<span class="sig-prename descclassname"><span class="pre">stable_pretraining.run.</span></span><span class="sig-name descname"><span class="pre">main</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DictConfig</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/stable_pretraining/run/#main"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.run.main" title="Link to this definition">#</a></dt>
<dd><p>Main execution function that instantiates components from config and runs the experiment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>cfg</strong>  Hydra configuration dictionary containing all experiment parameters</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stable_pretraining.run.print_config">
<span class="sig-prename descclassname"><span class="pre">stable_pretraining.run.</span></span><span class="sig-name descname"><span class="pre">print_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cfg</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DictConfig</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/stable_pretraining/run/#print_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.run.print_config" title="Link to this definition">#</a></dt>
<dd><p>Print configuration only on rank 0.</p>
</dd></dl>

</section>
<section id="module-stable_pretraining.static">
<span id="stable-pretraining-static-module"></span><h2>stable_pretraining.static module<a class="headerlink" href="#module-stable_pretraining.static" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="stable_pretraining.static.HF_EMBEDDINGS">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">stable_pretraining.static.</span></span><span class="sig-name descname"><span class="pre">HF_EMBEDDINGS</span></span><a class="reference internal" href="../_modules/stable_pretraining/static/#HF_EMBEDDINGS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.static.HF_EMBEDDINGS" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Thread-safe, lazy-loaded registry for TIMM (PyTorch Image Models) embedding names, accessed via class-level indexing.</p>
<p>This class provides a mapping from string keys to lists of embedding names, loaded on first access from a
JSON file located at assets/static_timm.json relative to the source file. The data is cached as a class
attribute after the first load, and subsequent accesses are served from memory.
The class is intended to be used as a static registry, e.g.:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">names</span> <span class="o">=</span> <span class="n">TIMM_EMBEDDINGS</span><span class="p">[</span><span class="s2">&quot;resnet50&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>  <span class="c1"># List of embedding names for &#39;resnet50&#39;</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The data is loaded only once per process and is shared across all uses of the class.</p></li>
<li><p>Thread-safe: concurrent first-time access is protected by a class-level lock.</p></li>
<li><p>The class depends on the presence of the assets/static_timm.json file two directories above the source file.</p></li>
<li><p>The class assumes the <cite>__file__</cite> attribute is available and points to the current file.</p></li>
<li><p>The class attribute <cite>_data</cite> is private and shared.</p></li>
<li><p>Logging and printing occur on first load for debugging.</p></li>
<li><p>File system access and JSON parsing are required at runtime.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.14)"><strong>RuntimeError</strong></a>  If the assets file is missing.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#OSError" title="(in Python v3.14)"><strong>OSError</strong></a><strong>, </strong><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#IOError" title="(in Python v3.14)"><strong>IOError</strong></a>  If the file cannot be read.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/json.html#json.JSONDecodeError" title="(in Python v3.14)"><strong>json.JSONDecodeError</strong></a>  If the file is not valid JSON.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#KeyError" title="(in Python v3.14)"><strong>KeyError</strong></a>  If the requested key is not present in the data.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">embeddings</span> <span class="o">=</span> <span class="n">TIMM_EMBEDDINGS</span><span class="p">[</span><span class="s2">&quot;vit_base_patch16_224&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">embeddings</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="stable_pretraining.static.HF_EMBEDDINGS.data">
<span class="sig-name descname"><span class="pre">data</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></span><a class="headerlink" href="#stable_pretraining.static.HF_EMBEDDINGS.data" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stable_pretraining.static.HF_PARAMETERS">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">stable_pretraining.static.</span></span><span class="sig-name descname"><span class="pre">HF_PARAMETERS</span></span><a class="reference internal" href="../_modules/stable_pretraining/static/#HF_PARAMETERS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.static.HF_PARAMETERS" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Thread-safe singleton class for accessing TIMM (Timm Image Models) parameters.</p>
<p>This class provides lazy-loaded, cached access to TIMM model parameters stored
in a static JSON file. It implements a dict-like interface with thread-safe
initialization and defensive copying to prevent mutation of cached data.</p>
<dl>
<dt>Usage:</dt><dd><p># Access parameters by key
params = HF_PARAMETERS[model_name]</p>
<p># Iterate over keys
for key in HF_PARAMETERS.keys():</p>
<blockquote>
<div><p>print(key)</p>
</div></blockquote>
<p># Iterate over values
for values in HF_PARAMETERS.values():</p>
<blockquote>
<div><p>print(values)</p>
</div></blockquote>
<p># Iterate over items
for key, values in HF_PARAMETERS.items():</p>
<blockquote>
<div><p>print(f{key}: {values})</p>
</div></blockquote>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All methods return copies of the data to prevent accidental mutation
of the internal cache.</p>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="stable_pretraining.static.HF_PARAMETERS.data">
<span class="sig-name descname"><span class="pre">data</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></span><a class="headerlink" href="#stable_pretraining.static.HF_PARAMETERS.data" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stable_pretraining.static.MetaStatic">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">stable_pretraining.static.</span></span><span class="sig-name descname"><span class="pre">MetaStatic</span></span><a class="reference internal" href="../_modules/stable_pretraining/static/#MetaStatic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.static.MetaStatic" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#type" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">type</span></code></a></p>
<p>Metaclass that enables dict-like behavior on the TIMM_PARAMETERS class.</p>
<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.static.MetaStatic.clear">
<span class="sig-name descname"><span class="pre">clear</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/static/#MetaStatic.clear"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.static.MetaStatic.clear" title="Link to this definition">#</a></dt>
<dd><p>Clear all data.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.static.MetaStatic.get">
<span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">key</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/static/#MetaStatic.get"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.static.MetaStatic.get" title="Link to this definition">#</a></dt>
<dd><p>Get value with optional default.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.static.MetaStatic.items">
<span class="sig-name descname"><span class="pre">items</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/static/#MetaStatic.items"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.static.MetaStatic.items" title="Link to this definition">#</a></dt>
<dd><p>Return a view of the items (with copied values).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.static.MetaStatic.keys">
<span class="sig-name descname"><span class="pre">keys</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/static/#MetaStatic.keys"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.static.MetaStatic.keys" title="Link to this definition">#</a></dt>
<dd><p>Return a view of the keys.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.static.MetaStatic.update">
<span class="sig-name descname"><span class="pre">update</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">other</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/static/#MetaStatic.update"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.static.MetaStatic.update" title="Link to this definition">#</a></dt>
<dd><p>Update from another dict or iterable of key-value pairs.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.static.MetaStatic.values">
<span class="sig-name descname"><span class="pre">values</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/static/#MetaStatic.values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.static.MetaStatic.values" title="Link to this definition">#</a></dt>
<dd><p>Return a view of the values (as copies to prevent mutation).</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stable_pretraining.static.TIMM_EMBEDDINGS">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">stable_pretraining.static.</span></span><span class="sig-name descname"><span class="pre">TIMM_EMBEDDINGS</span></span><a class="reference internal" href="../_modules/stable_pretraining/static/#TIMM_EMBEDDINGS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.static.TIMM_EMBEDDINGS" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Thread-safe, lazy-loaded registry for TIMM (PyTorch Image Models) embedding names, accessed via class-level indexing.</p>
<p>This class provides a mapping from string keys to lists of embedding names, loaded on first access from a
JSON file located at assets/static_timm.json relative to the source file. The data is cached as a class
attribute after the first load, and subsequent accesses are served from memory.
The class is intended to be used as a static registry, e.g.:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">names</span> <span class="o">=</span> <span class="n">TIMM_EMBEDDINGS</span><span class="p">[</span><span class="s2">&quot;resnet50&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>  <span class="c1"># List of embedding names for &#39;resnet50&#39;</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>The data is loaded only once per process and is shared across all uses of the class.</p></li>
<li><p>Thread-safe: concurrent first-time access is protected by a class-level lock.</p></li>
<li><p>The class depends on the presence of the assets/static_timm.json file two directories above the source file.</p></li>
<li><p>The class assumes the <cite>__file__</cite> attribute is available and points to the current file.</p></li>
<li><p>The class attribute <cite>_data</cite> is private and shared.</p></li>
<li><p>Logging and printing occur on first load for debugging.</p></li>
<li><p>File system access and JSON parsing are required at runtime.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#RuntimeError" title="(in Python v3.14)"><strong>RuntimeError</strong></a>  If the assets file is missing.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#OSError" title="(in Python v3.14)"><strong>OSError</strong></a><strong>, </strong><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#IOError" title="(in Python v3.14)"><strong>IOError</strong></a>  If the file cannot be read.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/json.html#json.JSONDecodeError" title="(in Python v3.14)"><strong>json.JSONDecodeError</strong></a>  If the file is not valid JSON.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#KeyError" title="(in Python v3.14)"><strong>KeyError</strong></a>  If the requested key is not present in the data.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">embeddings</span> <span class="o">=</span> <span class="n">TIMM_EMBEDDINGS</span><span class="p">[</span><span class="s2">&quot;vit_base_patch16_224&quot;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">embeddings</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="stable_pretraining.static.TIMM_EMBEDDINGS.data">
<span class="sig-name descname"><span class="pre">data</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></span><a class="headerlink" href="#stable_pretraining.static.TIMM_EMBEDDINGS.data" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stable_pretraining.static.TIMM_PARAMETERS">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">stable_pretraining.static.</span></span><span class="sig-name descname"><span class="pre">TIMM_PARAMETERS</span></span><a class="reference internal" href="../_modules/stable_pretraining/static/#TIMM_PARAMETERS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.static.TIMM_PARAMETERS" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.14)"><code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></a></p>
<p>Thread-safe singleton class for accessing TIMM (Timm Image Models) parameters.</p>
<p>This class provides lazy-loaded, cached access to TIMM model parameters stored
in a static JSON file. It implements a dict-like interface with thread-safe
initialization and defensive copying to prevent mutation of cached data.</p>
<dl>
<dt>Usage:</dt><dd><p># Access parameters by key
params = TIMM_PARAMETERS[model_name]</p>
<p># Iterate over keys
for key in TIMM_PARAMETERS.keys():</p>
<blockquote>
<div><p>print(key)</p>
</div></blockquote>
<p># Iterate over values
for values in TIMM_PARAMETERS.values():</p>
<blockquote>
<div><p>print(values)</p>
</div></blockquote>
<p># Iterate over items
for key, values in TIMM_PARAMETERS.items():</p>
<blockquote>
<div><p>print(f{key}: {values})</p>
</div></blockquote>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All methods return copies of the data to prevent accidental mutation
of the internal cache.</p>
</div>
<dl class="py attribute">
<dt class="sig sig-object py" id="stable_pretraining.static.TIMM_PARAMETERS.data">
<span class="sig-name descname"><span class="pre">data</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">None</span></span><a class="headerlink" href="#stable_pretraining.static.TIMM_PARAMETERS.data" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stable_pretraining.static.count_parameters">
<span class="sig-prename descclassname"><span class="pre">stable_pretraining.static.</span></span><span class="sig-name descname"><span class="pre">count_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/static/#count_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.static.count_parameters" title="Link to this definition">#</a></dt>
<dd><p>Count trainable parameters efficiently.</p>
</dd></dl>

</section>
<section id="module-stable_pretraining">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-stable_pretraining" title="Link to this heading">#</a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="stable_pretraining.EarlyStopping">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">stable_pretraining.</span></span><span class="sig-name descname"><span class="pre">EarlyStopping</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mode</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'min'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">milestones</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">patience</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/callbacks/utils/#EarlyStopping"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.EarlyStopping" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a></p>
<p>Early stopping mechanism with support for metric milestones and patience.</p>
<p>This module provides flexible early stopping capabilities that can halt training
based on metric performance. It supports both milestone-based stopping (stop if
metric doesnt reach target by specific epochs) and patience-based stopping
(stop if metric doesnt improve for N epochs).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mode</strong>  Optimization direction - min for metrics to minimize (e.g., loss),
max for metrics to maximize (e.g., accuracy).</p></li>
<li><p><strong>milestones</strong>  Dict mapping epoch numbers to target metric values. Training
stops if targets are not met at specified epochs.</p></li>
<li><p><strong>metric_name</strong>  Name of the metric to monitor if metric is a dict.</p></li>
<li><p><strong>patience</strong>  Number of epochs with no improvement before stopping.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">early_stop</span> <span class="o">=</span> <span class="n">EarlyStopping</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="s2">&quot;max&quot;</span><span class="p">,</span> <span class="n">milestones</span><span class="o">=</span><span class="p">{</span><span class="mi">10</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mi">20</span><span class="p">:</span> <span class="mf">0.9</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Stops if accuracy &lt; 0.8 at epoch 10 or &lt; 0.9 at epoch 20</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.EarlyStopping.should_stop">
<span class="sig-name descname"><span class="pre">should_stop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metric</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/callbacks/utils/#EarlyStopping.should_stop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.EarlyStopping.should_stop" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stable_pretraining.ImageRetrieval">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">stable_pretraining.</span></span><span class="sig-name descname"><span class="pre">ImageRetrieval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pl_module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">query_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">retrieval_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">features_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><span class="pre">tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/callbacks/image_retrieval/#ImageRetrieval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.ImageRetrieval" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Callback</span></code></p>
<p>Image Retrieval evaluator for self-supervised learning.</p>
<dl class="simple">
<dt>The implementation follows:</dt><dd><ol class="arabic simple">
<li><p><a class="github reference external" href="https://github.com/facebookresearch/dino/blob/main/eval_image_retrieval.py">facebookresearch/dino</a></p></li>
</ol>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="stable_pretraining.ImageRetrieval.NAME">
<span class="sig-name descname"><span class="pre">NAME</span></span><span class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'ImageRetrieval'</span></span><a class="headerlink" href="#stable_pretraining.ImageRetrieval.NAME" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.ImageRetrieval.on_validation_epoch_end">
<span class="sig-name descname"><span class="pre">on_validation_epoch_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Trainer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pl_module</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">LightningModule</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/stable_pretraining/callbacks/image_retrieval/#ImageRetrieval.on_validation_epoch_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.ImageRetrieval.on_validation_epoch_end" title="Link to this definition">#</a></dt>
<dd><p>Called when the val epoch ends.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.ImageRetrieval.on_validation_epoch_start">
<span class="sig-name descname"><span class="pre">on_validation_epoch_start</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Trainer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pl_module</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">LightningModule</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/stable_pretraining/callbacks/image_retrieval/#ImageRetrieval.on_validation_epoch_start"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.ImageRetrieval.on_validation_epoch_start" title="Link to this definition">#</a></dt>
<dd><p>Called when the val epoch begins.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stable_pretraining.ImageRetrieval.state_key">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">state_key</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><a class="headerlink" href="#stable_pretraining.ImageRetrieval.state_key" title="Link to this definition">#</a></dt>
<dd><p>Unique identifier for this callbacks state during checkpointing.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stable_pretraining.LiDAR">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">stable_pretraining.</span></span><span class="sig-name descname"><span class="pre">LiDAR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">queue_length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.14)"><span class="pre">Iterable</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_classes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">samples_per_class</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">delta</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1e-08</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/callbacks/lidar/#LiDAR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.LiDAR" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Callback</span></code></p>
<p>LiDAR (Linear Discriminant Analysis Rank) monitor using queue discovery.</p>
<p>LiDAR measures the effective rank of learned representations using Linear Discriminant
Analysis (LDA). It computes the exponential of the entropy of the eigenvalue distribution
from the LDA transformation, providing a metric between 1 and min(d, n_classes - 1) where
d is the feature dimension, indicating how many dimensions are effectively being used.</p>
<p>This implementation is based on Thilak et al. LiDAR: Sensing Linear Probing Performance
in Joint Embedding SSL Architectures (arXiv:2312.04000).</p>
<section id="important-surrogate-class-formation-requirement">
<h3>IMPORTANT: Surrogate Class Formation Requirement<a class="headerlink" href="#important-surrogate-class-formation-requirement" title="Link to this heading">#</a></h3>
<p>The LiDAR paper requires that each surrogate class consists of q augmented views
of the same clean sample. The current implementation chunks the queue sequentially
into groups of size samples_per_class. For faithful reproduction of the paper:</p>
<ul class="simple">
<li><p>Ensure the upstream queue pushes q contiguous augmentations of each clean sample</p></li>
<li><p>OR implement ID-based grouping to ensure each group contains views of the same sample</p></li>
</ul>
<p>Without proper grouping, the metric may not accurately reflect the papers methodology.</p>
<p>The metric helps detect:
- Dimensional collapse in self-supervised learning
- Loss of representational capacity
- Over-regularization effects</p>
<dl class="field-list simple">
<dt class="field-odd">param name<span class="colon">:</span></dt>
<dd class="field-odd"><p>Unique identifier for this callback instance</p>
</dd>
<dt class="field-even">param target<span class="colon">:</span></dt>
<dd class="field-even"><p>Key in batch dict containing the feature embeddings to monitor</p>
</dd>
<dt class="field-odd">param queue_length<span class="colon">:</span></dt>
<dd class="field-odd"><p>Size of the circular buffer for caching embeddings</p>
</dd>
<dt class="field-even">param target_shape<span class="colon">:</span></dt>
<dd class="field-even"><p>Shape of the target embeddings (e.g., 768 for 768-dim features)</p>
</dd>
<dt class="field-odd">param n_classes<span class="colon">:</span></dt>
<dd class="field-odd"><p>Number of surrogate classes (clean samples) for LDA computation</p>
</dd>
<dt class="field-even">param samples_per_class<span class="colon">:</span></dt>
<dd class="field-even"><p>Number of augmented samples per class</p>
</dd>
<dt class="field-odd">param delta<span class="colon">:</span></dt>
<dd class="field-odd"><p>Regularization constant added to within-class covariance (default: 1e-4)</p>
</dd>
<dt class="field-even">param epsilon<span class="colon">:</span></dt>
<dd class="field-even"><p>Small constant for numerical stability (default: 1e-8)</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.LiDAR.on_validation_batch_end">
<span class="sig-name descname"><span class="pre">on_validation_batch_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Trainer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pl_module</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">LightningModule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/stable_pretraining/callbacks/lidar/#LiDAR.on_validation_batch_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.LiDAR.on_validation_batch_end" title="Link to this definition">#</a></dt>
<dd><p>Compute LiDAR metric on the first validation batch only.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.LiDAR.setup">
<span class="sig-name descname"><span class="pre">setup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Trainer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pl_module</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">LightningModule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stage</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/stable_pretraining/callbacks/lidar/#LiDAR.setup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.LiDAR.setup" title="Link to this definition">#</a></dt>
<dd><p>Find or create the queue callback for target features.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stable_pretraining.LiDAR.state_key">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">state_key</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><a class="headerlink" href="#stable_pretraining.LiDAR.state_key" title="Link to this definition">#</a></dt>
<dd><p>Unique identifier for this callbacks state during checkpointing.</p>
</dd></dl>

</section>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stable_pretraining.LoggingCallback">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">stable_pretraining.</span></span><span class="sig-name descname"><span class="pre">LoggingCallback</span></span><a class="reference internal" href="../_modules/stable_pretraining/callbacks/trainer_info/#LoggingCallback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.LoggingCallback" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Callback</span></code></p>
<p>Displays validation metrics in a color-coded formatted table.</p>
<p>This callback creates a visually appealing table of all validation metrics
at the end of each validation epoch. Metrics are color-coded for better
readability in terminal outputs.</p>
<p>Features:
- Automatic sorting of metrics by name
- Color coding: blue for metric names, green for values
- Filters out internal metrics (log, progress_bar)</p>
<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.LoggingCallback.on_validation_end">
<span class="sig-name descname"><span class="pre">on_validation_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Trainer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pl_module</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">LightningModule</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/callbacks/trainer_info/#LoggingCallback.on_validation_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.LoggingCallback.on_validation_end" title="Link to this definition">#</a></dt>
<dd><p>Called when the validation loop ends.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stable_pretraining.Manager">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">stable_pretraining.</span></span><span class="sig-name descname"><span class="pre">Manager</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/manager/#Manager"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.Manager" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Checkpointable</span></code></p>
<p>Manages training with logging, scheduling, and checkpointing support.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trainer</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>, </em><em>DictConfig</em><em>, </em><em>pl.Trainer</em><em>]</em>)  PyTorch Lightning trainer configuration or instance.</p></li>
<li><p><strong>module</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>, </em><em>DictConfig</em><em>, </em><em>pl.LightningModule</em><em>]</em>)  Lightning module configuration or instance.</p></li>
<li><p><strong>data</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><em>dict</em></a><em>, </em><em>DictConfig</em><em>, </em><em>pl.LightningDataModule</em><em>]</em>)  Data module configuration or instance.</p></li>
<li><p><strong>seed</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a><em>, </em><em>optional</em>)  Random seed for reproducibility. Defaults to None.</p></li>
<li><p><strong>ckpt_path</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>)  Path to checkpoint for resuming training. Defaults to last.</p></li>
<li><p><strong>compile</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>)  Should we compile the given module. Defaults to False.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.Manager.init_and_sync_wandb">
<span class="sig-name descname"><span class="pre">init_and_sync_wandb</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/manager/#Manager.init_and_sync_wandb"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.Manager.init_and_sync_wandb" title="Link to this definition">#</a></dt>
<dd><p>Handles some utilities for WandB.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stable_pretraining.Manager.instantiated_data">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">instantiated_data</span></span><a class="headerlink" href="#stable_pretraining.Manager.instantiated_data" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stable_pretraining.Manager.instantiated_module">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">instantiated_module</span></span><a class="headerlink" href="#stable_pretraining.Manager.instantiated_module" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.Manager.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/manager/#Manager.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.Manager.predict" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.Manager.save_checkpoint">
<span class="sig-name descname"><span class="pre">save_checkpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">upload_wandb</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/manager/#Manager.save_checkpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.Manager.save_checkpoint" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.Manager.test">
<span class="sig-name descname"><span class="pre">test</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/manager/#Manager.test"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.Manager.test" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.Manager.validate">
<span class="sig-name descname"><span class="pre">validate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/manager/#Manager.validate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.Manager.validate" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stable_pretraining.Module">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">stable_pretraining.</span></span><span class="sig-name descname"><span class="pre">Module</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">forward</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">callable</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hparams</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/module/#Module"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.Module" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">LightningModule</span></code></p>
<p>PyTorch Lightning module using manual optimization with multi-optimizer support.</p>
<p>Core usage
- Provide a custom <cite>forward(self, batch, stage)</cite> via the <cite>forward</cite> argument at init.
- During training, <cite>forward</cite> must return a dict with <cite>state[loss]</cite> (a single joint loss).</p>
<blockquote>
<div><p>When multiple optimizers are configured, this joint loss is used for all optimizers.</p>
</div></blockquote>
<p>Optimizer configuration (<cite>self.optim</cite>)
- Single optimizer:</p>
<blockquote>
<div><p>{optimizer: str|dict|partial|Class, scheduler: &lt;see below&gt;, interval: step|epoch, frequency: int}
- Optimizer accepted forms:</p>
<blockquote>
<div><ul class="simple">
<li><p>string name (e.g., AdamW, SGD) from torch.optim</p></li>
<li><p>dict: {type: AdamW, lr: 1e-3, }</p></li>
<li><p>functools.partial: partial(torch.optim.AdamW, lr=1e-3)</p></li>
<li><p>optimizer class: torch.optim.AdamW</p></li>
</ul>
</div></blockquote>
</div></blockquote>
<ul>
<li><p>Multiple optimizers:
{</p>
<blockquote>
<div><dl class="simple">
<dt>name: {</dt><dd><p>modules: regex,                # assign params by module-name pattern (children inherit)
optimizer: str|dict|partial|Class, # optimizer factory (same accepted forms as above)
scheduler: str|dict|partial|Class, # flexible scheduler config (see below)
interval: step|epoch,       # scheduler interval
frequency: int,                   # optimizer step frequency
monitor: str                      # (optional) for ReduceLROnPlateau; alternatively set inside scheduler dict</p>
</dd>
</dl>
<p>}, </p>
</div></blockquote>
<p>}</p>
</li>
</ul>
<p>Parameter assignment (multi-optimizer)
- Modules are matched by regex on their qualified name. Children inherit the parents assignment</p>
<blockquote>
<div><p>unless they match a more specific pattern. Only direct parameters of each module are collected
to avoid duplication.</p>
</div></blockquote>
<p>Schedulers (flexible)
- Accepted forms: string name (e.g., CosineAnnealingLR, StepLR), dict with {type: , },</p>
<blockquote>
<div><p>functools.partial, or a scheduler class. Smart defaults are applied when params are omitted for
common schedulers (CosineAnnealingLR, OneCycleLR, StepLR, ExponentialLR, ReduceLROnPlateau,
LinearLR, ConstantLR). For ReduceLROnPlateau, a <cite>monitor</cite> key is added (default: val_loss).
You may specify <cite>monitor</cite> either alongside the optimizer config (top level) or inside the
scheduler dict itself.</p>
</div></blockquote>
<ul class="simple">
<li><p>The resulting Lightning scheduler dict includes <cite>interval</cite> and <cite>frequency</cite> (or <cite>scheduler_frequency</cite>).</p></li>
</ul>
<p>Training loop behavior
- Manual optimization (<cite>automatic_optimization = False</cite>).
- Gradient accumulation: scales loss by 1/N where N = Trainer.accumulate_grad_batches and steps on the boundary.
- Per-optimizer step frequency: each optimizer steps only when its frequency boundary is met (in addition to accumulation boundary).
- Gradient clipping: uses Trainers <cite>gradient_clip_val</cite> and <cite>gradient_clip_algorithm</cite> before each step.
- Returns the <cite>state</cite> dict from <cite>forward</cite> unchanged for logging/inspection.</p>
<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.Module.after_manual_backward">
<span class="sig-name descname"><span class="pre">after_manual_backward</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/module/#Module.after_manual_backward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.Module.after_manual_backward" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.Module.configure_optimizers">
<span class="sig-name descname"><span class="pre">configure_optimizers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/module/#Module.configure_optimizers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.Module.configure_optimizers" title="Link to this definition">#</a></dt>
<dd><p>Configure optimizers and schedulers for manual optimization.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Optimizer configuration with optional learning rate scheduler.
For single optimizer: Returns a dict with optimizer and lr_scheduler.
For multiple optimizers: Returns a tuple of (optimizers, schedulers).</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)">dict</a> or <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)">tuple</a></p>
</dd>
</dl>
<p class="rubric">Example</p>
<p>Multi-optimizer configuration with module pattern matching and schedulers:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Simple single optimizer with scheduler</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">optim</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="s2">&quot;optimizer&quot;</span><span class="p">:</span> <span class="n">partial</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">AdamW</span><span class="p">,</span> <span class="n">lr</span><span class="o">=</span><span class="mf">1e-3</span><span class="p">),</span>
<span class="gp">... </span>    <span class="s2">&quot;scheduler&quot;</span><span class="p">:</span> <span class="s2">&quot;CosineAnnealingLR&quot;</span><span class="p">,</span>  <span class="c1"># Uses smart defaults</span>
<span class="gp">... </span>    <span class="s2">&quot;interval&quot;</span><span class="p">:</span> <span class="s2">&quot;step&quot;</span><span class="p">,</span>
<span class="gp">... </span>    <span class="s2">&quot;frequency&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span><span class="p">}</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Multi-optimizer with custom scheduler configs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="bp">self</span><span class="o">.</span><span class="n">optim</span> <span class="o">=</span> <span class="p">{</span>
<span class="gp">... </span>    <span class="s2">&quot;encoder_opt&quot;</span><span class="p">:</span> <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;modules&quot;</span><span class="p">:</span> <span class="s2">&quot;encoder&quot;</span><span class="p">,</span>  <span class="c1"># Matches &#39;encoder&#39; and all children</span>
<span class="gp">... </span>        <span class="s2">&quot;optimizer&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;AdamW&quot;</span><span class="p">,</span> <span class="s2">&quot;lr&quot;</span><span class="p">:</span> <span class="mf">1e-3</span><span class="p">},</span>
<span class="gp">... </span>        <span class="s2">&quot;scheduler&quot;</span><span class="p">:</span> <span class="p">{</span>
<span class="gp">... </span>            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;OneCycleLR&quot;</span><span class="p">,</span>
<span class="gp">... </span>            <span class="s2">&quot;max_lr&quot;</span><span class="p">:</span> <span class="mf">1e-3</span><span class="p">,</span>
<span class="gp">... </span>            <span class="s2">&quot;total_steps&quot;</span><span class="p">:</span> <span class="mi">10000</span><span class="p">,</span>
<span class="gp">... </span>        <span class="p">},</span>
<span class="gp">... </span>        <span class="s2">&quot;interval&quot;</span><span class="p">:</span> <span class="s2">&quot;step&quot;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;frequency&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span>    <span class="p">},</span>
<span class="gp">... </span>    <span class="s2">&quot;head_opt&quot;</span><span class="p">:</span> <span class="p">{</span>
<span class="gp">... </span>        <span class="s2">&quot;modules&quot;</span><span class="p">:</span> <span class="s2">&quot;.*head$&quot;</span><span class="p">,</span>  <span class="c1"># Matches modules ending with &#39;head&#39;</span>
<span class="gp">... </span>        <span class="s2">&quot;optimizer&quot;</span><span class="p">:</span> <span class="s2">&quot;SGD&quot;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;scheduler&quot;</span><span class="p">:</span> <span class="p">{</span>
<span class="gp">... </span>            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;ReduceLROnPlateau&quot;</span><span class="p">,</span>
<span class="gp">... </span>            <span class="s2">&quot;mode&quot;</span><span class="p">:</span> <span class="s2">&quot;max&quot;</span><span class="p">,</span>
<span class="gp">... </span>            <span class="s2">&quot;patience&quot;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span>
<span class="gp">... </span>            <span class="s2">&quot;factor&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>
<span class="gp">... </span>        <span class="p">},</span>
<span class="gp">... </span>        <span class="s2">&quot;monitor&quot;</span><span class="p">:</span> <span class="s2">&quot;val_accuracy&quot;</span><span class="p">,</span>  <span class="c1"># Required for ReduceLROnPlateau</span>
<span class="gp">... </span>        <span class="s2">&quot;interval&quot;</span><span class="p">:</span> <span class="s2">&quot;epoch&quot;</span><span class="p">,</span>
<span class="gp">... </span>        <span class="s2">&quot;frequency&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
<span class="gp">... </span>    <span class="p">},</span>
<span class="gp">... </span><span class="p">}</span>
</pre></div>
</div>
<p>With model structure:
- encoder                 -&gt; encoder_opt (matches encoder)
- encoder.layer1          -&gt; encoder_opt (inherits from parent)
- encoder.layer1.conv     -&gt; encoder_opt (inherits from encoder.layer1)
- classifier_head         -&gt; head_opt (matches .*head$)
- classifier_head.linear  -&gt; head_opt (inherits from parent)
- decoder                 -&gt; None (no match, no parameters collected)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.Module.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/module/#Module.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.Module.forward" title="Link to this definition">#</a></dt>
<dd><p>Same as <a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module.forward" title="(in PyTorch v2.10)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">torch.nn.Module.forward()</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>*args</strong>  Whatever you decide to pass into the forward method.</p></li>
<li><p><strong>**kwargs</strong>  Keyword arguments are also possible.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Your models output</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.Module.named_parameters">
<span class="sig-name descname"><span class="pre">named_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">with_callbacks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recurse</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/module/#Module.named_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.Module.named_parameters" title="Link to this definition">#</a></dt>
<dd><p>Override to globally exclude callback-related parameters.</p>
<p>Excludes parameters that belong to <code class="docutils literal notranslate"><span class="pre">self.callbacks_modules</span></code> or <code class="docutils literal notranslate"><span class="pre">self.callbacks_metrics</span></code>.
This prevents accidental optimization of callback/metric internals, even if external code
calls <code class="docutils literal notranslate"><span class="pre">self.parameters()</span></code> or <code class="docutils literal notranslate"><span class="pre">self.named_parameters()</span></code> directly.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>with_callbacks</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>)  If False, excludes callback parameters. Defaults to True.</p></li>
<li><p><strong>prefix</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><em>str</em></a><em>, </em><em>optional</em>)  Prefix to prepend to parameter names. Defaults to .</p></li>
<li><p><strong>recurse</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>)  If True, yields parameters of this module and all submodules.
If False, yields only direct parameters. Defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Yields<span class="colon">:</span></dt>
<dd class="field-even"><p><em>tuple[str, torch.nn.Parameter]</em>  Name and parameter pairs.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.Module.on_train_start">
<span class="sig-name descname"><span class="pre">on_train_start</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/module/#Module.on_train_start"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.Module.on_train_start" title="Link to this definition">#</a></dt>
<dd><p>Called at the beginning of training after sanity check.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.Module.parameters">
<span class="sig-name descname"><span class="pre">parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">with_callbacks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">recurse</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/module/#Module.parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.Module.parameters" title="Link to this definition">#</a></dt>
<dd><p>Override to route through the filtered <code class="docutils literal notranslate"><span class="pre">named_parameters</span></code> implementation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>with_callbacks</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>)  If False, excludes callback parameters. Defaults to True.</p></li>
<li><p><strong>recurse</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>)  If True, yields parameters of this module and all submodules.
If False, yields only direct parameters. Defaults to True.</p></li>
</ul>
</dd>
<dt class="field-even">Yields<span class="colon">:</span></dt>
<dd class="field-even"><p><em>torch.nn.Parameter</em>  Module parameters.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.Module.predict_step">
<span class="sig-name descname"><span class="pre">predict_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/module/#Module.predict_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.Module.predict_step" title="Link to this definition">#</a></dt>
<dd><p>Step function called during <code class="xref py py-meth docutils literal notranslate"><span class="pre">predict()</span></code>. By default, it calls
<code class="xref py py-meth docutils literal notranslate"><span class="pre">forward()</span></code>. Override to add any processing logic.</p>
<p>The <code class="xref py py-meth docutils literal notranslate"><span class="pre">predict_step()</span></code> is used
to scale inference on multi-devices.</p>
<p>To prevent an OOM error, it is possible to use <code class="xref py py-class docutils literal notranslate"><span class="pre">BasePredictionWriter</span></code>
callback to write the predictions to disk or database after each batch or on epoch end.</p>
<p>The <code class="xref py py-class docutils literal notranslate"><span class="pre">BasePredictionWriter</span></code> should be used while using a spawn
based accelerator. This happens for <code class="docutils literal notranslate"><span class="pre">Trainer(strategy=&quot;ddp_spawn&quot;)</span></code>
or training on 8 TPU cores with <code class="docutils literal notranslate"><span class="pre">Trainer(accelerator=&quot;tpu&quot;,</span> <span class="pre">devices=8)</span></code> as predictions wont be returned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch</strong>  The output of your data iterable, normally a <a class="reference external" href="https://docs.pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataLoader</span></code></a>.</p></li>
<li><p><strong>batch_idx</strong>  The index of this batch.</p></li>
<li><p><strong>dataloader_idx</strong>  The index of the dataloader that produced this batch.
(only if multiple dataloaders used)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Predicted output (optional).</p>
</dd>
</dl>
<p>Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span><span class="w"> </span><span class="nc">MyModel</span><span class="p">(</span><span class="n">LightningModule</span><span class="p">):</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">predict_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">,</span> <span class="n">batch_idx</span><span class="p">,</span> <span class="n">dataloader_idx</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>

<span class="n">dm</span> <span class="o">=</span> <span class="o">...</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">MyModel</span><span class="p">()</span>
<span class="n">trainer</span> <span class="o">=</span> <span class="n">Trainer</span><span class="p">(</span><span class="n">accelerator</span><span class="o">=</span><span class="s2">&quot;gpu&quot;</span><span class="p">,</span> <span class="n">devices</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">predictions</span> <span class="o">=</span> <span class="n">trainer</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">dm</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.Module.rescale_loss_for_grad_acc">
<span class="sig-name descname"><span class="pre">rescale_loss_for_grad_acc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">loss</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/module/#Module.rescale_loss_for_grad_acc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.Module.rescale_loss_for_grad_acc" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.Module.test_step">
<span class="sig-name descname"><span class="pre">test_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/module/#Module.test_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.Module.test_step" title="Link to this definition">#</a></dt>
<dd><p>Operates on a single batch of data from the test set. In this step youd normally generate examples or
calculate anything of interest such as accuracy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch</strong>  The output of your data iterable, normally a <a class="reference external" href="https://docs.pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataLoader</span></code></a>.</p></li>
<li><p><strong>batch_idx</strong>  The index of this batch.</p></li>
<li><p><strong>dataloader_idx</strong>  The index of the dataloader that produced this batch.
(only if multiple dataloaders used)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a> - The loss tensor</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dict</span></code> - A dictionary. Can include any keys, but must include the key <code class="docutils literal notranslate"><span class="pre">'loss'</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code> - Skip to the next batch.</p></li>
</ul>
</p>
</dd>
</dl>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># if you have one test dataloader:</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">,</span> <span class="n">batch_idx</span><span class="p">):</span> <span class="o">...</span>


<span class="c1"># if you have multiple test dataloaders:</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">,</span> <span class="n">batch_idx</span><span class="p">,</span> <span class="n">dataloader_idx</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span> <span class="o">...</span>
</pre></div>
</div>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># CASE 1: A single test dataset</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">,</span> <span class="n">batch_idx</span><span class="p">):</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">batch</span>

    <span class="c1"># implement your own</span>
    <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loss</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

    <span class="c1"># log 6 example images</span>
    <span class="c1"># or generated text... or whatever</span>
    <span class="n">sample_imgs</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:</span><span class="mi">6</span><span class="p">]</span>
    <span class="n">grid</span> <span class="o">=</span> <span class="n">torchvision</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">make_grid</span><span class="p">(</span><span class="n">sample_imgs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">add_image</span><span class="p">(</span><span class="s1">&#39;example_images&#39;</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="c1"># calculate acc</span>
    <span class="n">labels_hat</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">test_acc</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">y</span> <span class="o">==</span> <span class="n">labels_hat</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="o">/</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.0</span><span class="p">)</span>

    <span class="c1"># log the outputs!</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log_dict</span><span class="p">({</span><span class="s1">&#39;test_loss&#39;</span><span class="p">:</span> <span class="n">loss</span><span class="p">,</span> <span class="s1">&#39;test_acc&#39;</span><span class="p">:</span> <span class="n">test_acc</span><span class="p">})</span>
</pre></div>
</div>
<p>If you pass in multiple test dataloaders, <a class="reference internal" href="#stable_pretraining.Module.test_step" title="stable_pretraining.Module.test_step"><code class="xref py py-meth docutils literal notranslate"><span class="pre">test_step()</span></code></a> will have an additional argument. We recommend
setting the default value of 0 so that you can quickly switch between single and multiple dataloaders.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># CASE 2: multiple test dataloaders</span>
<span class="k">def</span><span class="w"> </span><span class="nf">test_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">,</span> <span class="n">batch_idx</span><span class="p">,</span> <span class="n">dataloader_idx</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="c1"># dataloader_idx tells you which dataset this is.</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">batch</span>

    <span class="c1"># implement your own</span>
    <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">dataloader_idx</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loss0</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loss1</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

    <span class="c1"># calculate acc</span>
    <span class="n">labels_hat</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">acc</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">y</span> <span class="o">==</span> <span class="n">labels_hat</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="o">/</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.0</span><span class="p">)</span>

    <span class="c1"># log the outputs separately for each dataloader</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log_dict</span><span class="p">({</span><span class="sa">f</span><span class="s2">&quot;test_loss_</span><span class="si">{</span><span class="n">dataloader_idx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="n">loss</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;test_acc_</span><span class="si">{</span><span class="n">dataloader_idx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="n">acc</span><span class="p">})</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you dont need to test you dont need to implement this method.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When the <a class="reference internal" href="#stable_pretraining.Module.test_step" title="stable_pretraining.Module.test_step"><code class="xref py py-meth docutils literal notranslate"><span class="pre">test_step()</span></code></a> is called, the model has been put in eval mode and
PyTorch gradients have been disabled. At the end of the test epoch, the model goes back
to training mode and gradients are enabled.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.Module.training_step">
<span class="sig-name descname"><span class="pre">training_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/module/#Module.training_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.Module.training_step" title="Link to this definition">#</a></dt>
<dd><p>Manual optimization training step with support for multiple optimizers.</p>
<p>Expected output from forward during training (stage=fit):
- state[loss]: torch.Tensor - Single joint loss for all optimizers</p>
<p>When multiple optimizers are configured, the same loss is used for all of them.
Each optimizer updates its assigned parameters based on gradients from this joint loss.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.Module.validation_step">
<span class="sig-name descname"><span class="pre">validation_step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/module/#Module.validation_step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.Module.validation_step" title="Link to this definition">#</a></dt>
<dd><p>Operates on a single batch of data from the validation set. In this step youd might generate examples or
calculate anything of interest like accuracy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch</strong>  The output of your data iterable, normally a <a class="reference external" href="https://docs.pytorch.org/docs/stable/data.html#torch.utils.data.DataLoader" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataLoader</span></code></a>.</p></li>
<li><p><strong>batch_idx</strong>  The index of this batch.</p></li>
<li><p><strong>dataloader_idx</strong>  The index of the dataloader that produced this batch.
(only if multiple dataloaders used)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><a class="reference external" href="https://docs.pytorch.org/docs/stable/tensors.html#torch.Tensor" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Tensor</span></code></a> - The loss tensor</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dict</span></code> - A dictionary. Can include any keys, but must include the key <code class="docutils literal notranslate"><span class="pre">'loss'</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">None</span></code> - Skip to the next batch.</p></li>
</ul>
</p>
</dd>
</dl>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># if you have one val dataloader:</span>
<span class="k">def</span><span class="w"> </span><span class="nf">validation_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">,</span> <span class="n">batch_idx</span><span class="p">):</span> <span class="o">...</span>


<span class="c1"># if you have multiple val dataloaders:</span>
<span class="k">def</span><span class="w"> </span><span class="nf">validation_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">,</span> <span class="n">batch_idx</span><span class="p">,</span> <span class="n">dataloader_idx</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span> <span class="o">...</span>
</pre></div>
</div>
<p>Examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># CASE 1: A single validation dataset</span>
<span class="k">def</span><span class="w"> </span><span class="nf">validation_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">,</span> <span class="n">batch_idx</span><span class="p">):</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">batch</span>

    <span class="c1"># implement your own</span>
    <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loss</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

    <span class="c1"># log 6 example images</span>
    <span class="c1"># or generated text... or whatever</span>
    <span class="n">sample_imgs</span> <span class="o">=</span> <span class="n">x</span><span class="p">[:</span><span class="mi">6</span><span class="p">]</span>
    <span class="n">grid</span> <span class="o">=</span> <span class="n">torchvision</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">make_grid</span><span class="p">(</span><span class="n">sample_imgs</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">logger</span><span class="o">.</span><span class="n">experiment</span><span class="o">.</span><span class="n">add_image</span><span class="p">(</span><span class="s1">&#39;example_images&#39;</span><span class="p">,</span> <span class="n">grid</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="c1"># calculate acc</span>
    <span class="n">labels_hat</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">val_acc</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">y</span> <span class="o">==</span> <span class="n">labels_hat</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="o">/</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.0</span><span class="p">)</span>

    <span class="c1"># log the outputs!</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log_dict</span><span class="p">({</span><span class="s1">&#39;val_loss&#39;</span><span class="p">:</span> <span class="n">loss</span><span class="p">,</span> <span class="s1">&#39;val_acc&#39;</span><span class="p">:</span> <span class="n">val_acc</span><span class="p">})</span>
</pre></div>
</div>
<p>If you pass in multiple val dataloaders, <a class="reference internal" href="#stable_pretraining.Module.validation_step" title="stable_pretraining.Module.validation_step"><code class="xref py py-meth docutils literal notranslate"><span class="pre">validation_step()</span></code></a> will have an additional argument. We recommend
setting the default value of 0 so that you can quickly switch between single and multiple dataloaders.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># CASE 2: multiple validation dataloaders</span>
<span class="k">def</span><span class="w"> </span><span class="nf">validation_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">,</span> <span class="n">batch_idx</span><span class="p">,</span> <span class="n">dataloader_idx</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="c1"># dataloader_idx tells you which dataset this is.</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">batch</span>

    <span class="c1"># implement your own</span>
    <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">dataloader_idx</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loss0</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loss1</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

    <span class="c1"># calculate acc</span>
    <span class="n">labels_hat</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">acc</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">y</span> <span class="o">==</span> <span class="n">labels_hat</span><span class="p">)</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="o">/</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1.0</span><span class="p">)</span>

    <span class="c1"># log the outputs separately for each dataloader</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">log_dict</span><span class="p">({</span><span class="sa">f</span><span class="s2">&quot;val_loss_</span><span class="si">{</span><span class="n">dataloader_idx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="n">loss</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;val_acc_</span><span class="si">{</span><span class="n">dataloader_idx</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="n">acc</span><span class="p">})</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you dont need to validate you dont need to implement this method.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When the <a class="reference internal" href="#stable_pretraining.Module.validation_step" title="stable_pretraining.Module.validation_step"><code class="xref py py-meth docutils literal notranslate"><span class="pre">validation_step()</span></code></a> is called, the model has been put in eval mode
and PyTorch gradients have been disabled. At the end of validation,
the model goes back to training mode and gradients are enabled.</p>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stable_pretraining.ModuleSummary">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">stable_pretraining.</span></span><span class="sig-name descname"><span class="pre">ModuleSummary</span></span><a class="reference internal" href="../_modules/stable_pretraining/callbacks/trainer_info/#ModuleSummary"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.ModuleSummary" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Callback</span></code></p>
<p>Logs detailed module parameter statistics in a formatted table.</p>
<p>This callback provides a comprehensive overview of all modules in the model,
showing the number of trainable, non-trainable, uninitialized parameters,
and buffers for each module. This helps understand model architecture and
parameter distribution.</p>
<p>The summary is displayed during the setup phase and includes:
- Module name and hierarchy
- Trainable parameter count
- Non-trainable (frozen) parameter count
- Uninitialized parameter count (for lazy modules)
- Buffer count (non-parameter persistent state)</p>
<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.ModuleSummary.setup">
<span class="sig-name descname"><span class="pre">setup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pl_module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stage</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/callbacks/trainer_info/#ModuleSummary.setup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.ModuleSummary.setup" title="Link to this definition">#</a></dt>
<dd><p>Called when fit, validate, test, predict, or tune begins.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stable_pretraining.OnlineKNN">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">stable_pretraining.</span></span><span class="sig-name descname"><span class="pre">OnlineKNN</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">queue_length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.14)"><span class="pre">Tuple</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="p"><span class="pre">...</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.List" title="(in Python v3.14)"><span class="pre">List</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_dim</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">temperature</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.07</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">chunk_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distance_metric</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Literal" title="(in Python v3.14)"><span class="pre">Literal</span></a><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'euclidean'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'squared_euclidean'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'cosine'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'manhattan'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'euclidean'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/callbacks/knn/#OnlineKNN"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.OnlineKNN" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Callback</span></code></p>
<p>Weighted K-Nearest Neighbors online evaluator using queue discovery.</p>
<p>This callback implements a weighted KNN classifier that evaluates the quality of
learned representations during training. It automatically discovers or creates
OnlineQueue callbacks to maintain circular buffers of features and labels, then
uses this cached data to compute KNN predictions during validation.</p>
<p>The KNN evaluation is performed by:
1. Finding k nearest neighbors in the feature space
2. Weighting neighbors by inverse distance with temperature scaling
3. Using weighted voting to produce class predictions
4. Computing specified metrics on the predictions</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong>  Unique identifier for this callback instance. Used for logging and
storing metrics.</p></li>
<li><p><strong>input</strong>  Key in batch dict containing input features to evaluate.</p></li>
<li><p><strong>target</strong>  Key in batch dict containing ground truth target labels.</p></li>
<li><p><strong>queue_length</strong>  Size of the circular buffer for caching features and labels.
Larger values provide more representative samples but use more memory.</p></li>
<li><p><strong>metrics</strong>  Dictionary of metrics to compute during validation. Keys are metric
names, values are metric instances (e.g., torchmetrics.Accuracy).</p></li>
<li><p><strong>input_dim</strong>  Expected dimensionality of input features. Can be int, tuple/list
(will be flattened to product), or None to accept any dimension.</p></li>
<li><p><strong>target_dim</strong>  Expected dimensionality of targets. None accepts any dimension.</p></li>
<li><p><strong>k</strong>  Number of nearest neighbors to consider for voting. Default is 5.</p></li>
<li><p><strong>temperature</strong>  Temperature parameter for distance weighting. Lower values give
more weight to closer neighbors. Default is 0.07.</p></li>
<li><p><strong>chunk_size</strong>  Batch size for memory-efficient distance computation. Set to -1
to compute all distances at once. Default is -1.</p></li>
<li><p><strong>distance_metric</strong>  Distance metric for finding nearest neighbors. Options are
euclidean, squared_euclidean, cosine, manhattan. Default is euclidean.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.14)"><strong>ValueError</strong></a>  If k &lt;= 0, temperature &lt;= 0, or chunk_size is invalid.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>The callback automatically handles distributed training by gathering data</p></li>
<li><p>Mixed precision is supported through automatic dtype conversion</p></li>
<li><p>Predictions are stored in batch dict with key {name}_preds</p></li>
<li><p>Metrics are logged with prefix eval/{name}_</p></li>
</ul>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.OnlineKNN.on_validation_batch_end">
<span class="sig-name descname"><span class="pre">on_validation_batch_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Trainer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pl_module</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">LightningModule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Dict" title="(in Python v3.14)"><span class="pre">Dict</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/stable_pretraining/callbacks/knn/#OnlineKNN.on_validation_batch_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.OnlineKNN.on_validation_batch_end" title="Link to this definition">#</a></dt>
<dd><p>Compute KNN predictions during validation.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.OnlineKNN.setup">
<span class="sig-name descname"><span class="pre">setup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Trainer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pl_module</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">LightningModule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stage</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/stable_pretraining/callbacks/knn/#OnlineKNN.setup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.OnlineKNN.setup" title="Link to this definition">#</a></dt>
<dd><p>Find or create queue callbacks and setup metrics.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stable_pretraining.OnlineKNN.state_key">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">state_key</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><a class="headerlink" href="#stable_pretraining.OnlineKNN.state_key" title="Link to this definition">#</a></dt>
<dd><p>Unique identifier for this callbacks state during checkpointing.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stable_pretraining.OnlineProbe">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">stable_pretraining.</span></span><span class="sig-name descname"><span class="pre">OnlineProbe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">module</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">LightningModule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">input</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">probe</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.10)"><span class="pre">Module</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">loss</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">callable</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimizer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">partial</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/optim.html#torch.optim.Optimizer" title="(in PyTorch v2.10)"><span class="pre">Optimizer</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scheduler</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">partial</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.optim.lr_scheduler.LRScheduler.html#torch.optim.lr_scheduler.LRScheduler" title="(in PyTorch v2.10)"><span class="pre">LRScheduler</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">accumulate_grad_batches</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gradient_clip_val</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gradient_clip_algorithm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'norm'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.14)"><span class="pre">tuple</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Metric</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/callbacks/probe/#OnlineProbe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.OnlineProbe" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="../stable_pretraining.callbacks/#stable_pretraining.callbacks.utils.TrainableCallback" title="stable_pretraining.callbacks.utils.TrainableCallback"><code class="xref py py-class docutils literal notranslate"><span class="pre">TrainableCallback</span></code></a></p>
<p>Online probe for evaluating learned representations during self-supervised training.</p>
<p>This callback implements the standard linear evaluation protocol by training a probe
(typically a linear classifier) on top of frozen features from the main model. The probe
is trained simultaneously with the main model but maintains its own optimizer, scheduler,
and training loop. This allows monitoring representation quality throughout training
without modifying the base model.</p>
<p>Key features:
- Automatic gradient detachment to prevent probe gradients affecting the main model
- Independent optimizer and scheduler management
- Support for gradient accumulation
- Mixed precision training compatibility through automatic dtype conversion
- Metric tracking and logging</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>module</strong>  The spt.LightningModule to probe.</p></li>
<li><p><strong>name</strong>  Unique identifier for this probe instance. Used for logging and storing
metrics/modules.</p></li>
<li><p><strong>input</strong>  Key in batch dict or outputs dict containing input features to probe.</p></li>
<li><p><strong>target</strong>  Key in batch dict containing ground truth target labels.</p></li>
<li><p><strong>probe</strong>  The probe module to train. Can be a nn.Module instance, callable that
returns a module, or Hydra config to instantiate.</p></li>
<li><p><strong>loss</strong>  Loss function for probe training (e.g., nn.CrossEntropyLoss()).</p></li>
<li><p><strong>optimizer</strong>  <p>Optimizer configuration for the probe. Can be:
- str: optimizer name (e.g., AdamW, SGD, LARS)
- dict: {type: AdamW, lr: 1e-3, }
- partial: pre-configured optimizer factory
- optimizer instance or callable
- None: uses LARS(lr=0.1, clip_lr=True, eta=0.02, exclude_bias_n_norm=True,</p>
<blockquote>
<div><p>weight_decay=0), which is the standard for SSL linear probes (default)</p>
</div></blockquote>
</p></li>
<li><p><strong>scheduler</strong>  Learning rate scheduler configuration. Can be:
- str: scheduler name (e.g., CosineAnnealingLR, StepLR)
- dict: {type: CosineAnnealingLR, T_max: 1000, }
- partial: pre-configured scheduler factory
- scheduler instance or callable
- None: uses ConstantLR(factor=1.0), maintaining constant learning rate (default)</p></li>
<li><p><strong>accumulate_grad_batches</strong>  Number of batches to accumulate gradients before
optimizer step. Default is 1 (no accumulation).</p></li>
<li><p><strong>metrics</strong>  Metrics to track during training/validation. Can be dict, list, tuple,
or single metric instance.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>The probe module is stored in pl_module.callbacks_modules[name]</p></li>
<li><p>Metrics are stored in pl_module.callbacks_metrics[name]</p></li>
<li><p>Predictions are stored in batch dict with key {name}_preds</p></li>
<li><p>Loss is logged as train/{name}_loss</p></li>
<li><p>Metrics are logged with prefix train/{name}_ and eval/{name}_</p></li>
</ul>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.OnlineProbe.configure_model">
<span class="sig-name descname"><span class="pre">configure_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pl_module</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">LightningModule</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.10)"><span class="pre">Module</span></a></span></span><a class="reference internal" href="../_modules/stable_pretraining/callbacks/probe/#OnlineProbe.configure_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.OnlineProbe.configure_model" title="Link to this definition">#</a></dt>
<dd><p>Initialize the probe module from configuration.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.OnlineProbe.wrap_forward">
<span class="sig-name descname"><span class="pre">wrap_forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pl_module</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/callbacks/probe/#OnlineProbe.wrap_forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.OnlineProbe.wrap_forward" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stable_pretraining.OnlineWriter">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">stable_pretraining.</span></span><span class="sig-name descname"><span class="pre">OnlineWriter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/pathlib.html#pathlib.Path" title="(in Python v3.14)"><span class="pre">Path</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">during</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.14)"><span class="pre">list</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">every_k_epochs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">-1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_last_epoch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_sanity_check</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">all_gather</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/callbacks/writer/#OnlineWriter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.OnlineWriter" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Callback</span></code></p>
<p>Writes specified batch data to disk during training and validation.</p>
<p>This callback enables selective saving of batch data (e.g., features, predictions,
embeddings) to disk at specified intervals during training. Its useful for
debugging, visualization, and analysis of model behavior during training.</p>
<p>Features:
- Flexible saving schedule (every k epochs, last epoch, sanity check)
- Support for distributed training with optional all_gather
- Automatic directory creation
- Configurable for different training phases (train, val, test)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>names</strong>  Name(s) of the batch keys to save. Can be string or list of strings.</p></li>
<li><p><strong>path</strong>  Directory path where files will be saved.</p></li>
<li><p><strong>during</strong>  Training phase(s) when to save (train, val, test, or list).</p></li>
<li><p><strong>every_k_epochs</strong>  Save every k epochs. -1 means every epoch.</p></li>
<li><p><strong>save_last_epoch</strong>  Whether to save on the last training epoch.</p></li>
<li><p><strong>save_sanity_check</strong>  Whether to save during sanity check phase.</p></li>
<li><p><strong>all_gather</strong>  Whether to gather data across all distributed processes.</p></li>
</ul>
</dd>
</dl>
<p>Files are saved with naming pattern: {phase}_{name}_epoch{epoch}_batch{batch}.pt</p>
<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.OnlineWriter.dump">
<span class="sig-name descname"><span class="pre">dump</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pl_module</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">LightningModule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/callbacks/writer/#OnlineWriter.dump"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.OnlineWriter.dump" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.OnlineWriter.is_writing_epoch">
<span class="sig-name descname"><span class="pre">is_writing_epoch</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pl_module</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/callbacks/writer/#OnlineWriter.is_writing_epoch"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.OnlineWriter.is_writing_epoch" title="Link to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.OnlineWriter.on_predict_batch_end">
<span class="sig-name descname"><span class="pre">on_predict_batch_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pl_module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/callbacks/writer/#OnlineWriter.on_predict_batch_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.OnlineWriter.on_predict_batch_end" title="Link to this definition">#</a></dt>
<dd><p>Called when the predict batch ends.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.OnlineWriter.on_sanity_check_end">
<span class="sig-name descname"><span class="pre">on_sanity_check_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pl_module</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/callbacks/writer/#OnlineWriter.on_sanity_check_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.OnlineWriter.on_sanity_check_end" title="Link to this definition">#</a></dt>
<dd><p>Called when the validation sanity check ends.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.OnlineWriter.on_sanity_check_start">
<span class="sig-name descname"><span class="pre">on_sanity_check_start</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pl_module</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/callbacks/writer/#OnlineWriter.on_sanity_check_start"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.OnlineWriter.on_sanity_check_start" title="Link to this definition">#</a></dt>
<dd><p>Called when the validation sanity check starts.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.OnlineWriter.on_test_batch_end">
<span class="sig-name descname"><span class="pre">on_test_batch_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pl_module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/callbacks/writer/#OnlineWriter.on_test_batch_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.OnlineWriter.on_test_batch_end" title="Link to this definition">#</a></dt>
<dd><p>Called when the test batch ends.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.OnlineWriter.on_train_batch_end">
<span class="sig-name descname"><span class="pre">on_train_batch_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pl_module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/callbacks/writer/#OnlineWriter.on_train_batch_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.OnlineWriter.on_train_batch_end" title="Link to this definition">#</a></dt>
<dd><p>Called when the train batch ends.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The value <code class="docutils literal notranslate"><span class="pre">outputs[&quot;loss&quot;]</span></code> here will be the normalized value w.r.t <code class="docutils literal notranslate"><span class="pre">accumulate_grad_batches</span></code> of the
loss returned from <code class="docutils literal notranslate"><span class="pre">training_step</span></code>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.OnlineWriter.on_validation_batch_end">
<span class="sig-name descname"><span class="pre">on_validation_batch_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pl_module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/callbacks/writer/#OnlineWriter.on_validation_batch_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.OnlineWriter.on_validation_batch_end" title="Link to this definition">#</a></dt>
<dd><p>Called when the validation batch ends.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.OnlineWriter.write_at_phase">
<span class="sig-name descname"><span class="pre">write_at_phase</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pl_module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phase_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/callbacks/writer/#OnlineWriter.write_at_phase"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.OnlineWriter.write_at_phase" title="Link to this definition">#</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stable_pretraining.RankMe">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">stable_pretraining.</span></span><span class="sig-name descname"><span class="pre">RankMe</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">target</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">queue_length</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_shape</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Iterable" title="(in Python v3.14)"><span class="pre">Iterable</span></a><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/callbacks/rankme/#RankMe"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.RankMe" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Callback</span></code></p>
<p>RankMe (effective rank) monitor using queue discovery.</p>
<p>RankMe measures the effective rank of feature representations by computing
the exponential of the entropy of normalized singular values. This metric
helps detect dimensional collapse in self-supervised learning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong>  Unique name for this callback instance</p></li>
<li><p><strong>target</strong>  Key in batch dict containing the feature embeddings to monitor</p></li>
<li><p><strong>queue_length</strong>  Required queue length</p></li>
<li><p><strong>target_shape</strong>  Shape of the target embeddings (e.g., 768 for 768-dim features)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.RankMe.on_validation_batch_end">
<span class="sig-name descname"><span class="pre">on_validation_batch_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Trainer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pl_module</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">LightningModule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.14)"><span class="pre">dict</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataloader_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/stable_pretraining/callbacks/rankme/#RankMe.on_validation_batch_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.RankMe.on_validation_batch_end" title="Link to this definition">#</a></dt>
<dd><p>Compute RankMe metric on the first validation batch only.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.RankMe.setup">
<span class="sig-name descname"><span class="pre">setup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Trainer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pl_module</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">LightningModule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stage</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/stable_pretraining/callbacks/rankme/#RankMe.setup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.RankMe.setup" title="Link to this definition">#</a></dt>
<dd><p>Find or create the queue callback for target features.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="stable_pretraining.RankMe.state_key">
<span class="property"><span class="k"><span class="pre">property</span></span><span class="w"> </span></span><span class="sig-name descname"><span class="pre">state_key</span></span><span class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><a class="headerlink" href="#stable_pretraining.RankMe.state_key" title="Link to this definition">#</a></dt>
<dd><p>Unique identifier for this callbacks state during checkpointing.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stable_pretraining.SklearnCheckpoint">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">stable_pretraining.</span></span><span class="sig-name descname"><span class="pre">SklearnCheckpoint</span></span><a class="reference internal" href="../_modules/stable_pretraining/callbacks/checkpoint_sklearn/#SklearnCheckpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.SklearnCheckpoint" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Callback</span></code></p>
<p>Callback for saving and loading sklearn models in PyTorch Lightning checkpoints.</p>
<p>This callback automatically detects sklearn models (Regressors and Classifiers)
attached to the Lightning module and handles their serialization/deserialization
during checkpoint save/load operations. This is necessary because sklearn models
are not natively supported by PyTorchs checkpoint system.</p>
<p>The callback will:
1. Automatically discover sklearn models attached to the Lightning module
2. Save them to the checkpoint dictionary during checkpoint saving
3. Restore them from the checkpoint during checkpoint loading
4. Log information about discovered sklearn modules during setup</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ul class="simple">
<li><p>Only attributes that are sklearn RegressorMixin or ClassifierMixin instances are saved</p></li>
<li><p>Private attributes (starting with _) are ignored</p></li>
<li><p>The callback will raise an error if a sklearn model name conflicts with existing checkpoint keys</p></li>
</ul>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.SklearnCheckpoint.on_load_checkpoint">
<span class="sig-name descname"><span class="pre">on_load_checkpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pl_module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/callbacks/checkpoint_sklearn/#SklearnCheckpoint.on_load_checkpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.SklearnCheckpoint.on_load_checkpoint" title="Link to this definition">#</a></dt>
<dd><p>Called when loading a model checkpoint, use to reload state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trainer</strong>  the current <code class="xref py py-class docutils literal notranslate"><span class="pre">Trainer</span></code> instance.</p></li>
<li><p><strong>pl_module</strong>  the current <code class="xref py py-class docutils literal notranslate"><span class="pre">LightningModule</span></code> instance.</p></li>
<li><p><strong>checkpoint</strong>  the full checkpoint dictionary that got loaded by the Trainer.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.SklearnCheckpoint.on_save_checkpoint">
<span class="sig-name descname"><span class="pre">on_save_checkpoint</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pl_module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">checkpoint</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/callbacks/checkpoint_sklearn/#SklearnCheckpoint.on_save_checkpoint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.SklearnCheckpoint.on_save_checkpoint" title="Link to this definition">#</a></dt>
<dd><p>Called when saving a checkpoint to give you a chance to store anything else you might want to save.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>trainer</strong>  the current <code class="xref py py-class docutils literal notranslate"><span class="pre">Trainer</span></code> instance.</p></li>
<li><p><strong>pl_module</strong>  the current <code class="xref py py-class docutils literal notranslate"><span class="pre">LightningModule</span></code> instance.</p></li>
<li><p><strong>checkpoint</strong>  the checkpoint dictionary that will be saved.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.SklearnCheckpoint.setup">
<span class="sig-name descname"><span class="pre">setup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Trainer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pl_module</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">LightningModule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stage</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/stable_pretraining/callbacks/checkpoint_sklearn/#SklearnCheckpoint.setup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.SklearnCheckpoint.setup" title="Link to this definition">#</a></dt>
<dd><p>Called when fit, validate, test, predict, or tune begins.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stable_pretraining.TeacherStudentCallback">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">stable_pretraining.</span></span><span class="sig-name descname"><span class="pre">TeacherStudentCallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">update_frequency</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_after_backward</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/callbacks/teacher_student/#TeacherStudentCallback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.TeacherStudentCallback" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Callback</span></code></p>
<p>Automatically updates TeacherStudentWrapper instances during training.</p>
<p>This callback handles the EMA (Exponential Moving Average) updates for any
TeacherStudentWrapper instances found in the model. It updates both the teacher
parameters and the EMA coefficient schedule.</p>
<p>The callback automatically detects all TeacherStudentWrapper instances in the
model hierarchy and updates them at the appropriate times during training.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>update_frequency</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>)  How often to update the teacher (in batches).
Default is 1 (every batch).</p></li>
<li><p><strong>update_after_backward</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a>)  If True, updates happen after backward pass.
If False, updates happen after optimizer step. Default is True.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">backbone</span> <span class="o">=</span> <span class="n">ResNet18</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wrapped_backbone</span> <span class="o">=</span> <span class="n">TeacherStudentWrapper</span><span class="p">(</span><span class="n">backbone</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">module</span> <span class="o">=</span> <span class="n">ssl</span><span class="o">.</span><span class="n">Module</span><span class="p">(</span><span class="n">backbone</span><span class="o">=</span><span class="n">wrapped_backbone</span><span class="p">,</span> <span class="o">...</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">trainer</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">Trainer</span><span class="p">(</span><span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">TeacherStudentCallback</span><span class="p">()])</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.TeacherStudentCallback.on_after_backward">
<span class="sig-name descname"><span class="pre">on_after_backward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Trainer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pl_module</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">LightningModule</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/stable_pretraining/callbacks/teacher_student/#TeacherStudentCallback.on_after_backward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.TeacherStudentCallback.on_after_backward" title="Link to this definition">#</a></dt>
<dd><p>Update teacher models after backward pass if update_after_backward is True.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.TeacherStudentCallback.on_fit_start">
<span class="sig-name descname"><span class="pre">on_fit_start</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Trainer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pl_module</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">LightningModule</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/stable_pretraining/callbacks/teacher_student/#TeacherStudentCallback.on_fit_start"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.TeacherStudentCallback.on_fit_start" title="Link to this definition">#</a></dt>
<dd><p>Log if TeacherStudentWrapper instances are found.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.TeacherStudentCallback.on_train_batch_end">
<span class="sig-name descname"><span class="pre">on_train_batch_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Trainer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pl_module</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">LightningModule</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_idx</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/stable_pretraining/callbacks/teacher_student/#TeacherStudentCallback.on_train_batch_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.TeacherStudentCallback.on_train_batch_end" title="Link to this definition">#</a></dt>
<dd><p>Update teacher models after training batch if update_after_backward is False.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stable_pretraining.TeacherStudentWrapper">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">stable_pretraining.</span></span><span class="sig-name descname"><span class="pre">TeacherStudentWrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">student</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.10)"><span class="pre">Module</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">warm_init</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><span class="pre">bool</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_ema_coefficient</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.996</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">final_ema_coefficient</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><span class="pre">float</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/backbone/utils/#TeacherStudentWrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.TeacherStudentWrapper" title="Link to this definition">#</a></dt>
<dd><p>Bases: <a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Module</span></code></a></p>
<p>Backbone wrapper that implements teacher-student distillation via EMA.</p>
<p>This is a wrapper for backbones that creates a teacher model as an exponential moving average (EMA) of the student model.
It should be passed as the backbone to stable_pretraining.Module and accessed via
forward_student() and forward_teacher() methods in your custom forward function.</p>
<p>The teacher model is updated by taking a running average of the students
parameters and buffers. When <cite>ema_coefficient == 0.0</cite>, the teacher and student
are literally the same object, saving memory but forward passes through the teacher
will not produce any gradients.</p>
<dl>
<dt>Usage example:</dt><dd><p>backbone = ResNet18()
wrapped_backbone = TeacherStudentWrapper(backbone)
module = ssl.Module(</p>
<blockquote>
<div><p>backbone=wrapped_backbone,
projector=projector,
forward=forward_with_teacher_student,
</p>
</div></blockquote>
<p>)</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>student</strong> (<a class="reference external" href="https://docs.pytorch.org/docs/stable/generated/torch.nn.Module.html#torch.nn.Module" title="(in PyTorch v2.10)"><em>torch.nn.Module</em></a>)  The student model whose parameters will be tracked.</p></li>
<li><p><strong>warm_init</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#bool" title="(in Python v3.14)"><em>bool</em></a><em>, </em><em>optional</em>)  If True, performs an initialization step to match the students parameters
immediately. Default is True.</p></li>
<li><p><strong>base_ema_coefficient</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><em>optional</em>)  EMA decay factor at the start of training.
This value will be updated following a cosine schedule.
Should be in [0, 1]. A value of 0.0 means the teacher is fully
updated to the students parameters on every step, while a value of 1.0 means
the teacher remains unchanged.
Default is 0.996.</p></li>
<li><p><strong>final_ema_coefficient</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.14)"><em>float</em></a><em>, </em><em>optional</em>)  EMA decay factor at the end of training.
Default is 1.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.TeacherStudentWrapper.forward">
<span class="sig-name descname"><span class="pre">forward</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/backbone/utils/#TeacherStudentWrapper.forward"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.TeacherStudentWrapper.forward" title="Link to this definition">#</a></dt>
<dd><p>Forward pass through either the student or teacher network.</p>
<p>You can choose which model to run in the default forward.
Commonly the teacher is evaluated, so we default to that.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.TeacherStudentWrapper.forward_student">
<span class="sig-name descname"><span class="pre">forward_student</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/backbone/utils/#TeacherStudentWrapper.forward_student"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.TeacherStudentWrapper.forward_student" title="Link to this definition">#</a></dt>
<dd><p>Forward pass through the student network. Gradients will flow normally.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.TeacherStudentWrapper.forward_teacher">
<span class="sig-name descname"><span class="pre">forward_teacher</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/backbone/utils/#TeacherStudentWrapper.forward_teacher"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.TeacherStudentWrapper.forward_teacher" title="Link to this definition">#</a></dt>
<dd><p>Forward pass through the teacher network.</p>
<p>By default, the teacher network does not require grad.
If ema_coefficient == 0, then teacher==student,
so we wrap in torch.no_grad() to ensure no gradients flow.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.TeacherStudentWrapper.update_ema_coefficient">
<span class="sig-name descname"><span class="pre">update_ema_coefficient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epoch</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">total_epochs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><span class="pre">int</span></a></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/backbone/utils/#TeacherStudentWrapper.update_ema_coefficient"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.TeacherStudentWrapper.update_ema_coefficient" title="Link to this definition">#</a></dt>
<dd><p>Update the EMA coefficient following a cosine schedule.</p>
<dl class="simple">
<dt>The EMA coefficient is updated following a cosine schedule:</dt><dd><p>ema_coefficient = final_ema_coefficient -
0.5 * (final_ema_coefficient - base_ema_coefficient)
* (1 + cos(epoch / total_epochs * pi))</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>epoch</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>)  Current epoch in the training loop.</p></li>
<li><p><strong>total_epochs</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.14)"><em>int</em></a>)  Total number of epochs in the training loop.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.TeacherStudentWrapper.update_teacher">
<span class="sig-name descname"><span class="pre">update_teacher</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/backbone/utils/#TeacherStudentWrapper.update_teacher"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.TeacherStudentWrapper.update_teacher" title="Link to this definition">#</a></dt>
<dd><p>Perform one EMA update step on the teachers parameters.</p>
<dl class="simple">
<dt>The update rule is:</dt><dd><p>teacher_param = ema_coefficient * teacher_param
+ (1 - ema_coefficient) * student_param</p>
</dd>
</dl>
<p>This is done in a <cite>no_grad</cite> context to ensure the teachers parameters do
not accumulate gradients, but the student remains fully trainable.</p>
<p>Everything is updated, including buffers (e.g. batch norm running averages).</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="stable_pretraining.TrainerInfo">
<span class="property"><span class="k"><span class="pre">class</span></span><span class="w"> </span></span><span class="sig-prename descclassname"><span class="pre">stable_pretraining.</span></span><span class="sig-name descname"><span class="pre">TrainerInfo</span></span><a class="reference internal" href="../_modules/stable_pretraining/callbacks/trainer_info/#TrainerInfo"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.TrainerInfo" title="Link to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">Callback</span></code></p>
<p>Links the trainer to the DataModule for enhanced functionality.</p>
<p>This callback establishes a bidirectional connection between the trainer
and DataModule, enabling the DataModule to access trainer information
such as device placement, distributed training state, and other runtime
configurations.</p>
<p>This is particularly useful for DataModules that need to adapt their
behavior based on trainer configuration (e.g., device-aware data loading,
distributed sampling adjustments).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only works with DataModule instances that have a set_pl_trainer method.
A warning is logged if using a custom DataModule without this method.</p>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="stable_pretraining.TrainerInfo.setup">
<span class="sig-name descname"><span class="pre">setup</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">trainer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pl_module</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stage</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/stable_pretraining/callbacks/trainer_info/#TrainerInfo.setup"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.TrainerInfo.setup" title="Link to this definition">#</a></dt>
<dd><p>Called when fit, validate, test, predict, or tune begins.</p>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stable_pretraining.log">
<span class="sig-prename descclassname"><span class="pre">stable_pretraining.</span></span><span class="sig-name descname"><span class="pre">log</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Any" title="(in Python v3.14)"><span class="pre">Any</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">module_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/stable_pretraining/callbacks/registry/#log"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.log" title="Link to this definition">#</a></dt>
<dd><p>Log a metric using the registered module.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="stable_pretraining.log_dict">
<span class="sig-prename descclassname"><span class="pre">stable_pretraining.</span></span><span class="sig-name descname"><span class="pre">log_dict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">module_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.14)"><span class="pre">str</span></a></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'default'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.14)"><span class="pre">None</span></a></span></span><a class="reference internal" href="../_modules/stable_pretraining/callbacks/registry/#log_dict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#stable_pretraining.log_dict" title="Link to this definition">#</a></dt>
<dd><p>Log a metric using the registered module.</p>
</dd></dl>

</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#subpackages">Subpackages</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#submodules">Submodules</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-stable_pretraining.cli">stable_pretraining.cli module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.cli.dump_csv_logs"><code class="docutils literal notranslate"><span class="pre">dump_csv_logs()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.cli.run"><code class="docutils literal notranslate"><span class="pre">run()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-stable_pretraining.config">stable_pretraining.config module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.config.collapse_nested_dict"><code class="docutils literal notranslate"><span class="pre">collapse_nested_dict()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.config.instantiate_from_config"><code class="docutils literal notranslate"><span class="pre">instantiate_from_config()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.config.recursive_instantiate"><code class="docutils literal notranslate"><span class="pre">recursive_instantiate()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-stable_pretraining.forward">stable_pretraining.forward module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.forward.barlow_twins_forward"><code class="docutils literal notranslate"><span class="pre">barlow_twins_forward()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.forward.byol_forward"><code class="docutils literal notranslate"><span class="pre">byol_forward()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.forward.dino_forward"><code class="docutils literal notranslate"><span class="pre">dino_forward()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.forward.dinov2_forward"><code class="docutils literal notranslate"><span class="pre">dinov2_forward()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.forward.nnclr_forward"><code class="docutils literal notranslate"><span class="pre">nnclr_forward()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.forward.simclr_forward"><code class="docutils literal notranslate"><span class="pre">simclr_forward()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.forward.supervised_forward"><code class="docutils literal notranslate"><span class="pre">supervised_forward()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.forward.swav_forward"><code class="docutils literal notranslate"><span class="pre">swav_forward()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.forward.vicreg_forward"><code class="docutils literal notranslate"><span class="pre">vicreg_forward()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-stable_pretraining.manager">stable_pretraining.manager module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.manager.Manager"><code class="docutils literal notranslate"><span class="pre">Manager</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.manager.Manager.init_and_sync_wandb"><code class="docutils literal notranslate"><span class="pre">Manager.init_and_sync_wandb()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.manager.Manager.instantiated_data"><code class="docutils literal notranslate"><span class="pre">Manager.instantiated_data</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.manager.Manager.instantiated_module"><code class="docutils literal notranslate"><span class="pre">Manager.instantiated_module</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.manager.Manager.predict"><code class="docutils literal notranslate"><span class="pre">Manager.predict()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.manager.Manager.save_checkpoint"><code class="docutils literal notranslate"><span class="pre">Manager.save_checkpoint()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.manager.Manager.test"><code class="docutils literal notranslate"><span class="pre">Manager.test()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.manager.Manager.validate"><code class="docutils literal notranslate"><span class="pre">Manager.validate()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.manager.print_logger_info"><code class="docutils literal notranslate"><span class="pre">print_logger_info()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.manager.print_signal_info"><code class="docutils literal notranslate"><span class="pre">print_signal_info()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-stable_pretraining.module">stable_pretraining.module module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.module.Module"><code class="docutils literal notranslate"><span class="pre">Module</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.module.Module.after_manual_backward"><code class="docutils literal notranslate"><span class="pre">Module.after_manual_backward()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.module.Module.configure_optimizers"><code class="docutils literal notranslate"><span class="pre">Module.configure_optimizers()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.module.Module.forward"><code class="docutils literal notranslate"><span class="pre">Module.forward()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.module.Module.named_parameters"><code class="docutils literal notranslate"><span class="pre">Module.named_parameters()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.module.Module.on_train_start"><code class="docutils literal notranslate"><span class="pre">Module.on_train_start()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.module.Module.parameters"><code class="docutils literal notranslate"><span class="pre">Module.parameters()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.module.Module.predict_step"><code class="docutils literal notranslate"><span class="pre">Module.predict_step()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.module.Module.rescale_loss_for_grad_acc"><code class="docutils literal notranslate"><span class="pre">Module.rescale_loss_for_grad_acc()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.module.Module.test_step"><code class="docutils literal notranslate"><span class="pre">Module.test_step()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.module.Module.training_step"><code class="docutils literal notranslate"><span class="pre">Module.training_step()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.module.Module.validation_step"><code class="docutils literal notranslate"><span class="pre">Module.validation_step()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-stable_pretraining.run">stable_pretraining.run module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.run.main"><code class="docutils literal notranslate"><span class="pre">main()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.run.print_config"><code class="docutils literal notranslate"><span class="pre">print_config()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-stable_pretraining.static">stable_pretraining.static module</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.static.HF_EMBEDDINGS"><code class="docutils literal notranslate"><span class="pre">HF_EMBEDDINGS</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.static.HF_EMBEDDINGS.data"><code class="docutils literal notranslate"><span class="pre">HF_EMBEDDINGS.data</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.static.HF_PARAMETERS"><code class="docutils literal notranslate"><span class="pre">HF_PARAMETERS</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.static.HF_PARAMETERS.data"><code class="docutils literal notranslate"><span class="pre">HF_PARAMETERS.data</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.static.MetaStatic"><code class="docutils literal notranslate"><span class="pre">MetaStatic</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.static.MetaStatic.clear"><code class="docutils literal notranslate"><span class="pre">MetaStatic.clear()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.static.MetaStatic.get"><code class="docutils literal notranslate"><span class="pre">MetaStatic.get()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.static.MetaStatic.items"><code class="docutils literal notranslate"><span class="pre">MetaStatic.items()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.static.MetaStatic.keys"><code class="docutils literal notranslate"><span class="pre">MetaStatic.keys()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.static.MetaStatic.update"><code class="docutils literal notranslate"><span class="pre">MetaStatic.update()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.static.MetaStatic.values"><code class="docutils literal notranslate"><span class="pre">MetaStatic.values()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.static.TIMM_EMBEDDINGS"><code class="docutils literal notranslate"><span class="pre">TIMM_EMBEDDINGS</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.static.TIMM_EMBEDDINGS.data"><code class="docutils literal notranslate"><span class="pre">TIMM_EMBEDDINGS.data</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.static.TIMM_PARAMETERS"><code class="docutils literal notranslate"><span class="pre">TIMM_PARAMETERS</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.static.TIMM_PARAMETERS.data"><code class="docutils literal notranslate"><span class="pre">TIMM_PARAMETERS.data</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.static.count_parameters"><code class="docutils literal notranslate"><span class="pre">count_parameters()</span></code></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-stable_pretraining">Module contents</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.EarlyStopping"><code class="docutils literal notranslate"><span class="pre">EarlyStopping</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.EarlyStopping.should_stop"><code class="docutils literal notranslate"><span class="pre">EarlyStopping.should_stop()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.ImageRetrieval"><code class="docutils literal notranslate"><span class="pre">ImageRetrieval</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.ImageRetrieval.NAME"><code class="docutils literal notranslate"><span class="pre">ImageRetrieval.NAME</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.ImageRetrieval.on_validation_epoch_end"><code class="docutils literal notranslate"><span class="pre">ImageRetrieval.on_validation_epoch_end()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.ImageRetrieval.on_validation_epoch_start"><code class="docutils literal notranslate"><span class="pre">ImageRetrieval.on_validation_epoch_start()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.ImageRetrieval.state_key"><code class="docutils literal notranslate"><span class="pre">ImageRetrieval.state_key</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.LiDAR"><code class="docutils literal notranslate"><span class="pre">LiDAR</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.LiDAR.on_validation_batch_end"><code class="docutils literal notranslate"><span class="pre">LiDAR.on_validation_batch_end()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.LiDAR.setup"><code class="docutils literal notranslate"><span class="pre">LiDAR.setup()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.LiDAR.state_key"><code class="docutils literal notranslate"><span class="pre">LiDAR.state_key</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.LoggingCallback"><code class="docutils literal notranslate"><span class="pre">LoggingCallback</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.LoggingCallback.on_validation_end"><code class="docutils literal notranslate"><span class="pre">LoggingCallback.on_validation_end()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.Manager"><code class="docutils literal notranslate"><span class="pre">Manager</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.Manager.init_and_sync_wandb"><code class="docutils literal notranslate"><span class="pre">Manager.init_and_sync_wandb()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.Manager.instantiated_data"><code class="docutils literal notranslate"><span class="pre">Manager.instantiated_data</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.Manager.instantiated_module"><code class="docutils literal notranslate"><span class="pre">Manager.instantiated_module</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.Manager.predict"><code class="docutils literal notranslate"><span class="pre">Manager.predict()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.Manager.save_checkpoint"><code class="docutils literal notranslate"><span class="pre">Manager.save_checkpoint()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.Manager.test"><code class="docutils literal notranslate"><span class="pre">Manager.test()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.Manager.validate"><code class="docutils literal notranslate"><span class="pre">Manager.validate()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.Module"><code class="docutils literal notranslate"><span class="pre">Module</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.Module.after_manual_backward"><code class="docutils literal notranslate"><span class="pre">Module.after_manual_backward()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.Module.configure_optimizers"><code class="docutils literal notranslate"><span class="pre">Module.configure_optimizers()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.Module.forward"><code class="docutils literal notranslate"><span class="pre">Module.forward()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.Module.named_parameters"><code class="docutils literal notranslate"><span class="pre">Module.named_parameters()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.Module.on_train_start"><code class="docutils literal notranslate"><span class="pre">Module.on_train_start()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.Module.parameters"><code class="docutils literal notranslate"><span class="pre">Module.parameters()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.Module.predict_step"><code class="docutils literal notranslate"><span class="pre">Module.predict_step()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.Module.rescale_loss_for_grad_acc"><code class="docutils literal notranslate"><span class="pre">Module.rescale_loss_for_grad_acc()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.Module.test_step"><code class="docutils literal notranslate"><span class="pre">Module.test_step()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.Module.training_step"><code class="docutils literal notranslate"><span class="pre">Module.training_step()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.Module.validation_step"><code class="docutils literal notranslate"><span class="pre">Module.validation_step()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.ModuleSummary"><code class="docutils literal notranslate"><span class="pre">ModuleSummary</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.ModuleSummary.setup"><code class="docutils literal notranslate"><span class="pre">ModuleSummary.setup()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.OnlineKNN"><code class="docutils literal notranslate"><span class="pre">OnlineKNN</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.OnlineKNN.on_validation_batch_end"><code class="docutils literal notranslate"><span class="pre">OnlineKNN.on_validation_batch_end()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.OnlineKNN.setup"><code class="docutils literal notranslate"><span class="pre">OnlineKNN.setup()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.OnlineKNN.state_key"><code class="docutils literal notranslate"><span class="pre">OnlineKNN.state_key</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.OnlineProbe"><code class="docutils literal notranslate"><span class="pre">OnlineProbe</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.OnlineProbe.configure_model"><code class="docutils literal notranslate"><span class="pre">OnlineProbe.configure_model()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.OnlineProbe.wrap_forward"><code class="docutils literal notranslate"><span class="pre">OnlineProbe.wrap_forward()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.OnlineWriter"><code class="docutils literal notranslate"><span class="pre">OnlineWriter</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.OnlineWriter.dump"><code class="docutils literal notranslate"><span class="pre">OnlineWriter.dump()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.OnlineWriter.is_writing_epoch"><code class="docutils literal notranslate"><span class="pre">OnlineWriter.is_writing_epoch()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.OnlineWriter.on_predict_batch_end"><code class="docutils literal notranslate"><span class="pre">OnlineWriter.on_predict_batch_end()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.OnlineWriter.on_sanity_check_end"><code class="docutils literal notranslate"><span class="pre">OnlineWriter.on_sanity_check_end()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.OnlineWriter.on_sanity_check_start"><code class="docutils literal notranslate"><span class="pre">OnlineWriter.on_sanity_check_start()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.OnlineWriter.on_test_batch_end"><code class="docutils literal notranslate"><span class="pre">OnlineWriter.on_test_batch_end()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.OnlineWriter.on_train_batch_end"><code class="docutils literal notranslate"><span class="pre">OnlineWriter.on_train_batch_end()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.OnlineWriter.on_validation_batch_end"><code class="docutils literal notranslate"><span class="pre">OnlineWriter.on_validation_batch_end()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.OnlineWriter.write_at_phase"><code class="docutils literal notranslate"><span class="pre">OnlineWriter.write_at_phase()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.RankMe"><code class="docutils literal notranslate"><span class="pre">RankMe</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.RankMe.on_validation_batch_end"><code class="docutils literal notranslate"><span class="pre">RankMe.on_validation_batch_end()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.RankMe.setup"><code class="docutils literal notranslate"><span class="pre">RankMe.setup()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.RankMe.state_key"><code class="docutils literal notranslate"><span class="pre">RankMe.state_key</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.SklearnCheckpoint"><code class="docutils literal notranslate"><span class="pre">SklearnCheckpoint</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.SklearnCheckpoint.on_load_checkpoint"><code class="docutils literal notranslate"><span class="pre">SklearnCheckpoint.on_load_checkpoint()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.SklearnCheckpoint.on_save_checkpoint"><code class="docutils literal notranslate"><span class="pre">SklearnCheckpoint.on_save_checkpoint()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.SklearnCheckpoint.setup"><code class="docutils literal notranslate"><span class="pre">SklearnCheckpoint.setup()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.TeacherStudentCallback"><code class="docutils literal notranslate"><span class="pre">TeacherStudentCallback</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.TeacherStudentCallback.on_after_backward"><code class="docutils literal notranslate"><span class="pre">TeacherStudentCallback.on_after_backward()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.TeacherStudentCallback.on_fit_start"><code class="docutils literal notranslate"><span class="pre">TeacherStudentCallback.on_fit_start()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.TeacherStudentCallback.on_train_batch_end"><code class="docutils literal notranslate"><span class="pre">TeacherStudentCallback.on_train_batch_end()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.TeacherStudentWrapper"><code class="docutils literal notranslate"><span class="pre">TeacherStudentWrapper</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.TeacherStudentWrapper.forward"><code class="docutils literal notranslate"><span class="pre">TeacherStudentWrapper.forward()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.TeacherStudentWrapper.forward_student"><code class="docutils literal notranslate"><span class="pre">TeacherStudentWrapper.forward_student()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.TeacherStudentWrapper.forward_teacher"><code class="docutils literal notranslate"><span class="pre">TeacherStudentWrapper.forward_teacher()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.TeacherStudentWrapper.update_ema_coefficient"><code class="docutils literal notranslate"><span class="pre">TeacherStudentWrapper.update_ema_coefficient()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.TeacherStudentWrapper.update_teacher"><code class="docutils literal notranslate"><span class="pre">TeacherStudentWrapper.update_teacher()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.TrainerInfo"><code class="docutils literal notranslate"><span class="pre">TrainerInfo</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.TrainerInfo.setup"><code class="docutils literal notranslate"><span class="pre">TrainerInfo.setup()</span></code></a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.log"><code class="docutils literal notranslate"><span class="pre">log()</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#stable_pretraining.log_dict"><code class="docutils literal notranslate"><span class="pre">log_dict()</span></code></a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By stable-pretraining team
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
       Copyright 2024, stable-pretraining team.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>